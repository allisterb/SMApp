(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;a=self;b=a.SMApp=a.SMApp||{};c=b.Web=b.Web||{};d=c.User=c.User||{};e=c.Meaning=c.Meaning||{};f=c.Intent=c.Intent||{};g=c.Entity=c.Entity||{};h=c.Resource=c.Resource||{};i=c.Client=c.Client||{};j=a.StartupCode$SMApp_Web$Client=a.StartupCode$SMApp_Web$Client||{};k=a.IntelliFactory;l=k&&k.Runtime;m=a.WebSharper;n=m&&m.List;o=m&&m.UI;p=o&&o.Doc;q=m&&m.Concurrency;r=m&&m.Remoting;s=r&&r.AjaxRemotingProvider;t=m&&m.Utils;d.New=function(u){return{UserName:u};};e=c.Meaning=l.Class({get_TopIntent:function(){return n.head(n.sortBy(function(u){return u.get_Confidence();},this.get_Intents()));},get_Entities:function(){return(this.get_Unwrap())[1];},get_Intents:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1];}},null,e);f=c.Intent=l.Class({get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1];}},null,f);g=c.Entity=l.Class({get_Value:function(){return(this.get_Unwrap())[3];},get_Role:function(){return(this.get_Unwrap())[2];},get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1,this.$2,this.$3];}},null,g);h.New=function(u,v,w){return{Name:u,Description:v,Url:w};};i.Term=function(){var u,v;u=l.ThisFunc(function(){return null;});v=i.baseOpt();a.$("#main").terminal(u,v);return p.get_Empty();};i.baseOpt=function(){j.$cctor();return j.baseOpt;};i.Main=function(u,v){var w,x;function y(z){return z.get_TopIntent().get_Name()==="Hello"&&z.get_TopIntent().get_Confidence()>0.8?{$:1,$0:n.filter(function(A){return A.get_Confidence()>0.8;},z.get_Entities())}:null;}w=v==="help"?{$:0,$0:null}:v==="debug on"?{$:1,$0:null}:{$:2,$0:null};w.$==1?(u.echo("Debug mode set."),i.set_debugMode(true)):w.$==2?(u.disable(),q.Start((x=null,q.Delay(function(){return q.Combine(q.Bind((new s.New()).Async("SMApp.Web:SMApp.Web.Server.GetMeaning:1317303349",[v]),function(z){var A,B,C,D;return z!=null&&z.$==1&&(B=y(z.$0),B!=null&&B.$==1&&(B.$0.$==1&&(B.$0.$1.$==0&&(B.$0.$0.get_Role()==="contact"&&(A=B.$0.$0,true)))))?(u.echo((function(E){return function(F){return E("This is the hello intent. The user name is "+t.toSafe(F)+".");};}(a.id))(A.get_Role())),q.Zero()):z!=null&&z.$==1&&(D=y(z.$0),D!=null&&D.$==1)?(u.echo("This is the hello intent but I don't know who the user is."),q.Zero()):(u.echo("This is the whatever intent"),q.Zero());}),q.Delay(function(){u.enable();return q.Zero();}));})),null)):u.echo("This is the help commnd");};i.debugMode=function(){j.$cctor();return j.debugMode;};i.set_debugMode=function(u){j.$cctor();j.debugMode=u;};j.$cctor=function(){var u;j.$cctor=a.ignore;j.debugMode=false;j.baseOpt=(u={},u.name="_",u.greetings="Welcome to Selma",u.onInit=function(v){var w;return v.push(function(x){return i.Main(this,x);},(w={},w.name="Main",w.prompt=">",w));},u);};}());
