(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC;a=self;b=a.SMApp=a.SMApp||{};c=b.Web=b.Web||{};d=c.ClientExtensions=c.ClientExtensions||{};e=c._Html=c._Html||{};f=c.htmModule=c.htmModule||{};g=a.StartupCode$SMApp_Web$ClientExtensions=a.StartupCode$SMApp_Web$ClientExtensions||{};h=c.TypingDNA=c.TypingDNA||{};i=h.SaveResponse=h.SaveResponse||{};j=h.UserResponse=h.UserResponse||{};k=h.VerifyResponse=h.VerifyResponse||{};l=c.Bs=c.Bs||{};m=b.NLU=b.NLU||{};n=m.Babelfy=m.Babelfy||{};o=n.ApiResponse=n.ApiResponse||{};p=n.TokenFragment=n.TokenFragment||{};q=n.CharFragment=n.CharFragment||{};r=m.Witai=m.Witai||{};s=r.Utterance=r.Utterance||{};t=r.Intent=r.Intent||{};u=r.Entity=r.Entity||{};v=r.Trait=r.Trait||{};w=r["Utterance'"]=r["Utterance'"]||{};x=r["Value'"]=r["Value'"]||{};y=m.QnAMaker=m.QnAMaker||{};z=y.ITSQuestion=y.ITSQuestion||{};A=y.ITSAnswerContext=y.ITSAnswerContext||{};B=y.ITSAnswer=y.ITSAnswer||{};C=y.ITSAnswers=y.ITSAnswers||{};D=c.NLG=c.NLG||{};E=a.StartupCode$SMApp_Web$NLG=a.StartupCode$SMApp_Web$NLG||{};F=c.NLU=c.NLU||{};G=F.Intent=F.Intent||{};H=F.Trait=F.Trait||{};I=F.Entity=F.Entity||{};J=F.Utterance=F.Utterance||{};K=F.Voice=F.Voice||{};L=K["Entity'"]=K["Entity'"]||{};M=F.Text=F.Text||{};N=M["Utterance'"]=M["Utterance'"]||{};O=M["Intent'"]=M["Intent'"]||{};P=M["Entity'"]=M["Entity'"]||{};Q=M["Trait'"]=M["Trait'"]||{};R=F.Domain=F.Domain||{};S=a.StartupCode$SMApp_Web$NLU=a.StartupCode$SMApp_Web$NLU||{};T=c.CUI=c.CUI||{};U=T.MicState=T.MicState||{};V=T.ClientState=T.ClientState||{};W=T.Interpreter=T.Interpreter||{};X=T.CUI=T.CUI||{};Y=c.Dialogue=c.Dialogue||{};Z=c.Question=c.Question||{};_0=c.QuestionType=c.QuestionType||{};_1=c.DialogueModule=c.DialogueModule||{};_2=c.User=c.User||{};_3=a.StartupCode$SMApp_Web$User=a.StartupCode$SMApp_Web$User||{};_4=c.Main=c.Main||{};_5=a.StartupCode$SMApp_Web$Main=a.StartupCode$SMApp_Web$Main||{};_6=c.Client=c.Client||{};_7=a.StartupCode$SMApp_Web$Client=a.StartupCode$SMApp_Web$Client||{};_8=a.SMApp$Web_GeneratedPrintf=a.SMApp$Web_GeneratedPrintf||{};_9=a.GeneratedPrintf=a.GeneratedPrintf||{};_=a.IntelliFactory;$=_&&_.Runtime;ba=a.WebSharper;bb=ba&&ba.Arrays;bc=ba&&ba.UI;bd=bc&&bc.Doc;be=bc&&bc.AttrProxy;bf=bc&&bc.Client;bg=bf&&bf.Templates;bh=ba&&ba.Utils;bi=a.console;bj=a.jQuery;bk=ba&&ba.Strings;bl=ba&&ba.List;bm=ba&&ba.Seq;bn=bc&&bc.AttrModule;bo=ba&&ba.Concurrency;bp=a.JSON;bq=ba&&ba.Random;br=ba&&ba.Collections;bs=br&&br.Map;bt=ba&&ba.JavaScript;bu=bt&&bt.Pervasives;bv=a.SDK;bw=ba&&ba.Unchecked;bx=ba&&ba.Operators;by=ba&&ba.Remoting;bz=by&&by.AjaxRemotingProvider;bA=a.Wit;bB=a.document;bC=br&&br.Dictionary;d.getCameraCanvas=function(){return a.getCameraCanvas();};d.stopCamera=function(){return a.stopCamera();};d.startCamera=function(bD,bE){return a.startCamera(bD,bE);};d.speechSynthesis=function(){return a.speechSynthesis;};d.lastMicData=function(){return a.lastMicData;};d.questionBox=function(bD,bE,bF,bG,bH,bI,bJ){var bK,bL,bM,bN;bK=(bL=(bM={},bM.titleText=bD,bM.text=bE,bM.type="question",bM.width=a.String(bF),bM.html=((($.Curried3(function(bO,bP,bQ){return bO("<div style=\"width:"+a.String(bP)+"px;height:"+a.String(bQ)+"px\"></div>");}))(a.id))(bF))(bG),bM.input="text",bM.confirmButtonText="Ok",bM),(bH!=null?bH.$0(bL):void 0,bN=a.Sweetalert2(bL),bN));bI!=null?bI.$0():void 0;bK.then(bJ);};d.getDialogueBoxInput=function(){return bb.get(a.jQuery(".swal2-input").get(),0);};d.getDialogueBoxCanvas=function(){return bb.get(a.jQuery("canvas.swal2-content").get(),0);};d.createDialogueBoxCanvas=function(){return d.createCanvas("camera","640","480",bb.get(a.jQuery(".swal2-content").get(),0).firstChild);};d.createCanvas=function(bD,bE,bF,bG){var bH;bH=bd.Element("canvas",[d.eid(bD),be.Create("width",bE),be.Create("height",bF)],[]);bg.LoadLocalTemplates("");bd.Run(bG,bH);return bG.firstChild;};d.elementHTML=function(bD){return bD.innerHTML;};d.createElement=function(bD){var bE;bE=self.document.createElement("div");self.document.appendChild(bE);bg.LoadLocalTemplates("");bd.RunAppend(bE,bD);};d.container=function(bD){return bd.Element("div",[d.cls("container")],bD);};d.dindex=function(bD){return be.Create("data-index",a.String(bD));};d.cls=function(bD){return be.Create("class",bD);};d.eid=function(bD){return be.Create("id",bD);};d.termOutput=function(){return bb.get(a.jQuery(".terminal-output").get(),0);};d.toLower=function(bD){return bD.toLowerCase();};d.debug=function(bD,bE){d.info(((($.Curried3(function(bF,bG,bH){return bF("DEBUG: "+bh.toSafe(bG)+": "+bh.prettyPrint(bH));}))(a.id))(bD.toUpperCase()))(bE));};d.error=function(bD){bi.error(bD);};d.info=function(bD){bi.info(bD);};d.jserror=function(bD){bj.error(bD);};d.toArray=function(bD){return bb.map(a.id,bj.makeArray(bD));};d["Terminal.EchoHtml'"]=function(bD,bE){bD.pause();bD.echo(bE,d.rawOpt());bD.resume();};d["Terminal.Echo'"]=function(bD,bE){bD.pause();bD.echo(bE);bD.resume();};d.rawOpt=function(){g.$cctor();return g.rawOpt;};e=c._Html=$.Class({toString:function(){return e.toString(this);}},null,e);e.toString=function(bD){function bE(bF){return function(bG){var bH,bI,bJ,bK,bL,bM,bN;bI=bk.replicate(bF," ");switch(bG.$==0?bG.$1.$==1?bG.$1.$0.$==2?bG.$1.$1.$==0?(bH=[bG.$1.$0.$0,bG.$0],1):(bH=[bG.$1,bG.$0],2):(bH=[bG.$1,bG.$0],2):(bH=[bG.$1,bG.$0],2):bG.$==2?(bH=bG.$0,3):(bH=[bG.$0,bG.$1],0)){case 0:return bH[0]+"=\""+bH[1]+"\"";case 1:bJ=bH[1];return bI+"<"+bJ+">"+bH[0]+"</"+bJ+">\r\n";case 2:bK=bH[1];bL=bl.partition(function(bO){return bO.$==1;},bH[0]);bM=bL[1];bN=bL[0];return bM.$==0?bI+"<"+bK+(bN.$===0?"":" "+bk.concat(" ",bl.ofSeq(bm.delay(function(){return bm.map(function(bO){return(bE(0))(bO);},bN);}))))+"/>\r\n":bI+"<"+bK+(bN.$===0?"":" "+bk.concat(" ",bl.ofSeq(bm.delay(function(){return bm.map(function(bO){return(bE(0))(bO);},bN);}))))+">\r\n"+bk.concat("",bl.ofSeq(bm.delay(function(){return bm.map(function(bO){return(bE(bF+1))(bO);},bM);})))+bI+"</"+bK+">\r\n";case 3:return bI+bH+"\r\n";}};}return(bE(0))(bD);};f.alt=function(bD){return new e({$:1,$0:"alt",$1:bD});};f.src=function(bD){return new e({$:1,$0:"src",$1:bD});};f.cls=function(bD){return new e({$:1,$0:"class",$1:bD});};f.str=function(bD){return e.toString(bD);};f.op_PercentEquals=function(bD,bE){return new e({$:1,$0:bD,$1:bE});};f.op_Splice=function(bD){var bE;return bl.ofArray([new e({$:2,$0:(bE=bD,a.String(bE))})]);};f.strong=function(){g.$cctor();return g.strong;};f.h4=function(){g.$cctor();return g.h4;};f.h3=function(){g.$cctor();return g.h3;};f.h2=function(){g.$cctor();return g.h2;};f.h1=function(){g.$cctor();return g.h1;};f.li=function(){g.$cctor();return g.li;};f.ul=function(){g.$cctor();return g.ul;};f.th=function(){g.$cctor();return g.th;};f.td=function(){g.$cctor();return g.td;};f.tr=function(){g.$cctor();return g.tr;};f.a=function(){g.$cctor();return g.a;};f.p=function(){g.$cctor();return g.p;};f.area=function(){g.$cctor();return g.area;};f.map=function(){g.$cctor();return g.map;};f.img=function(){g.$cctor();return g.img;};f.tfoot=function(){g.$cctor();return g.tfoot;};f.tbody=function(){g.$cctor();return g.tbody;};f.thead=function(){g.$cctor();return g.thead;};f.table=function(){g.$cctor();return g.table;};f.span=function(){g.$cctor();return g.span;};f.section=function(){g.$cctor();return g.section;};f.br=function(){g.$cctor();return g.br;};f.div=function(){g.$cctor();return g.div;};f.body=function(){g.$cctor();return g.body;};f.style=function(){g.$cctor();return g.style;};f.title=function(){g.$cctor();return g.title;};f.head=function(){g.$cctor();return g.head;};f.html=function(){g.$cctor();return g.html;};f.elem=function(bD,bE){return new e({$:0,$0:bD,$1:bE});};g.$cctor=function(){var bD;g.$cctor=a.ignore;g.rawOpt=(bD={},bD.raw=true,bD);g.html=function(bE){return f.elem("html",bE);};g.head=function(bE){return f.elem("head",bE);};g.title=function(bE){return f.elem("title",bE);};g.style=function(bE){return f.elem("style",bE);};g.body=function(bE){return f.elem("body",bE);};g.div=function(bE){return f.elem("div",bE);};g.br=function(bE){return f.elem("br",bE);};g.section=function(bE){return f.elem("section",bE);};g.span=function(bE){return f.elem("span",bE);};g.table=function(bE){return f.elem("table",bE);};g.thead=function(bE){return f.elem("thead",bE);};g.tbody=function(bE){return f.elem("tbody",bE);};g.tfoot=function(bE){return f.elem("tfoot",bE);};g.img=function(bE){return f.elem("img",bE);};g.map=function(bE){return f.elem("map",bE);};g.area=function(bE){return f.elem("area",bE);};g.p=function(bE){return f.elem("p",bE);};g.a=function(bE){return f.elem("a",bE);};g.tr=function(bE){return f.elem("tr",bE);};g.td=function(bE){return f.elem("td",bE);};g.th=function(bE){return f.elem("th",bE);};g.ul=function(bE){return f.elem("ul",bE);};g.li=function(bE){return f.elem("li",bE);};g.h1=function(bE){return f.elem("h1",bE);};g.h2=function(bE){return f.elem("h1",bE);};g.h3=function(bE){return f.elem("h1",bE);};g.h4=function(bE){return f.elem("h1",bE);};g.strong=function(bE){return f.elem("strong",bE);};};i.New=function(bD,bE,bF,bG){return{name:bD,message:bE,message_code:bF,status:bG};};j.New=function(bD,bE,bF,bG,bH){return{message:bD,message_code:bE,success:bF,count:bG,status:bH};};k.New=function(bD,bE,bF,bG,bH,bI){return{message:bD,message_code:bE,success:bF,result:bG,score:bH,confidence:bI};};h.getSameTextTypingPattern=function(bD,bE){var bF;return bE.getTypingPattern((bF={type:1},bF.text=bD,bF.caseSensitive=true,bF));};l.Radio=function(bD,bE,bF,bG,bH){return bd.Element("div",new bl.T({$:1,$0:d.cls("radio"),$1:bE}),[bd.Element("label",bG,[bd.Radio(bH,true,bF),bd.TextNode(bD)])]);};l.checkbox=function(bD,bE,bF,bG,bH){return bd.Element("div",new bl.T({$:1,$0:d.cls("checkbox"),$1:bE}),[bd.Element("label",bG,[bd.CheckBox(bH,bF),bd.TextNode(bD)])]);};l.textArea=function(bD,bE,bF,bG,bH){return bd.Element("div",new bl.T({$:1,$0:d.cls("form-group"),$1:bE}),[bd.Element("label",bG,[bd.TextNode(bD)]),bd.InputArea(new bl.T({$:1,$0:d.cls("form-control"),$1:bH}),bF)]);};l.inputPassword=function(bD,bE,bF,bG,bH){return bd.Element("div",new bl.T({$:1,$0:d.cls("form-group"),$1:bE}),[bd.Element("label",bG,[bd.TextNode(bD)]),bd.PasswordBox(new bl.T({$:1,$0:d.cls("form-control"),$1:bH}),bF)]);};l.input=function(bD,bE,bF,bG,bH){return bd.Element("div",new bl.T({$:1,$0:d.cls("form-group"),$1:bE}),[bd.Element("label",bG,[bd.TextNode(bD)]),bd.Input([d.cls("form-control"),bH],bF)]);};l.btnSecondary=function(bD,bE,bF){return bd.Element("button",[d.eid(bD),d.cls("btn btn-secondary"),bn.Handler("click",bF)],[bd.TextNode(bE)]);};l.btnPrimary=function(bD,bE,bF){return bd.Element("button",[d.eid(bD),d.cls("btn btn-primary"),bn.Handler("click",bF)],[bd.TextNode(bE)]);};o.New=function(bD,bE,bF,bG,bH,bI,bJ,bK,bL){return{tokenFragment:bD,charFragment:bE,babelSynsetID:bF,DBpediaURL:bG,BabelNetURL:bH,score:bI,cohrenceScore:bJ,globalScore:bK,source:bL};};p.New=function(bD,bE){return{start:bD,end:bE};};q.New=function(bD,bE){return{start:bD,end:bE};};n.disambiguate=function(bD){function bE(bF,bG){var bH;bj.ajax((bH={},bH.url=(function(bI){return function(bJ){return bI("https://babelfy.io/v1/disambiguate?text="+bh.toSafe(bJ)+"&lang=EN&extAIDA=true&key=983fc0ec-a6fa-49ef-bd02-203c18aef272");};}(a.id))(bD),bH.type="GET",bH.success=function(bI){return bF(bI);},bH.error=function(bI){return bG(new a.Error(bI.responseText));},bH));}return bo.FromContinuations(function(bF,bG,bH){return bE.apply(null,[bF,bG,bH]);});};s.New=function(bD,bE,bF,bG){return{text:bD,intents:bE,entities:bF,traits:bG};};t.New=function(bD,bE,bF){return{id:bD,name:bE,confidence:bF};};u.New=function(bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN){return{id:bD,name:bE,role:bF,start:bG,end:bH,body:bI,confidence:bJ,entities:bK,suggested:bL,value:bM,type:bN};};v.New=function(bD,bE,bF){return{id:bD,value:bE,confidence:bF};};w.New=function(bD){return{intent:bD};};x.New=function(bD){return{value:bD};};r.getMeaning2=function(bD,bE){function bF(bG,bH){var bI;bj.ajax((bI={},bI.url=(function(bJ){return function(bK){return bJ("https://api.wit.ai/message?q="+bh.toSafe(bK));};}(a.id))(bE),bI.type="GET",bI.beforeSend=function(bJ){return bJ.setRequestHeader("Authorization","Bearer "+bD);},bI.success=function(bJ){return bG(bJ);},bI.error=function(bJ){return bH(new a.Error(bJ.responseText));},bI));}return bo.FromContinuations(function(bG,bH,bI){return bF.apply(null,[bG,bH,bI]);});};r.getMeaning=function(bD,bE,bF,bG){var bH;bj.ajax((bH={},bH.url=(function(bI){return function(bJ){return bI("https://api.wit.ai/message?q="+bh.toSafe(bJ));};}(a.id))(bE),bH.type="GET",bH.beforeSend=function(bI){return bI.setRequestHeader("Authorization","Bearer "+bD);},bH.success=bF,bH.error=bG,bH));};z.New=function(bD){return{question:bD};};A.New=function(bD,bE){return{isContextOnly:bD,prompts:bE};};B.New=function(bD,bE,bF,bG,bH,bI,bJ){return{questions:bD,answer:bE,score:bF,id:bG,source:bH,metadata:bI,context:bJ};};C.New=function(bD){return{answers:bD};};y.getAnswer=function(bD){function bE(bF,bG){var bH;bj.ajax((bH={},bH.url="https://lerna.azurewebsites.net/qnamaker/knowledgebases/13a6a026-942b-4612-a8cb-654086ec76ee/generateAnswer",bH.type="POST",bH.beforeSend=function(bI){return bI.setRequestHeader("Authorization","EndpointKey e5a55563-b1b0-4343-8796-bda5a0509385");},bH.contentType="application/json",bH.dataType="json",bH.data=bp.stringify(z.New(bD)),bH.success=function(bI){return bF(bI);},bH.error=function(bI){return bG(new a.Error(bI.responseText));},bH));}return bo.FromContinuations(function(bF,bG,bH){return bE.apply(null,[bF,bG,bH]);});};D.waitAddPhrases=function(){E.$cctor();return E.waitAddPhrases;};D.waitRetrievePhrases=function(){E.$cctor();return E.waitRetrievePhrases;};D.helpPhrases=function(){E.$cctor();return E.helpPhrases;};D.helloUserPhrases=function(){E.$cctor();return E.helloUserPhrases;};D.helloPhrases=function(){E.$cctor();return E.helloPhrases;};D["getRandomPhrase'"]=function(bD){return D.replace_tok("$0","",bm.nth(D.rng().Next(0,bD.get_Length()),bD));};D.getRandomPhrase=function(bD,bE){return D.replace_tok("$0",bE,bm.nth(D.rng().Next(0,bD.get_Length()),bD));};D.replace_tok=function(bD,bE,bF){return bk.Replace(bF,bD,bE);};D.rng=function(){E.$cctor();return E.rng;};E.$cctor=function(){E.$cctor=a.ignore;E.rng=new bq.New();E.helloPhrases=bl.ofArray(["Welcome!","Welcome, my name is Selma.","Welcome to Selma. How can I help?","Hello this is Selma, how can I help?","Hello, I am Selma. How can I help?","Hello, I am Selma. How may I help you now?","I'm Selma. Tell me your name so we can get started."]);E.helloUserPhrases=bl.ofArray(["Hello $0, welcome back.","Welcome $0, nice to see you again.","Hello $0.","Good to see you $0.","Hello $0, nice to see you."]);E.helpPhrases=bl.ofArray(["What can I help you with $0?"]);E.waitRetrievePhrases=bl.ofArray(["Ok, let me check that $0 for you","Please wait while I check that $0 for you.","Wait while I check that $0.","Ok let me see if I can find that $0."]);E.waitAddPhrases=bl.ofArray(["Ok, let me add that $0 for you","Please wait while I add that $0 for you.","Wait while I add that $0.","I'll add that $0 now."]);};G=F.Intent=$.Class({toString:function(){return((($.Curried3(function(bD,bE,bF){return bD("Intent("+bh.toSafe(bE)+", "+_8.p$2(bF)+")");}))(a.id))(this.get_Name()))(this.get_Confidence());},get_Confidence:function(){return this.$1;},get_Name:function(){return this.$0;}},null,G);H=F.Trait=$.Class({toString:function(){return((($.Curried3(function(bD,bE,bF){return bD("Trait("+bh.toSafe(bE)+", "+bh.prettyPrint(bF)+")");}))(a.id))(this.get_Name()))(this.get_Value());},get_Confidence:function(){return this.$2;},get_Value:function(){return this.$1;},get_Name:function(){return this.$0;}},null,H);I=F.Entity=$.Class({toString:function(){return((((($.Curried(function(bD,bE,bF,bG,bH){return bD("Entity("+bh.toSafe(bE)+", "+bh.toSafe(bF)+", "+bh.toSafe(bG)+", "+_8.p$2(bH)+")");},5))(a.id))(this.get_Name()))(this.get_Role()))(this.get_Value()))(this.get_Confidence());},get_Confidence:function(){return this.$3;},get_Value:function(){return this.$2;},get_Role:function(){return this.$1;},get_Name:function(){return this.$0;}},null,I);J=F.Utterance=$.Class({toString:function(){return(((($.Curried(function(bD,bE,bF,bG){return bD(_8.p(bE)+" "+_8.p$3(bF)+" "+_8.p$5(bG));},4))(a.id))(this.get_Intent()))(this.get_Traits()))(this.get_Entities());},get_Entities:function(){var bD;bD=this.$3;return bD!=null?{$:1,$0:bl.sortBy(function(bE){return bE.get_Name();},bD.$0)}:null;},get_Traits:function(){var bD;bD=this.$2;return bD!=null?{$:1,$0:bl.sortBy(function(bE){return bE.get_Name();},bD.$0)}:null;},get_Intent:function(){return this.$1;},get_Text:function(){return this.$0;}},null,J);L.New=function(bD,bE,bF,bG,bH){return{body:bD,end:bE,start:bF,suggested:bG,value:bH};};K["Intent'"]=function(bD,bE){return!(bE.intent==null)?{$:1,$0:new G({$:0,$0:d.toLower(bE.intent.value),$1:null})}:null;};K["Trait'"]=function(bD){return!(bD.domain==null)?{$:1,$0:new H({$:0,$0:"domain",$1:d.toLower(bD.domain.value),$2:null})}:!(bD.dialogue_act==null)?{$:1,$0:new H({$:0,$0:"dialogue_act",$1:d.toLower(bD.dialogue_act.value),$2:null})}:null;};K["Entity'$1"]=function(bD){return!(bD.contact==null)?{$:1,$0:new I({$:0,$0:"contact",$1:"",$2:d.toLower(bD.contact.value),$3:null})}:null;};N=M["Utterance'"]=$.Class({get_TopIntent:function(){return bl.head(bl.sortBy(function(bD){return bD.get_Confidence();},this.get_Intents()));},get_Traits:function(){return this.$3;},get_Entities:function(){return this.$2;},get_Intents:function(){return this.$1;},get_Text:function(){return this.$0;}},null,N);O=M["Intent'"]=$.Class({get_Confidence:function(){return this.$1;},get_Name:function(){return this.$0;}},null,O);P=M["Entity'"]=$.Class({get_Value:function(){return(this.get_Unwrap())[3];},get_Role:function(){return(this.get_Unwrap())[2];},get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1,this.$2,this.$3];}},null,P);Q=M["Trait'"]=$.Class({get_Value:function(){return(this.get_Unwrap())[2];},get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1,this.$2];}},null,Q);M.HasUtterance=function(bD){var bE,bF,bG,bH,bI,bJ;return bD!=null&&bD.$==1&&(bD.$0.$2.get_Length()>0&&(bE=[bD.$0.$2,bD.$0.$1,bD,bD.$0.$0,bD.$0.$3],true))?(bF=bE[0],(bG=bE[2],(bH=bE[4],(bI=bE[1].$==0?null:{$:1,$0:new G({$:0,$0:bG.$0.get_TopIntent().get_Name(),$1:{$:1,$0:bG.$0.get_TopIntent().get_Confidence()}})},(bJ=bF.$==0?null:{$:1,$0:bl.map(function(bK){return new I({$:0,$0:bK.get_Name(),$1:d.toLower(bK.get_Role()),$2:bK.get_Value(),$3:{$:1,$0:bK.get_Confidence()}});},bl.filter(function(bK){return bK.get_Confidence()>M.entityConfidenceThreshold();},bF))},{$:1,$0:new J({$:0,$0:bE[3],$1:bI,$2:bH.$==0?null:{$:1,$0:bl.map(function(bK){return new H({$:0,$0:d.toLower(bK.get_Name()),$1:bK.get_Value(),$2:{$:1,$0:bK.get_Confidence()}});},bl.filter(function(bK){return bK.get_Confidence()>M.entityConfidenceThreshold();},bH))},$3:bJ})}))))):null;};M.entityConfidenceThreshold=function(){S.$cctor();return S.entityConfidenceThreshold;};M.set_entityConfidenceThreshold=function(bD){S.$cctor();S.entityConfidenceThreshold=bD;};M.intentConfidenceThreshold=function(){S.$cctor();return S.intentConfidenceThreshold;};M.set_intentConfidenceThreshold=function(bD){S.$cctor();S.intentConfidenceThreshold=bD;};M.getUtterance2=function(bD){var bE;bE=null;return bo.Delay(function(){return bo.Bind(r.getMeaning2("4Y2BLQY5TWLIN7HFIV264S53MY4PCUAT",bD),function(bF){d.debug("NLU",(function(bG){return function(bH){return bG("Wit.ai returned "+_9.p(bH)+" ");};}(a.id))(bF));return bo.Return(new N({$:0,$0:bD,$1:bl.ofArray(bb.map(function(bG){return new O({$:0,$0:bG.name,$1:bG.confidence});},bF.intents)),$2:bl.map(function(bG){return new P({$:0,$0:bG.name,$1:bG.confidence,$2:bG.role,$3:bG.value});},bl.ofSeq(bm.concat(bm.map(function(bG){return bG[1];},bs.ToSeq(bF.entities))))),$3:bl.ofSeq(bm.map(function(bG){var bH;bH=bG[1];return new Q({$:0,$0:bG[0],$1:bb.get(bH,0).confidence,$2:bb.get(bH,0).value});},bs.ToSeq(bF.traits)))}));});});};M.getUtterance=function(bD,bE){r.getMeaning("OOGDHEQL7JZRQASXN2N2GHFUKGO3SCNV",bD,function(bF){var bG,bH;d.debug("NLU",(function(bI){return function(bJ){return bI("Wit.ai returned: "+bh.prettyPrint(bJ));};}(a.id))(bF));bG=!(bF.intents==null)?bl.ofArray(bb.map(function(bI){return new O({$:0,$0:bI.name,$1:bI.confidence});},bF.intents)):bl.T.Empty;bH=!(bF.traits==null)?bl.ofSeq(bm.concat(bl.map(function(bI){return bb.map(function(bJ){return new Q({$:0,$0:bI,$1:bJ.confidence,$2:bJ.value});},bu.GetJS(bF.traits,[bI]));},bl.filter(function(bI){return!(bu.GetJS(bF.traits,[bI])==null);},M.trait_types())))):bl.T.Empty;return bE({$:1,$0:new N({$:0,$0:bD,$1:bG,$2:!(bF.entities==null)?bl.ofSeq(bm.concat(bl.map(function(bI){return bb.map(function(bJ){return new P({$:0,$0:bJ.name,$1:bJ.confidence,$2:bJ.role,$3:bJ.value});},bu.GetJS(bF.entities,[bI]));},bl.filter(function(bI){return!(bu.GetJS(bF.entities,[bI])==null);},M.entity_types())))):bl.T.Empty,$3:bH})});},function(bF,bG,bH){d.error(((($.Curried3(function(bI,bJ,bK){return bI("Wit.ai returned: "+bh.prettyPrint(bJ)+" "+bh.prettyPrint(bK));}))(a.id))(bG))(bH));return bE(null);});};M.trait_types=function(){S.$cctor();return S.trait_types;};M.entity_types=function(){S.$cctor();return S.entity_types;};M.QuickNumber=function(bD){var bE,bF,bG;return(bF=M.One(bD),bF!=null&&bF.$==1?(bE=bF.$0,true):(bG=M.Two(bD),bG!=null&&bG.$==1&&(bE=bG.$0,true)))?{$:1,$0:bE}:null;};M.Three=function(bD){var bE;return bD==="3"||bD==="three"?{$:1,$0:new J({$:0,$0:"three",$1:{$:1,$0:new G({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bl.ofArray([new I({$:0,$0:"wit/ordinal",$1:"",$2:"three",$3:{$:1,$0:1}})])}})}:null;};M.Two=function(bD){var bE;return bD==="2"||bD==="two"?{$:1,$0:new J({$:0,$0:"two",$1:{$:1,$0:new G({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bl.ofArray([new I({$:0,$0:"wit/ordinal",$1:"",$2:"two",$3:{$:1,$0:1}})])}})}:null;};M.One=function(bD){var bE;return bD==="1"||bD==="one"?{$:1,$0:new J({$:0,$0:"one",$1:{$:1,$0:new G({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bl.ofArray([new I({$:0,$0:"wit/ordinal",$1:"",$2:"one",$3:{$:1,$0:1}})])}})}:null;};M.QuickNo=function(bD){var bE;return bD==="no"||(bD==="nope"||(bD==="no way"||(bD==="nah"||(bD==="don't do it"||bD==="stop"))))?{$:1,$0:new J({$:0,$0:"no",$1:{$:1,$0:new G({$:0,$0:"reject",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};M.QuickYes=function(bD){var bE;return bD==="yes"||(bD==="ok"||(bD==="sure"||(bD==="yeah"||(bD==="yep"||(bD==="uh huh"||(bD==="go ahead"||bD==="go"))))))?{$:1,$0:new J({$:0,$0:"yes",$1:{$:1,$0:new G({$:0,$0:"verify",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};M.QuickHelp=function(bD){var bE;return bD==="help"||(bD==="help me"||(bD==="what's this?"||bD==="huh"))?{$:1,$0:new J({$:0,$0:"help",$1:{$:1,$0:new G({$:0,$0:"help",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};M.QuickHello=function(bD){var bE;return bD==="hello"||(bD==="hey"||(bD==="yo"||bD==="hi"))?{$:1,$0:new J({$:0,$0:"hello",$1:{$:1,$0:new G({$:0,$0:"greet",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};M.Voices=function(bD){return bD==="voices"?{$:1,$0:null}:null;};M.Debug=function(bD){return bD==="debug"?{$:1,$0:null}:null;};M.Blank=function(bD){return bD===""?{$:1,$0:null}:null;};R.Study=function(bD){return bD.get_Traits()!=null?{$:0,$0:null}:{$:1,$0:null};};F.Str=function(bD){var bE;return bD!=null&&bD.$==1&&(typeof bD.$0=="string"&&(bE=bD.$0,true))?{$:1,$0:bE}:null;};F.No=function(bD){var bE,bF;return(bF=F.Intent$1("reject",bD),bF!=null&&bF.$==1&&(bF.$0[0]==null&&(bF.$0[1]==null&&(bE=bD,true))))?{$:1,$0:bE}:null;};F.Yes=function(bD){var bE,bF;return(bF=F.Intent$1("verify",bD),bF!=null&&bF.$==1&&(bF.$0[0]==null&&(bF.$0[1]==null&&(bE=bD,true))))?{$:1,$0:bE}:null;};F.EntityManyofMany=function(bD,bE){return{$:1,$0:bs.OfArray(bb.ofSeq(bl.map(function(bF){return bl.exists(function(bG){return bG.get_Role()===bF;},bE)?[bF,{$:1,$0:bl.filter(function(bG){return bG.get_Role()===bF;},bE)}]:[bF,null];},bD)))};};F.EntityManyOf1=function(bD,bE){var bF;return bE!=null&&bE.$==1&&(bl.exists(function(bG){return bG.get_Role()===bD;},bE.$0)&&(bF=bE.$0,true))?{$:1,$0:bl.filter(function(bG){return bG.get_Role()===bD;},bF)}:null;};F.Entity1OfAny=function(bD,bE){var bF;return bE!=null&&bE.$==1&&(bl.exists(function(bG){return bG.get_Role()===bD;},bE.$0)&&(bF=bE.$0,true))?{$:1,$0:bl.head(bl.sortBy(function(bG){return bG.get_Role();},bl.filter(function(bG){return bG.get_Role()===bD;},bF)))}:null;};F.Entity1Of1=function(bD,bE){var bF,bG;return bE!=null&&bE.$==1&&(bE.$0.$==1&&(bE.$0.$1.$==0&&((bG=bE.$0.$0,bG.get_Role()===bD||bG.get_Name()===bD)&&(bF=bE.$0.$0,true))))?{$:1,$0:bF}:null;};F.Intent$1=function(bD,bE){return bE.get_Intent()!=null&&bE.get_Intent().$0.get_Name()===bD?{$:1,$0:[bE.get_Traits(),bE.get_Entities()]}:null;};S.$cctor=function(){S.$cctor=a.ignore;S.entity_types=bl.ofArray(["wit$contact:name","wit$datetime:datetime","term:subject","term:object","term:verb"]);S.trait_types=bl.ofArray(["domain","dialogue_act"]);S.intentConfidenceThreshold=0.85;S.entityConfidenceThreshold=0.85;};U.MicReady={$:5};U.MicAudioEnd={$:4};U.MicAudioStart={$:3};U.MicDisconnected={$:2};U.MicConnecting={$:1};U.MicNotInitialized={$:0};V.ClientUnderstand={$:2};V.ClientReady={$:1};V.ClientNotInitialzed={$:0};W=T.Interpreter=$.Class({get_Options:function(){return(this.get_Unwrap())[2];},get_Text:function(){return(this.get_Unwrap())[1];},get_Voice:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1[0],this.$1[1]];}},null,W);X=T.CUI=$.Class({GetSameTextTypingPattern:function(bD,bE){var bF,bG;return this.TypingDNA.getTypingPattern(bE==null?(bF={type:1},bF.text=bD,bF.caseSensitive=false,bF):(bG={type:1},bG.text=bD,bG.caseSensitive=false,bG.targetId=bE.$0,bG));},MonitorTypingPattern:function(bD){this.TypingDNA.reset();bD!=null?this.TypingDNA.addTarget(bD.$0):void 0;this.TypingDNA.start();},SayVoices:function(){var bD,bE,bF;bD=this;bE=a.speechSynthesis.getVoices();!(bE==null)?(bF=d.toArray(bE),bD.Say((function(bG){return function(bH){return bG("There are currently "+a.String(bH)+" voices installed on this computer or device.");};}(a.id))(bb.length(bF))),bb.iteri(function(bG,bH){return bD.Say((((($.Curried(function(bI,bJ,bK,bL){return bI("Voice "+a.String(bJ)+". Name: "+bh.toSafe(bK)+", Local: "+bh.prettyPrint(bL)+".");},4))(a.id))(bG))(bH.name))(bH.localService));},bF)):void 0;},Wait:function(bD){this.Wait$1(function(){bo.Start(bD,null);});},Wait$1:function(bD){this["Echo'"]("please wait...");this.Term.pause();bD();this.Term.resume();},sayRandom:function(bD,bE){this.Say(D.getRandomPhrase(bD,bE));},SayAngry:function(bD){var bE,bF;bE=this;bo.Start((bF=null,bo.Delay(function(){return bo.Combine(a.speechSynthesis.speaking?(a.speechSynthesis.cancel(),bv.chime(),bo.Zero()):bo.Zero(),bo.Delay(function(){a.addMessage(bE.Avatar,bD,"","");bE.Avatar.processMessages(0);return bo.Zero();}));})),null);},SayDoc:function(bD){var bE,bF,bG;bE=bb.get(bj(".terminal-output").get(),0).childNodes.length;bF=bd.Element("div",[d.cls("terminal-command"),d.dindex(bE+1)],[bD]);bG=d.termOutput();bg.LoadLocalTemplates("");bd.RunAppend(bG,bF);},Say:function(bD){var bE,bF;bE=this;bo.Start((bF=null,bo.Delay(function(){return bo.Combine(a.speechSynthesis.speaking?(bv.chime(),bo.Zero()):bo.Zero(),bo.Delay(function(){bE.Avatar.addMessage(bD);bE.Avatar.processMessages(0);return bo.Zero();}));})),null);},Debug:function(bD,bE){d.debug(bD,bE);},"EchoHtml'":function(bD){var bE,bF;bE=(bF={},bF.raw=true,bF);this.Term.disable();this.Term.echo(bD,bE);this.Term.enable();},"Echo'":function(bD){this.Term.disable();this.Term.echo(bD);this.Term.enable();}},null,X);X.New=function(bD,bE,bF,bG,bH,bI,bJ){return new X({Voice:bD,Mic:bE,Term:bF,Avatar:bG,Caption:bH,TypingDNA:bI,AudioEnd:bJ});};Y=c.Dialogue=$.Class({get_Utterances:function(){return this.$4;},get_Output:function(){return this.$3;},get_DialogueQuestions:function(){return this.$2;},get_Props:function(){return this.$1;},get_Cui:function(){return this.$0;}},null,Y);Z=c.Question=$.Class({toString:function(){return(((($.Curried(function(bD,bE,bF,bG){return bD("Name: "+bh.toSafe(bE)+" Module: "+bh.toSafe(bF)+" Type: "+_8.p$8(bG)+" ");},4))(a.id))(this.get_Name()))(this.get_Module()))(this.get_Type());},get_Ask:function(){return this.$3;},get_Type:function(){return this.$2;},get_Module:function(){return this.$1;},get_Name:function(){return this.$0;}},null,Z);_0.ConceptCompletion={$:3};_0.Disjunctive={$:2};_0.Verification={$:1};_0.UserAuthentication={$:0};_1["Response'_"]=function(bD,bE,bF){var bG,bH,bI,bJ,bK,bL,bM;return(bH=_1.PropNotSet_(bD,"user",bF),bH!=null&&bH.$==1?(bI=_1.Form(bD,bE,bH.$0),bI!=null&&bI.$==1?(bG=bI.$0,true):(bJ=_1.PropNotSet_(bD,"user",bF),bJ!=null&&bJ.$==1&&(bK=_1.NotForm(bD,bE,bJ.$0),bK!=null&&bK.$==1&&(bG=bK.$0,true)))):(bL=_1.PropNotSet_(bD,"user",bF),bL!=null&&bL.$==1&&(bM=_1.NotForm(bD,bE,bL.$0),bM!=null&&bM.$==1&&(bG=bM.$0,true))))?_1.have(bD,bE)?{$:1,$0:[bG,{$:1,$0:bD.get_Props().get_Item(bE)}]}:{$:1,$0:[bG,null]}:null;};_1.Response_=function(bD,bE,bF){var bG,bH,bI,bJ,bK,bL,bM;return(bH=_1.PropSet_(bD,"user",bF),bH!=null&&bH.$==1?(bI=_1.Form(bD,bE,bH.$0),bI!=null&&bI.$==1?(bG=bI.$0,true):(bJ=_1.PropSet_(bD,"user",bF),bJ!=null&&bJ.$==1&&(bK=_1.NotForm(bD,bE,bJ.$0),bK!=null&&bK.$==1&&(bG=bK.$0,true)))):(bL=_1.PropSet_(bD,"user",bF),bL!=null&&bL.$==1&&(bM=_1.NotForm(bD,bE,bL.$0),bM!=null&&bM.$==1&&(bG=bM.$0,true))))?_1.have(bD,bE)?{$:1,$0:[bG,{$:1,$0:bD.get_Props().get_Item(bE)}]}:{$:1,$0:[bG,null]}:null;};_1.NotForm=function(bD,bE,bF){return bD.get_DialogueQuestions().length>0&&(bD.get_DialogueQuestions())[0].get_Name()===bE&&bF.get_Text()!==""?{$:1,$0:bF}:null;};_1.Form=function(bD,bE,bF){return bD.get_DialogueQuestions().length>0&&(bD.get_DialogueQuestions())[0].get_Name()===bE&&bF.get_Text()===""&&bF.get_Intent()!=null&&bF.get_Intent().$0.get_Name()===bE&&bw.Equals(bF.get_Traits(),null)&&bw.Equals(bF.get_Entities(),null)?{$:1,$0:bF}:null;};_1["User'_"]=function(bD,bE){var bF,bG;return(bG=_1.PropNotSet_(bD,"user",bE),bG!=null&&bG.$==1&&(bD.get_DialogueQuestions().length===0&&(bF=bG.$0,true)))?{$:1,$0:bF}:null;};_1.User_=function(bD,bE){var bF,bG;return(bG=_1.PropSet_(bD,"user",bE),bG!=null&&bG.$==1&&(bD.get_DialogueQuestions().length===0&&(bF=bG.$0,true)))?{$:1,$0:bF}:null;};_1.PropNotSet_=function(bD,bE,bF){return!_1.have(bD,bE)?{$:1,$0:bF}:null;};_1.PropSet_=function(bD,bE,bF){return _1.have(bD,bE)?{$:1,$0:bF}:null;};_1.Agenda_=function(bD,bE,bF,bG){return bD.get_DialogueQuestions().length>0&&(bD.get_DialogueQuestions())[0].get_Module()===bF?{$:1,$0:null}:null;};_1.debugInterpreterEnd=function(bD,bE,bF){bE((((($.Curried(function(bG,bH,bI,bJ){return bG(bh.toSafe(bH)+" ending utterances:"+bh.prettyPrint(bI)+", questions: "+bh.prettyPrint(bJ)+".");},4))(a.id))(bF))(bD.get_Utterances()))(bD.get_DialogueQuestions()));};_1.debugInterpreterStart=function(bD,bE,bF){bE((((($.Curried(function(bG,bH,bI,bJ){return bG(bh.toSafe(bH)+" starting utterances:"+bh.prettyPrint(bI)+", questions: "+bh.prettyPrint(bJ)+".");},4))(a.id))(bF))(bD.get_Utterances()))(bD.get_DialogueQuestions()));};_1.frame=function(bD){return bl.ofSeq(bm.take(bD.length>=5?5:bD.length,bD));};_1.didNotUnderstand=function(bD,bE,bF){bE((function(bG){return function(bH){return bG(bh.toSafe(bH)+" interpreter did not understand utterance.");};}(a.id))(bF));_1.popu(bD,bE);_1.say(bD,"Sorry I didn't understand what you meant.");};_1.trigger=function(bD,bE,bF,bG){_1.pushu(bD,bE,new J({$:0,$0:bG,$1:null,$2:null,$3:null}));bF(bD);};_1.endt=function(bD,bE,bF,bG){_1.popu(bD,bE);_1.popq(bD,bE);_1.have(bD,bF)?_1.remove(bD,bE,bF):void 0;bE((function(bH){return function(bI){return bH("End turn "+bh.toSafe(bI)+".");};}(a.id))(bF));bG();};_1.handle=function(bD,bE,bF,bG){_1.popu(bD,bE);bE((function(bH){return function(bI){return bH("Handle utterance "+bh.toSafe(bI)+".");};}(a.id))(bF));bG();};_1.ask=function(bD,bE,bF){_1.pushq(bD,bE,bF);(bF.get_Ask())(bD);};_1.dispatch=function(bD,bE,bF,bG){bE((((($.Curried(function(bH,bI,bJ,bK){return bH("Dispatch to module "+bh.toSafe(bI)+" utterances: "+bh.prettyPrint(bJ)+" questions: "+bh.prettyPrint(bK)+".");},4))(a.id))(bF))(bD.get_Utterances()))(bD.get_DialogueQuestions()));bG(bD);};_1.popq=function(bD,bE){var bF;bF=bD.get_DialogueQuestions().shift();bE((function(bG){return function(bH){return bG("Pop "+_8.p$9(bH)+".");};}(a.id))(bF));};_1.pushq=function(bD,bE,bF){bD.get_DialogueQuestions().unshift(bF);bE((function(bG){return function(bH){return bG("Push "+_8.p$9(bH)+".");};}(a.id))(bF));};_1.popu=function(bD,bE){var bF;bF=bD.get_Utterances().shift();bE((function(bG){return function(bH){return bG("Pop "+_8.p$7(bH)+".");};}(a.id))(bF));};_1.pushu=function(bD,bE,bF){bE((function(bG){return function(bH){return bG("Push "+_8.p$7(bH)+".");};}(a.id))(bF));bD.get_Utterances().unshift(bF);};_1.remove=function(bD,bE,bF){bE((function(bG){return function(bH){return bG("Remove property "+bh.toSafe(bH)+".");};}(a.id))(bF));bD.get_Props().Remove(bF);};_1.add=function(bD,bE,bF,bG){bD.get_Props().Add(bF,bG);bE(((($.Curried3(function(bH,bI,bJ){return bH("Add property "+bh.toSafe(bI)+":"+bh.prettyPrint(bJ)+".");}))(a.id))(bF))(bG));};_1.prop=function(bD,bE){return bD.get_Props().ContainsKey(bE)?bD.get_Props().get_Item(bE):(function(bF){return function(bG){return bF("The "+bh.toSafe(bG)+" dialogue property does not exist.");};}(bx.FailWith))(bE);};_1.have=function(bD,bE){return bD.get_Props().ContainsKey(bE);};_1["sayRandom'"]=function(bD,bE){_1.sayRandom(bD,bE,"");};_1.sayRandom=function(bD,bE,bF){var bG;bG=D.getRandomPhrase(bE,bF);bD.get_Output().unshift(bG);bD.get_Cui().Say(bG);};_1.say=function(bD,bE){bD.get_Output().unshift(bE);_1["say'"](bD,bE);};_1["say'"]=function(bD,bE){bD.get_Cui().Say(bE);};_1.echo=function(bD,bE){(bD.get_Cui())["EchoHtml'"](bE);};_2.update=function(bD){var bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx;function cy(cS){_1.echo(bD,cS);}function cz(cS){_1.say(bD,cS);}function cA(cS,cT){return _1.sayRandom(bD,cS,cT);}function cB(cS){return _1.prop(bD,cS);}function cC(cS,cT){return _1.add(bD,function(cU){_2.debug(cU);},cS,cT);}function cD(cS){_2.debug(cS);}function cE(cS){_2.debug(cS);}function cF(cS){_2.debug(cS);}function cG(cS){_2.debug(cS);}function cH(cS){_2.update(cS);}function cI(cS){return _1.User_(bD,cS);}function cJ(cS){return _1["User'_"](bD,cS);}function cK(cS,cT){return _1.Response_(bD,cS,cT);}function cL(cS,cT){return _1["Response'_"](bD,cS,cT);}function cM(){return cB("user");}function cN(cS){return new Z({$:0,$0:"authenticateNewUser",$1:_2.name(),$2:_0.UserAuthentication,$3:function(cT){var cU;function cV(){var cY,cZ,c0;cY=d.getCameraCanvas().toDataURL();_2.debug(cY);d.stopCamera();cZ=cT.get_Cui().GetSameTextTypingPattern(cU,null);c0=d.getDialogueBoxInput().value;_2.debug(((($.Curried3(function(c1,c2,c3){return c1("User entered typing pattern "+bh.toSafe(c2)+" for text "+bh.toSafe(c3));}))(a.id))(cZ))(c0));return c0.toLowerCase()!==cU.toLowerCase()?(cz("Sorry you did not enter the passphrase correctly. Please try again."),false):(cC("authenticateNewUser",{$:1,$0:[cS,cZ,cY]}),true);}function cW(){var cY;cT.get_Cui().MonitorTypingPattern(null);cY=d.createDialogueBoxCanvas();d.startCamera(self.document.body,cY);}function cX(){d.questionBox("Biometric Authentication","",640,480,null,{$:1,$0:cW},function(){if(cV())bH("authenticateNewUser");else cX();});}cU=(function(cY){return function(cZ){return cY("Hello my name is "+bh.toSafe(cZ)+" and I am a user");};}(a.id))(cS);cz((function(cY){return function(cZ){return cY("Enter the phrase "+bh.toSafe(cZ)+".");};}(a.id))(cU));cX();}});}function cO(cS){return new Z({$:0,$0:"authenticateUser",$1:_2.name(),$2:_0.UserAuthentication,$3:function(cT){var cU;cT.get_Cui().TypingDNA.reset();d.questionBox("Biometric Authentication","",640,480,null,null,function(){var cV,cW;cV=cT.get_Cui().GetSameTextTypingPattern((function(cX){return function(cY){return cX("Hello my name is "+bh.toSafe(cY)+" and I am an administrator");};}(a.id))(cS),null);_2.debug((function(cX){return function(cY){return cX("User entered typing pattern "+bh.toSafe(cY));};}(a.id))(cV));cV==null?bH("authenticateUser"):bo.Start((cW=null,bo.Delay(function(){return bo.Bind((new bz.New()).Async("SMApp.Web:SMApp.Web.Server.verifyUserTypingPattern:1718027044",[cS,cV]),function(cX){_2.debug((function(cY){return function(cZ){return cY("TypingDNA: "+_8.p$10(cZ));};}(a.id))(cX));return bo.Combine(cX.$==1?(d.error(cX.$0),cC("authenticateUser",null),bo.Zero()):(cC("authenticateUser",{$:1,$0:cX.$0}),bo.Zero()),bo.Delay(function(){bH("authenticateUser");return bo.Zero();}));});})),null);});bb.get(bj(".swal2-input").get(),0);cT.get_Cui().MonitorTypingPattern(null);cU=d.createCanvas("camera","640","480",bb.get(bj(".swal2-content").get(),0).firstChild);d.startCamera(self.document.body,cU);}});}function cP(cS){return new Z({$:0,$0:"switchUser",$1:_2.name(),$2:_0.Verification,$3:function(){cz((function(cT){return function(cU){return cT("Do you want me to switch to the user "+bh.toSafe(cU));};}(a.id))(cS));}});}function cQ(cS){var cT;cA(D.waitRetrievePhrases(),"user name");bo.Start((cT=null,bo.Delay(function(){return bo.Bind((new bz.New()).Async("SMApp.Web:SMApp.Web.Server.getUser:-293172922",[cS]),function(cU){var cV;return cU==null?(cz((function(cW){return function(cX){return cW("I did not find a user with the name "+bh.toSafe(cX)+".");};}(a.id))(cS)),bE(new Z({$:0,$0:"addUser",$1:_2.name(),$2:_0.Verification,$3:function(){cC("addUser",cS);cz((function(cW){return function(cX){return cW("Do you want me to add the user "+bh.toSafe(cX)+"?");};}(a.id))(cS));}})),bo.Zero()):(cV=cU.$0,bo.Bind((new bz.New()).Async("SMApp.Web:SMApp.Web.Server.updateUserLastLogin:-1212651201",[cV.Name]),function(){cC("loginUser",cV);cA(D.helloUserPhrases(),(function(cW){return function(cX){return cW(bh.prettyPrint(cX));};}(a.id))(cV.Name));return cV.LastLoggedIn!=null?bo.Bind((new bz.New()).Async("SMApp.Web:SMApp.Web.Server.humanize:1102227529",[cV.LastLoggedIn.$0]),function(cW){cz((function(cX){return function(cY){return cX("You last logged in "+bh.toSafe(cY)+".");};}(a.id))(cW));cz("Since you will be accessing sensitive data I need to authenticate you via facial recognition and typing behaviour. Enter the pass phrase you were assigned during enrollment in the box provided. Then, look into your camera until you see the red box around your face and press the Ok button.");bE(cO(cS));return bo.Zero();}):bo.Zero();}));});})),null);}function cR(cS,cT,cU){var cV;return bo.Start((cV=null,bo.Delay(function(){cA(D.waitAddPhrases(),"symptom entry");return bo.Bind((new bz.New()).Async("SMApp.Web:SMApp.Web.Server.addSymptomJournalEntry:194264293",[cM().Name,cS,cT,cU]),function(cW){return cW.$==1?(cz(function(cX){return cX("Sorry I wasn't able to add that symptom to your journal. Could you try again?");}(a.id)),bo.Zero()):(cz((function(cX){return function(cY){return cX("OK I added that "+bh.toSafe(cY)+" symptom to your journal.");};}(a.id))(cS)),bo.Zero());});})),null);}_1.debugInterpreterStart(bD,function(cS){_2.debug(cS);},_2.name());bE=function(cS){_1.ask(bD,cD,cS);};bF=$.Curried(_1.handle,2,[bD,cE]);bG=$.Curried(_1.endt,2,[bD,cF]);bH=function(cS){_1.trigger(bD,cG,cH,cS);};bI=_1.frame(bD.$4);bI.$==1&&(bK=cJ(bI.$0),bK!=null&&bK.$==1&&(bL=F.Intent$1("greet",bK.$0),bL!=null&&bL.$==1&&(bM=F.Entity1Of1("name",bL.$0[1]),bM!=null&&bM.$==1&&(bI.$1.$==0&&(bJ=bM.$0,true)))))?(bF("loginUser"))(function(){cQ(bJ.get_Value());}):bI.$==1&&(bO=cJ(bI.$0),bO!=null&&bO.$==1&&(bP=F.Intent$1("hello",bO.$0),bP!=null&&bP.$==1&&(bQ=F.Entity1Of1("contact",bP.$0[1]),bQ!=null&&bQ.$==1&&(bI.$1.$==0&&(bN=bQ.$0,true)))))?(bF("loginUser"))(function(){cQ(bN.get_Value());}):bI.$==1&&(bS=cL("authenticateUser",bI.$0),bS!=null&&bS.$==1&&(bI.$1.$==0&&(bR=bS.$0[1],true)))?(bG("authenticateUser"))(function(){cz("You are now authenticated.");}):bI.$==1&&(bU=F.Yes(bI.$0),bU!=null&&bU.$==1&&(bV=cL("addUser",bU.$0),bV!=null&&bV.$==1&&(bW=F.Str(bV.$0[1]),bW!=null&&bW.$==1&&(bI.$1.$==0&&(bT=bW.$0,true)))))?(bG("addUser"))(function(){bE(cN(bT));}):bI.$==1&&(bY=F.No(bI.$0),bY!=null&&bY.$==1&&(bZ=cL("addUser",bY.$0),bZ!=null&&bZ.$==1&&(b0=F.Str(bZ.$0[1]),b0!=null&&b0.$==1&&(bI.$1.$==0&&(bX=b0.$0,true)))))?(bG("addUser"))(function(){cz((function(cS){return function(cT){return cS("Ok I did not add the user "+bh.toSafe(cT)+". But you must login for me to help you.");};}(a.id))(bX));}):bI.$==1&&((b2=cL("authenticateNewUser",bI.$0),b2!=null&&b2.$==1)&&bI.$1.$==0)?(bG("authenticateNewUser"))(function(){cz("Authenticating new user.");}):bI.$==1&&(b4=cI(bI.$0),b4!=null&&b4.$==1&&(b5=F.Intent$1("hello",b4.$0),b5!=null&&b5.$==1&&(b5.$0[0]==null&&(b6=F.Entity1Of1("name",b5.$0[1]),b6!=null&&b6.$==1&&(bI.$1.$==0&&(b3=b6.$0,true))))))?bo.Start((b7=null,bo.Delay(function(){return bo.Bind((new bz.New()).Async("SMApp.Web:SMApp.Web.Server.getUser:-293172922",[b3.get_Value()]),function(cS){return cS==null?(cz((function(cT){return function(cU){return cT("Sorry, the user "+bh.toSafe(cU)+" does not exist.");};}(a.id))(b3.get_Value())),bo.Zero()):(bE(cP(cS.$0.Name)),bo.Zero());});})),null):bI.$==1&&(b9=F.Yes(bI.$0),b9!=null&&b9.$==1&&(b_=cK("switchUser",b9.$0),b_!=null&&b_.$==1&&(b$=F.Str(b_.$0[1]),b$!=null&&b$.$==1&&(bI.$1.$==0&&(b8=b$.$0,true)))))?(bD.$1.set_Item("user",b8),cz((function(cS){return function(cT){return cS("Ok I switched to user "+bh.prettyPrint(cT)+".");};}(a.id))(b8))):bI.$==1&&(cb=F.No(bI.$0),cb!=null&&cb.$==1&&(cc=cK("switchUser",cb.$0),cc!=null&&cc.$==1&&(cd=F.Str(cc.$0[1]),cd!=null&&cd.$==1&&(bI.$1.$==0&&(ca=cd.$0,true)))))?cz((function(cS){return function(cT){return cS("Ok I did not switch to user "+bh.toSafe(cT)+".");};}(a.id))(ca)):bI.$==1&&(cf=cJ(bI.$0),cf!=null&&cf.$==1?(cg=F.Intent$1("kbquery",cf.$0),cg!=null&&cg.$==1)?bI.$1.$==0&&(ce=cf.$0,true):(ch=cI(bI.$0),ch!=null&&ch.$==1&&((ci=F.Intent$1("kbquery",ch.$0),ci!=null&&ci.$==1)&&(bI.$1.$==0&&(ce=ch.$0,true)))):(cj=cI(bI.$0),cj!=null&&cj.$==1&&((ck=F.Intent$1("kbquery",cj.$0),ck!=null&&ck.$==1)&&(bI.$1.$==0&&(ce=cj.$0,true)))))?bo.Start((cl=null,bo.Delay(function(){return bo.Bind(y.getAnswer(ce.get_Text()),function(cS){var cT;return bo.Bind((cT=bb.get(cS.answers,0).answer,(new bz.New()).Async("SMApp.Web:SMApp.Web.Server.mdtohtml:267002556",[cT])),function(cU){var cV;return bo.Bind((cV=bb.get(cS.answers,0).answer,(new bz.New()).Async("SMApp.Web:SMApp.Web.Server.mdtotext:267002556",[cV])),function(cW){cy(cU);cz(cW);return bo.Zero();});});});})),null):bI.$==1&&(cn=cI(bI.$0),cn!=null&&cn.$==1&&(co=F.Intent$1("symptom",cn.$0),co!=null&&co.$==1&&(cp=F.Entity1OfAny("symptom_name",co.$0[1]),cp!=null&&cp.$==1&&(bI.$1.$==0&&(cm=cp.$0,true)))))?bo.Start((cq=null,bo.Delay(function(){cz("Ok I'll add that entry to your symptom journal");cR(cm.get_Value(),null,null);return bo.Zero();})),null):bI.$==1&&(cs=F.Yes(bI.$0),cs!=null&&cs.$==1&&((ct=cK("painVideo",cs.$0),ct!=null&&ct.$==1)&&bI.$1.$==0))?bD.$0["EchoHtml'"]("<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/SkAqOditKN0\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>"):bI.$==1&&(cv=cI(bI.$0),cv!=null&&cv.$==1&&(cw=F.Intent$1("medjournal",cv.$0),cw!=null&&cw.$==1&&((cx=cw.$0[1],cx!=null&&cx.$==1)&&(bI.$1.$==0&&(cu=cw.$0[1].$0,true)))))?(cz("ok I added that entry to your medication journal."),cz("You should be careful not to take too many painkillers over a short period of time.")):_1.didNotUnderstand(bD,function(cS){_2.debug(cS);},_2.name());_1.debugInterpreterEnd(bD,function(cS){_2.debug(cS);},_2.name());};_2.debug=function(bD){d.debug(_2.name(),bD);};_2.name=function(){_3.$cctor();return _3.name;};_3.$cctor=function(){_3.$cctor=a.ignore;_3.name="User";};_4.update=function(bD){var bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY;function bZ(b4){_1.say(bD,b4);}function b0(b4){_1["sayRandom'"](bD,b4);}function b1(b4){_4.debug(b4);}function b2(b4){_4.debug(b4);}function b3(b4){return _1["User'_"](bD,b4);}bE=bD.$4;_4.debug((((($.Curried(function(b4,b5,b6,b7){return b4("Module "+bh.toSafe(b5)+" starting utterances:"+bh.prettyPrint(b6)+", questions: "+bh.prettyPrint(b7)+".");},4))(a.id))(_4.name()))(bE))(bD.$2));bF=$.Curried(_1.dispatch,2,[bD,b1]);bG=$.Curried(_1.handle,2,[bD,b2]);bH=bl.ofSeq(bm.take(bE.length>=5?5:bE.length,bE));bI=_1.Agenda_(bD,function(b4){_4.debug(b4);},_2.name(),bH);bI!=null&&bI.$==1?(_4.debug((function(b4){return function(b5){return b4("Agenda is "+_8.p$9(b5)+".");};}(a.id))((bD.get_DialogueQuestions())[0])),_2.update(bD)):bH.$==1&&(bK=(bL=_1.PropNotSet_(bD,"started",bH.$0),bL!=null&&bL.$==1?{$:1,$0:bL.$0}:null),bK!=null&&bK.$==1&&(bM=b3(bK.$0),bM!=null&&bM.$==1&&(bN=F.Intent$1("greet",bM.$0),bN!=null&&bN.$==1&&(bN.$0[1]==null&&bH.$1.$==0))))?(_1.add(bD,function(b4){_4.debug(b4);},"started",true),(bG("greet"))(function(){b0(D.helloPhrases());})):bH.$==1&&(bP=b3(bH.$0),bP!=null&&bP.$==1&&(bQ=F.Intent$1("greet",bP.$0),bQ!=null&&bQ.$==1&&(bQ.$0[1]==null&&bH.$1.$==0)))?(bG("greet"))(function(){bZ("Hello, tell me your name to get started.");}):bH.$==1&&(bS=b3(bH.$0),bS!=null&&bS.$==1&&(bT=F.Intent$1("greet",bS.$0),bT!=null&&bT.$==1&&((bU=F.Entity1Of1("name",bT.$0[1]),bU!=null&&bU.$==1)&&bH.$1.$==0)))?(bF(_2.name()))(function(b4){_2.update(b4);}):bH.$==1&&(bW=b3(bH.$0),bW!=null&&bW.$==1&&(bX=F.Intent$1("hello",bW.$0),bX!=null&&bX.$==1&&((bY=F.Entity1Of1("contact",bX.$0[1]),bY!=null&&bY.$==1)&&bH.$1.$==0)))?(bF(_2.name()))(function(b4){_2.update(b4);}):_1.didNotUnderstand(bD,function(b4){_4.debug(b4);},_4.name());_1.debugInterpreterEnd(bD,function(b4){_4.debug(b4);},_4.name());};_4.debug=function(bD){d.debug(_4.name(),bD);};_4.name=function(){_5.$cctor();return _5.name;};_5.$cctor=function(){_5.$cctor=a.ignore;_5.name="Main";};_6.run=function(){var bD,bE;bD=$.ThisFunc(function(bF,bG){return((_6.Main().get_Text())(bF))(bG);});bE=_6.Main().get_Options();a.$("#term").terminal(bD,bE);return bd.get_Empty();};_6.Main=function(){_7.$cctor();return _7.Main;};_6.initMic=function(bD){var bE,bF;_6.set_CUI((bE={$:1,$0:new bA.Microphone(bB.getElementById("microphone"))},X.New(_6.CUI().Voice,bE,_6.CUI().Term,_6.CUI().Avatar,_6.CUI().Caption,_6.CUI().TypingDNA,_6.CUI().AudioEnd)));bF=_6.CUI().Mic.$0;bF.onconnecting=function(){_6.set_MicState(U.MicConnecting);return _6.debug("Mic connecting...");};bF.ondisconnected=function(){_6.set_MicState(U.MicDisconnected);return _6.debug("Mic disconnected.");};bF.onaudiostart=function(){_6.set_MicState(U.MicAudioStart);return _6.debug("Mic audio start...");};bF.onaudioend=function(){_6.set_MicState(U.MicAudioEnd);_6.debug("Mic audio end.");return _6.debug(self.lastMicData);};bF.onerror=function(bG){_6.set_MicState({$:6,$0:bG});return _6.debug((function(bH){return function(bI){return bH("Mic error : "+bh.toSafe(bI)+".");};}(a.id))(bG));};bF.onready=function(){_6.set_MicState(U.MicReady);return _6.debug("Mic ready.");};bF.onresult=function(bG,bH){return _6.ClientState().$==2?_6.echo("I'm still trying to understand what you said before."):_6.ClientState().$==0?d.error("Client is not intialized."):!(bG==null||bH==null)?(_6.set_MicState({$:7,$0:bG,$1:bH}),_6.debug(((($.Curried3(function(bI,bJ,bK){return bI("Mic result: "+bh.prettyPrint(bJ)+" "+bh.prettyPrint(bK)+".");}))(a.id))(bG))(bH)),bD(bG,bH)):_6.debug("Mic: No result returned.");};bF.connect("4Y2BLQY5TWLIN7HFIV264S53MY4PCUAT");};_6.sayRandom=function(bD,bE){_6.say(D.getRandomPhrase(bE,bD));};_6.say=function(bD){_6.Output().unshift(bD);_6["say'"](bD);};_6["say'"]=function(bD){_6.CUI().Say(bD);};_6.initSpeech=function(){var bD;bD=d.toArray(_6.synth().getVoices());bb.length(bD)>0?(bb.iter(function(bE){if(bw.Equals(_6.CUI().Voice,null)&&(bE.name.indexOf("Microsoft Zira")!=-1||bE.name.toLowerCase().indexOf("female")!=-1)){_6.set_CUI(X.New({$:1,$0:bE},_6.CUI().Mic,_6.CUI().Term,_6.CUI().Avatar,_6.CUI().Caption,_6.CUI().TypingDNA,_6.CUI().AudioEnd));_6.debug((function(bF){return function(bG){return bF("Using browser speech synthesis voice "+bh.toSafe(bG)+".");};}(a.id))(_6.CUI().Voice.$0.name));}},bD),!bw.Equals(_6.CUI().Voice,null)?(_6.CUI().Avatar.nativeVoice=true,_6.CUI().Avatar.nativeVoiceName=_6.CUI().Voice.$0.name,_6.debug((function(bE){return function(bF){return bE("Using browser speech synthesis voice "+bh.toSafe(bF)+".");};}(a.id))(_6.CUI().Voice.$0.name))):void 0):void 0;bw.Equals(_6.CUI().Voice,null)?_6.debug("No female browser speech synthesis voice is available. Using CMU SLT Female voice via TTS."):void 0;};_6.synth=function(){_7.$cctor();return _7.synth;};_6.push=function(bD){_6.Utterances().unshift(bD);return _6.Dialogue();};_6.Dialogue=function(){_7.$cctor();return _7.Dialogue;};_6.Utterances=function(){_7.$cctor();return _7.Utterances;};_6.Questions=function(){_7.$cctor();return _7.Questions;};_6.Output=function(){_7.$cctor();return _7.Output;};_6.Props=function(){_7.$cctor();return _7.Props;};_6.wait=function(bD){d["Terminal.Echo'"](_6.CUI().Term,"please wait");_6.CUI().Term.pause();bD();_6.CUI().Term.resume();};_6.debug=function(bD){d.debug("CLIENT",bD);};_6.echo=function(bD){d["Terminal.EchoHtml'"](_6.CUI().Term,(function(bE){return function(bF){return bE(bh.prettyPrint(bF));};}(a.id))(bD));};_6.ClientState=function(){_7.$cctor();return _7.ClientState;};_6.set_ClientState=function(bD){_7.$cctor();_7.ClientState=bD;};_6.MicState=function(){_7.$cctor();return _7.MicState;};_6.set_MicState=function(bD){_7.$cctor();_7.MicState=bD;};_6.CUI=function(){_7.$cctor();return _7.CUI;};_6.set_CUI=function(bD){_7.$cctor();_7.CUI=bD;};_7.$cctor=function(){var bD,bE,bF,bG;_7.$cctor=a.ignore;function bH(bJ,bK){var bL,bM,bN,bO,bP,bQ,bR;_6.debug(((($.Curried3(function(bS,bT,bU){return bS("Voice: "+bh.prettyPrint(bT)+" "+bh.prettyPrint(bU));}))(a.id))(bJ))(bK));bL=(bM=K["Intent'"](bJ,bK),bM!=null&&bM.$==1?{$:1,$0:bM.$0}:null);bN=(bO=K["Trait'"](bK),bO!=null&&bO.$==1?{$:1,$0:bl.ofArray([bO.$0])}:null);bP=(bQ=K["Entity'$1"](bK),bQ!=null&&bQ.$==1?{$:1,$0:bl.ofArray([bQ.$0])}:null);bL==null&&(bN==null&&bP==null)?void 0:(_6.debug((((($.Curried(function(bS,bT,bU,bV){return bS("Voice: "+_8.p(bT)+" "+_8.p$3(bU)+" "+_8.p$5(bV));},4))(a.id))(bL))(bN))(bP)),_4.update(_6.push(new J({$:0,$0:"",$1:bL,$2:bN,$3:bP}))));}function bI(bJ,bK){var bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX;_6.set_CUI(X.New(_6.CUI().Voice,_6.CUI().Mic,bJ,_6.CUI().Avatar,_6.CUI().Caption,_6.CUI().TypingDNA,_6.CUI().AudioEnd));if(bw.Equals(_6.CUI().Mic,null))_6.initMic(bH);if(bw.Equals(_6.CUI().Voice,null))_6.initSpeech();if(_6.ClientState().$===0)_6.set_ClientState(V.ClientReady);bV=M.Blank(bK);if(bV!=null&&bV.$==1)return _6["say'"]("Tell me what you want me to do or ask me a question.");else{bW=M.Debug(bK);if(bW!=null&&bW.$==1){_6.debug((function(bY){return function(bZ){return bY("Utterances: "+bh.prettyPrint(bZ));};}(a.id))(_6.Utterances()));_6.debug((function(bY){return function(bZ){return bY("Questions: "+bh.prettyPrint(bZ));};}(a.id))(_6.Questions()));bL=_6.Props().GetEnumerator$1();try{while(bL.MoveNext()){bX=bL.Current();_6.debug(((($.Curried3(function(bY,bZ,b0){return bY(bh.toSafe(bZ)+": "+bh.prettyPrint(b0));}))(a.id))(bX.K))(bX.V));}return;}finally{bL.Dispose();}}else{bM=M.Voices(bK);return bM!=null&&bM.$==1?(bN=d.toArray(d.speechSynthesis().getVoices()),_6["say'"]((function(bY){return function(bZ){return bY("There are currently "+a.String(bZ)+" voices installed on this computer or device.");};}(a.id))(bb.length(bN))),bb.iteri(function(bY,bZ){return _6["say'"]((((($.Curried(function(b0,b1,b2,b3){return b0("Voice "+a.String(b1)+". Name: "+bh.toSafe(b2)+", Local: "+bh.prettyPrint(b3)+".");},4))(a.id))(bY))(bZ.name))(bZ.localService));},bN)):_6.ClientState().$==1?(bP=M.QuickHello(bK),(bP!=null&&bP.$==1?(bO=bP.$0,true):(bQ=M.QuickHelp(bK),bQ!=null&&bQ.$==1?(bO=bQ.$0,true):(bR=M.QuickYes(bK),bR!=null&&bR.$==1?(bO=bR.$0,true):(bS=M.QuickNo(bK),bS!=null&&bS.$==1?(bO=bS.$0,true):(bT=M.QuickNumber(bK),bT!=null&&bT.$==1&&(bO=bT.$0,true))))))?(_6.debug((function(bY){return function(bZ){return bY("Quick Text: "+_8.p$7(bZ)+".");};}(a.id))(bO)),_4.update(_6.push(bO)),_6.set_ClientState(V.ClientReady)):_6.CUI().Wait((bU=null,bo.Delay(function(){_6.set_ClientState(V.ClientUnderstand);M.getUtterance(bK,function(bY){var bZ,b0;bZ=M.HasUtterance(bY);bZ!=null&&bZ.$==1?(b0=bZ.$0,_6.debug((((($.Curried(function(b1,b2,b3,b4){return b1("Text: Intent: "+_8.p(b2)+", Traits: "+_8.p$3(b3)+", Entities: "+_8.p$5(b4)+".");},4))(a.id))(b0.get_Intent()))(b0.get_Traits()))(b0.get_Entities())),_4.update(_6.push(b0))):(_6.debug("Text: Did not receive a meaning from the server."),_6["say'"]("Sorry I did not understand what you said."));});_6.set_ClientState(V.ClientReady);return bo.Zero();})))):_6.ClientState().$==0?d.error("Client is not initialized."):_6["say'"]("I'm still trying to understand what you said before.");}}}_7.CUI=X.New(null,null,null,(bv.applicationId="4277115329081938617",bD=new a.SDKConnection(),bE=new a.WebAvatar(),bE.version=8.5,bE.connection=bD,bE.avatar="20926186",bE.voice="cmu-slt",bE.voiceMod="default",bE.width=175,bE.createBox(),bE.addMessage(""),bE.processMessages(0),bE),false,(bF=new a.TypingDNA(),(bF.stop(),bF)),[]);_7.MicState=U.MicNotInitialized;_7.ClientState=V.ClientNotInitialzed;_7.Props=new bC.New$5();_7.Output=[];_7.Questions=[];_7.Utterances=[];_7.Dialogue=new Y({$:0,$0:_6.CUI(),$1:_6.Props(),$2:_6.Questions(),$3:_6.Output(),$4:_6.Utterances()});_7.synth=a.speechSynthesis;_7.Main=new W({$:0,$0:function(bJ){return bH(bJ[0],bJ[1]);},$1:[function(bJ){return function(bK){return bI(bJ,bK);};},(bG={},bG.name="Main",bG.greetings="Welcome to Selma. Enter 'hello' or 'hello my name is...(you) to initialize speech.",bG.prompt=">",bG)]});};_8.p$8=function(bD){return bD.$==3?"ConceptCompletion":bD.$==2?"Disjunctive":bD.$==1?"Verification":"UserAuthentication";};_9.p=function(bD){return"{"+("text = "+bh.prettyPrint(bD.text))+"; "+("intents = "+bh.printArray(function(bE){return _9.p$1(bE);},bD.intents))+"; "+("entities = "+bh.prettyPrint(bD.entities))+"; "+("traits = "+bh.prettyPrint(bD.traits))+"}";};_9.p$1=function(bD){return"{"+("id = "+bh.prettyPrint(bD.id))+"; "+("name = "+bh.prettyPrint(bD.name))+"; "+("confidence = "+bh.prettyPrint(bD.confidence))+"}";};_8.p$9=function(bD){return"Question ("+bh.prettyPrint(bD.$0)+", "+bh.prettyPrint(bD.$1)+", "+_8.p$8(bD.$2)+", "+"<fun>"+")";};_8.p$10=function(bD){return bD.$==1?"Error "+bh.prettyPrint(bD.$0):"Ok "+_9.p$2(bD.$0);};_9.p$2=function(bD){return"{"+("message = "+bh.prettyPrint(bD.message))+"; "+("message_code = "+bh.prettyPrint(bD.message_code))+"; "+("success = "+bh.prettyPrint(bD.success))+"; "+("result = "+bh.prettyPrint(bD.result))+"; "+("score = "+bh.prettyPrint(bD.score))+"; "+("confidence = "+bh.prettyPrint(bD.confidence))+"}";};_8.p$2=function(bD){return bD==null?"null":"Some "+bh.prettyPrint(bD.$0);};_8.p$1=function(bD){return"Intent ("+bh.prettyPrint(bD.$0)+", "+_8.p$2(bD.$1)+")";};_8.p=function(bD){return bD==null?"null":"Some "+_8.p$1(bD.$0);};_8.p$4=function(bD){return"Trait ("+bh.prettyPrint(bD.$0)+", "+bh.prettyPrint(bD.$1)+", "+_8.p$2(bD.$2)+")";};_8.p$3=function(bD){return bD==null?"null":"Some "+bh.printList(function(bE){return _8.p$4(bE);},bD.$0);};_8.p$6=function(bD){return"Entity ("+bh.prettyPrint(bD.$0)+", "+bh.prettyPrint(bD.$1)+", "+bh.prettyPrint(bD.$2)+", "+_8.p$2(bD.$3)+")";};_8.p$5=function(bD){return bD==null?"null":"Some "+bh.printList(function(bE){return _8.p$6(bE);},bD.$0);};_8.p$7=function(bD){return"Utterance ("+bh.prettyPrint(bD.$0)+", "+_8.p(bD.$1)+", "+_8.p$3(bD.$2)+", "+_8.p$5(bD.$3)+")";};}());
