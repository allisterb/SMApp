(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X;a=self;b=a.SMApp=a.SMApp||{};c=b.Web=b.Web||{};d=c.ClientExtensions=c.ClientExtensions||{};e=c._Html=c._Html||{};f=c.htmModule=c.htmModule||{};g=a.StartupCode$SMApp_Web$ClientExtensions=a.StartupCode$SMApp_Web$ClientExtensions||{};h=b.Bootstrap=b.Bootstrap||{};i=h.Controls=h.Controls||{};j=a.StartupCode$SMApp_Web$Bootstrap=a.StartupCode$SMApp_Web$Bootstrap||{};k=c.NLU=c.NLU||{};l=k.Intent=k.Intent||{};m=k.Trait=k.Trait||{};n=k.Meaning=k.Meaning||{};o=k.Voice=k.Voice||{};p=o["Entity'"]=o["Entity'"]||{};q=k.Text=k.Text||{};r=q["Meaning'"]=q["Meaning'"]||{};s=q.Intent=q.Intent||{};t=q.Entity=q.Entity||{};u=a.StartupCode$SMApp_Web$NLU=a.StartupCode$SMApp_Web$NLU||{};v=c.CUI=c.CUI||{};w=c.CUIModule=c.CUIModule||{};x=w.User=w.User||{};y=w.Interpreter=w.Interpreter||{};z=a.StartupCode$SMApp_Web$CUI=a.StartupCode$SMApp_Web$CUI||{};A=c.Main=c.Main||{};B=c.Client=c.Client||{};C=a.StartupCode$SMApp_Web$Client=a.StartupCode$SMApp_Web$Client||{};D=a.SMApp$Web_GeneratedPrintf=a.SMApp$Web_GeneratedPrintf||{};E=a.WebSharper;F=E&&E.Arrays;G=a.jQuery;H=E&&E.Utils;I=a.console;J=a.IntelliFactory;K=J&&J.Runtime;L=E&&E.Strings;M=E&&E.List;N=E&&E.Seq;O=E&&E.UI;P=O&&O.Doc;Q=O&&O.AttrModule;R=E&&E.Concurrency;S=E&&E.Random;T=E&&E.Remoting;U=T&&T.AjaxRemotingProvider;V=a.Wit;W=a.document;X=E&&E.Unchecked;d.toArray=function(Y){return F.map(a.id,G.makeArray(Y));};d.debug=function(Y){d.info((function(Z){return function(_0){return Z("DEBUG: "+H.toSafe(_0));};}(a.id))(Y));};d.error=function(Y){I.error(Y);};d.info=function(Y){I.info(Y);};d.jserror=function(Y){G.error(Y);};d["Terminal.EchoHtml'"]=function(Y,Z){Y.disable();Y.echo(Z,d.rawOpt());Y.enable();};d["Terminal.Echo'"]=function(Y,Z){Y.disable();Y.echo(Z);Y.enable();};d.rawOpt=function(){g.$cctor();return g.rawOpt;};e=c._Html=K.Class({toString:function(){return e.toString(this);}},null,e);e.toString=function(Y){function Z(_0){return function(_1){var _2,_3,_4,_5,_6,_7,_8;_3=L.replicate(_0," ");switch(_1.$==0?_1.$1.$==1?_1.$1.$0.$==2?_1.$1.$1.$==0?(_2=[_1.$1.$0.$0,_1.$0],1):(_2=[_1.$1,_1.$0],2):(_2=[_1.$1,_1.$0],2):(_2=[_1.$1,_1.$0],2):_1.$==2?(_2=_1.$0,3):(_2=[_1.$0,_1.$1],0)){case 0:return _2[0]+"=\""+_2[1]+"\"";case 1:_4=_2[1];return _3+"<"+_4+">"+_2[0]+"</"+_4+">\r\n";case 2:_5=_2[1];_6=M.partition(function(_9){return _9.$==1;},_2[0]);_7=_6[1];_8=_6[0];return _7.$==0?_3+"<"+_5+(_8.$===0?"":" "+L.concat(" ",M.ofSeq(N.delay(function(){return N.map(function(_9){return(Z(0))(_9);},_8);}))))+"/>\r\n":_3+"<"+_5+(_8.$===0?"":" "+L.concat(" ",M.ofSeq(N.delay(function(){return N.map(function(_9){return(Z(0))(_9);},_8);}))))+">\r\n"+L.concat("",M.ofSeq(N.delay(function(){return N.map(function(_9){return(Z(_0+1))(_9);},_7);})))+_3+"</"+_5+">\r\n";case 3:return _3+_2+"\r\n";}};}return(Z(0))(Y);};f.alt=function(Y){return new e({$:1,$0:"alt",$1:Y});};f.src=function(Y){return new e({$:1,$0:"src",$1:Y});};f.cls=function(Y){return new e({$:1,$0:"class",$1:Y});};f.str=function(Y){return e.toString(Y);};f.op_PercentEquals=function(Y,Z){return new e({$:1,$0:Y,$1:Z});};f.op_Splice=function(Y){var Z;return M.ofArray([new e({$:2,$0:(Z=Y,a.String(Z))})]);};f.strong=function(){g.$cctor();return g.strong;};f.h4=function(){g.$cctor();return g.h4;};f.h3=function(){g.$cctor();return g.h3;};f.h2=function(){g.$cctor();return g.h2;};f.h1=function(){g.$cctor();return g.h1;};f.li=function(){g.$cctor();return g.li;};f.ul=function(){g.$cctor();return g.ul;};f.th=function(){g.$cctor();return g.th;};f.td=function(){g.$cctor();return g.td;};f.tr=function(){g.$cctor();return g.tr;};f.a=function(){g.$cctor();return g.a;};f.p=function(){g.$cctor();return g.p;};f.area=function(){g.$cctor();return g.area;};f.map=function(){g.$cctor();return g.map;};f.img=function(){g.$cctor();return g.img;};f.tfoot=function(){g.$cctor();return g.tfoot;};f.tbody=function(){g.$cctor();return g.tbody;};f.thead=function(){g.$cctor();return g.thead;};f.table=function(){g.$cctor();return g.table;};f.span=function(){g.$cctor();return g.span;};f.section=function(){g.$cctor();return g.section;};f.br=function(){g.$cctor();return g.br;};f.div=function(){g.$cctor();return g.div;};f.body=function(){g.$cctor();return g.body;};f.style=function(){g.$cctor();return g.style;};f.title=function(){g.$cctor();return g.title;};f.head=function(){g.$cctor();return g.head;};f.html=function(){g.$cctor();return g.html;};f.elem=function(Y,Z){return new e({$:0,$0:Y,$1:Z});};g.$cctor=function(){var Y;g.$cctor=a.ignore;g.rawOpt=(Y={},Y.raw=true,Y);g.html=function(Z){return f.elem("html",Z);};g.head=function(Z){return f.elem("head",Z);};g.title=function(Z){return f.elem("title",Z);};g.style=function(Z){return f.elem("style",Z);};g.body=function(Z){return f.elem("body",Z);};g.div=function(Z){return f.elem("div",Z);};g.br=function(Z){return f.elem("br",Z);};g.section=function(Z){return f.elem("section",Z);};g.span=function(Z){return f.elem("span",Z);};g.table=function(Z){return f.elem("table",Z);};g.thead=function(Z){return f.elem("thead",Z);};g.tbody=function(Z){return f.elem("tbody",Z);};g.tfoot=function(Z){return f.elem("tfoot",Z);};g.img=function(Z){return f.elem("img",Z);};g.map=function(Z){return f.elem("map",Z);};g.area=function(Z){return f.elem("area",Z);};g.p=function(Z){return f.elem("p",Z);};g.a=function(Z){return f.elem("a",Z);};g.tr=function(Z){return f.elem("tr",Z);};g.td=function(Z){return f.elem("td",Z);};g.th=function(Z){return f.elem("th",Z);};g.ul=function(Z){return f.elem("ul",Z);};g.li=function(Z){return f.elem("li",Z);};g.h1=function(Z){return f.elem("h1",Z);};g.h2=function(Z){return f.elem("h1",Z);};g.h3=function(Z){return f.elem("h1",Z);};g.h4=function(Z){return f.elem("h1",Z);};g.strong=function(Z){return f.elem("strong",Z);};};i.Radio=function(Y,Z,_0,_1,_2){return P.Element("div",new M.T({$:1,$0:(i.cls())("radio"),$1:Z}),[P.Element("label",_1,[P.Radio(_2,true,_0),P.TextNode(Y)])]);};i.Checkbox=function(Y,Z,_0,_1,_2){return P.Element("div",new M.T({$:1,$0:(i.cls())("checkbox"),$1:Z}),[P.Element("label",_1,[P.CheckBox(_2,_0),P.TextNode(Y)])]);};i.TextArea=function(Y,Z,_0,_1,_2){return P.Element("div",new M.T({$:1,$0:(i.cls())("form-group"),$1:Z}),[P.Element("label",_1,[P.TextNode(Y)]),P.InputArea(new M.T({$:1,$0:(i.cls())("form-control"),$1:_2}),_0)]);};i.InputPassword=function(Y,Z,_0,_1,_2){return P.Element("div",new M.T({$:1,$0:(i.cls())("form-group"),$1:Z}),[P.Element("label",_1,[P.TextNode(Y)]),P.PasswordBox(new M.T({$:1,$0:(i.cls())("form-control"),$1:_2}),_0)]);};i.Input=function(Y,Z,_0,_1,_2){return P.Element("div",new M.T({$:1,$0:(i.cls())("form-group"),$1:Z}),[P.Element("label",_1,[P.TextNode(Y)]),P.Input(new M.T({$:1,$0:(i.cls())("form-control"),$1:_2}),_0)]);};i.Container=function(Y){return P.Element("div",[(i.cls())("container")],Y);};i.Class=function(){j.$cctor();return j.Class;};i.cls=function(){j.$cctor();return j.cls;};j.$cctor=function(){j.$cctor=a.ignore;j.cls=Q.Class;j.Class=Q.Class;};l.Program={$:3};l.Onboard={$:2};l.Help={$:1};l.Hello={$:0};m.Greetings={$:0};n=k.Meaning=K.Class({toString:function(){return((((K.Curried(function(Y,Z,_0,_1){return Y("Intent: "+D.p(Z)+". Trait: "+D.p$1(_0)+". Entities: "+D.p$3(_1));},4))(a.id))(this.get_Intent()))(this.get_Trait()))(this.get_Entities());},get_Entities:function(){return(this.Unwrap())[2];},get_Trait:function(){return(this.Unwrap())[1];},get_Intent:function(){return(this.Unwrap())[0];},Unwrap:function(){return[this.$0,this.$1,this.$2];}},null,n);p.New=function(Y,Z,_0,_1,_2){return{body:Y,end:Z,start:_0,suggested:_1,value:_2};};o.Contact=function(Y){return!(Y.contact==null)?{$:1,$0:{$:1,$0:p.New(Y.body,Y.end,Y.start,Y.ff,Y.value).value}}:null;};o.Greetings=function(Y){return!(Y.greetings==null)&&!(Y.greetings.value==null)?{$:1,$0:m.Greetings}:null;};o.Hello=function(Y){return typeof Y=="string"&&Y.toLowerCase()==="default_intent"?{$:1,$0:l.Hello}:null;};r=q["Meaning'"]=K.Class({get_TopIntent:function(){return M.head(M.sortBy(function(Y){return Y.get_Confidence();},this.get_Intents()));},get_Entities:function(){return(this.get_Unwrap())[1];},get_Intents:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1];}},null,r);s=q.Intent=K.Class({get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1];}},null,s);t=q.Entity=K.Class({get_Value:function(){return(this.get_Unwrap())[3];},get_Role:function(){return(this.get_Unwrap())[2];},get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1,this.$2,this.$3];}},null,t);q.HelloUser=function(Y){var Z,_0;return Y!=null&&Y.$==1&&(_0=q.Intent$1("Hello",Y.$0),_0!=null&&_0.$==1&&(_0.$0.$==1&&(_0.$0.$1.$==0&&(Z=_0.$0.$0,true))))?{$:1,$0:new n({$:0,$0:l.Hello,$1:null,$2:{$:1,$0:M.ofArray([{$:0,$0:Z.get_Name()}])}})}:null;};q.Hello=function(Y){var Z,_0;return Y!=null&&Y.$==1&&(_0=q.Intent$1("Hello",Y.$0),_0!=null&&_0.$==1&&_0.$0.$==0)?{$:1,$0:new n({$:0,$0:l.Hello,$1:null,$2:null})}:null;};q.Intent$1=function(Y,Z){return Z.get_TopIntent().get_Name()===Y&&Z.get_TopIntent().get_Confidence()>q.intentConfidenceThreshold()?{$:1,$0:M.filter(function(_0){return _0.get_Confidence()>q.entityConfidenceThreshold();},Z.get_Entities())}:null;};q.entityConfidenceThreshold=function(){u.$cctor();return u.entityConfidenceThreshold;};q.set_entityConfidenceThreshold=function(Y){u.$cctor();u.entityConfidenceThreshold=Y;};q.intentConfidenceThreshold=function(){u.$cctor();return u.intentConfidenceThreshold;};q.set_intentConfidenceThreshold=function(Y){u.$cctor();u.intentConfidenceThreshold=Y;};q.QuickPrograms=function(Y){return Y==="programs"?{$:1,$0:new n({$:0,$0:l.Program,$1:null,$2:null})}:null;};q.QuickHelp=function(Y){var Z;return Y==="help"||(Y==="help me"||(Y==="what's this?"||Y==="huh"))?{$:1,$0:new n({$:0,$0:l.Help,$1:null,$2:null})}:null;};q.QuickHello=function(Y){var Z;return Y==="hello"||(Y==="hey"||(Y==="yo"||Y==="hi"))?{$:1,$0:new n({$:0,$0:l.Hello,$1:null,$2:null})}:null;};q.DebugOff=function(Y){return Y==="debug off"?{$:1,$0:null}:null;};q.DebugOn=function(Y){return Y==="debug on"?{$:1,$0:null}:null;};q.Blank=function(Y){return Y===""?{$:1,$0:null}:null;};u.$cctor=function(){u.$cctor=a.ignore;u.intentConfidenceThreshold=0.85;u.entityConfidenceThreshold=0.85;};v=c.CUI=K.Class({get_StopSpeaking:function(){if(a.speechSynthesis.speaking||a.speechSynthesis.pending)a.speechSynthesis.cancel();},SayVoices:function(){var Y,Z,_0;Y=this;Z=a.speechSynthesis.getVoices();!(Z==null)?(_0=d.toArray(Z),Y.Say((function(_1){return function(_2){return _1("There are currently "+a.String(_2)+" voices installed on this computer or device.");};}(a.id))(F.length(_0))),F.iteri(function(_1,_2){return Y.Say(((((K.Curried(function(_3,_4,_5,_6){return _3("Voice "+a.String(_4)+". Name: "+H.toSafe(_5)+", Local: "+H.prettyPrint(_6)+".");},4))(a.id))(_1))(_2.name))(_2.localService));},_0)):void 0;},Wait:function(Y){this.Wait$1(function(){R.Start(Y,null);});},Wait$1:function(Y){this["Echo'"]("please wait");this.Term.disable();Y();this.Term.enable();},Say:function(Y){var Z,_0,_1;Z=this.Voice;Z!=null&&Z.$==1?(_0=Z.$0,R.Start((_1=null,R.Delay(function(){var _2;_2=new a.SpeechSynthesisUtterance(Y);_2.voice=_0;a.speechSynthesis.speak(_2);return R.Zero();})),null),this.Caption?this["Echo'"](Y):void 0):this["Echo'"](Y);},Debug:function(Y){d.debug(Y);this.DebugMode?this["EchoHtml'"](Y):void 0;},"EchoHtml'":function(Y){var Z,_0;Z=(_0={},_0.raw=true,_0);this.Term.disable();this.Term.echo(Y,Z);this.Term.enable();},"Echo'":function(Y){this.Term.disable();this.Term.echo(Y);this.Term.enable();}},null,v);v.New=function(Y,Z,_0,_1,_2){return new v({Voice:Y,Mic:Z,Term:_0,DebugMode:_1,Caption:_2});};x.New=function(Y){return{UserName:Y};};y=w.Interpreter=K.Class({get_Options:function(){return(this.get_Unwrap())[2];},get_Text:function(){return(this.get_Unwrap())[1];},get_Voice:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1[0],this.$1[1]];}},null,y);w.helloUserPhrases=function(){z.$cctor();return z.helloUserPhrases;};w.helloPhrases=function(){z.$cctor();return z.helloPhrases;};w.getRandomPhrase=function(Y){return N.nth(w.rng().Next(0,Y.get_Length()),Y);};w.rng=function(){z.$cctor();return z.rng;};z.$cctor=function(){z.$cctor=a.ignore;z.rng=new S.New();z.helloPhrases=M.ofArray(["Welcome!","Welcome, my name is Selma.","Welcome to Selma. How can I help?","Hello this is Selma, how can I help?","Hello, I am Selma. How can I help?","Hello, I am Selma. How may I help you now?"]);z.helloUserPhrases=M.ofArray(["Hi $user, welcome back.","Welcome $user, nice to see you again..","Hello $user","Good to see you $user."]);};A.update=function(Y,Z){var _0,_1;Y.Debug((function(_2){return function(_3){return _2("Main update ctx: "+H.printList(function(_4){return D.p$5(_4);},_3)+".");};}(a.id))(Z));Z.$==1?Z.$0.$0.$==3?Z.$0.$1==null?Z.$0.$2==null?Y.Wait((_0=null,R.Delay(function(){return R.Bind((new U.New()).Async("SMApp.Web:SMApp.Web.Server.GetPatients:-464888707",[]),function(_2){return _2.$==1?(Y.Debug((function(_3){return function(_4){return _3("Error "+H.toSafe(_4));};}(a.id))(_2.$0)),R.Zero()):(Y.Debug((function(_3){return function(_4){return _3("Got "+a.String(_4)+" patients.");};}(a.id))(_2.$0.get_Length())),R.Zero());});}))):void 0:void 0:Z.$0.$0.$==0?Z.$0.$1==null?(_1=Z.$0.$2,_1!=null&&_1.$==1)?Z.$0.$2.$0.$==1?Z.$0.$2.$0.$0.$==0?Z.$0.$2.$0.$1.$==0?Y.Say((function(_2){return function(_3){return _2("Hello "+H.toSafe(_3));};}(a.id))(Z.$0.$2.$0.$0.$0)):void 0:void 0:void 0:Y.Say(function(_2){return _2("Hello. My name is Selma. What's yours?");}(a.id)):void 0:void 0:void 0;};B.run=function(){var Y,Z;Y=K.ThisFunc(function(_0,_1){return((B.Main().get_Text())(_0))(_1);});Z=B.Main().get_Options();a.$("#main").terminal(Y,Z);return P.get_Empty();};B.Main=function(){C.$cctor();return C.Main;};B.container=function(){C.$cctor();return C.container;};B.wait=function(Y){d["Terminal.Echo'"](B.CUI().Term,"please wait");B.CUI().Term.disable();Y();B.CUI().Term.enable();};B.stopSpeaking=function(){C.$cctor();return C.stopSpeaking;};B.sayRandom=function(Y){B.say(w.getRandomPhrase(Y));};B.sayVoices=function(){var Y,Z;Y=a.speechSynthesis.getVoices();!(Y==null)?(Z=d.toArray(Y),B.say((function(_0){return function(_1){return _0("There are currently "+a.String(_1)+" voices installed on this computer or device.");};}(a.id))(F.length(Z))),F.iteri(function(_0,_1){return B.say(((((K.Curried(function(_2,_3,_4,_5){return _2("Voice "+a.String(_3)+". Name: "+H.toSafe(_4)+", Local: "+H.prettyPrint(_5)+".");},4))(a.id))(_0))(_1.name))(_1.localService));},Z)):void 0;};B.say=function(Y){var Z,_0,_1;Z=B.CUI().Voice;Z!=null&&Z.$==1?(_0=Z.$0,R.Start((_1=null,R.Delay(function(){var _2;_2=new a.SpeechSynthesisUtterance(Y);_2.voice=_0;a.speechSynthesis.speak(_2);return R.Zero();})),null),B.CUI().Caption?d["Terminal.Echo'"](B.CUI().Term,Y):void 0):d["Terminal.Echo'"](B.CUI().Term,Y);};B.initMic=function(Y,Z){var _0,_1;B.set_CUI((_0={$:1,$0:new V.Microphone(W.getElementById("microphone"))},v.New(B.CUI().Voice,_0,B.CUI().Term,B.CUI().DebugMode,B.CUI().Caption)));_1=B.CUI().Mic.$0;_1.onconnecting=function(){B.set_MicState({$:1});return B.debugEcho("Mic connecting...");};_1.ondisconnected=function(){B.set_MicState({$:2});return B.debugEcho("Mic disconnected.");};_1.onaudiostart=function(){B.set_MicState({$:3});return B.debugEcho("Mic audio start...");};_1.onaudioend=function(){B.set_MicState({$:4});return B.debugEcho("Mic audio end.");};_1.onerror=function(_2){B.set_MicState({$:6,$0:_2});return B.debugEcho((function(_3){return function(_4){return _3("Mic error : "+H.toSafe(_4)+".");};}(a.id))(_2));};_1.onready=function(){B.set_MicState({$:5});return B.debugEcho("Mic ready.");};_1.onresult=function(_2,_3){B.set_MicState({$:7,$0:_2,$1:_3});return Y(_1,[_2,_3]);};_1.connect("4Y2BLQY5TWLIN7HFIV264S53MY4PCUAT");};B.initSpeech=function(){var Y,Z;Y=a.speechSynthesis.getVoices();!(Y==null)?(Z=d.toArray(Y),F.iter(function(_0){if(X.Equals(B.CUI().Voice,null)&&(_0.name.indexOf("Microsoft Zira")!=-1||_0.name.toLowerCase().indexOf("female")!=-1)){B.set_CUI(v.New({$:1,$0:_0},B.CUI().Mic,B.CUI().Term,B.CUI().DebugMode,B.CUI().Caption));d.debug((function(_1){return function(_2){return _1("Using voice "+H.toSafe(_2)+".");};}(a.id))(B.CUI().Voice.$0.name));}},Z),X.Equals(B.CUI().Voice,null)&&F.length(Z)>0?(B.set_CUI(v.New({$:1,$0:F.find(function(_0){return _0["default"];},Z)},B.CUI().Mic,B.CUI().Term,B.CUI().DebugMode,B.CUI().Caption)),d.debug((function(_0){return function(_1){return _0("Using default voice "+H.toSafe(_1)+".");};}(a.id))(B.CUI().Voice.$0.name))):void 0):void 0;X.Equals(B.CUI().Voice,null)?(d.error("No speech synthesis voice is available."),d["Terminal.Echo'"](B.CUI().Term,"No speech synthesis voice is available. Install speech synthesis on this device or computer to use the voice output feature of Selma.")):void 0;};B.updateCtx=function(Y){var Z;Z=B.Context();Z.splice.apply(Z,[0,0,Y]);return M.ofSeq(N.take(F.length(B.Context())>=5?5:F.length(B.Context()),B.Context()));};B.Context=function(){C.$cctor();return C.Context;};B.MicState=function(){C.$cctor();return C.MicState;};B.set_MicState=function(Y){C.$cctor();C.MicState=Y;};B.debugEcho=function(Y){if(B.CUI().DebugMode)d["Terminal.EchoHtml'"](B.CUI().Term,Y);};B.echo=function(){C.$cctor();return C.echo;};B.CUI=function(){C.$cctor();return C.CUI;};B.set_CUI=function(Y){C.$cctor();C.CUI=Y;};C.$cctor=function(){var Y,Z;C.$cctor=a.ignore;function _0(_2,_3){var _4,_5;_4=_3[1];d.info(_3[0]);d.info(_4);_5=o.Greetings(_4);return _5!=null&&_5.$==1?d.info(_5.$0):d.error(_4);}function _1(_2,_3){var _4,_5,_6,_7,_8,_9,_,$,ba;B.set_CUI(v.New(B.CUI().Voice,B.CUI().Mic,_2,B.CUI().DebugMode,B.CUI().Caption));X.Equals(B.CUI().Voice,null)?B.initSpeech():void 0;X.Equals(B.CUI().Mic,null)?B.initMic(_0,_2):void 0;return(_4=q.Blank(_3),_4!=null&&_4.$==1)?B.say("Tell me what you want me to do or ask me a question."):(_5=q.DebugOn(_3),_5!=null&&_5.$==1)?(B.set_CUI(v.New(B.CUI().Voice,B.CUI().Mic,B.CUI().Term,true,B.CUI().Caption)),B.say("Debug mode is now on.")):(_6=q.DebugOff(_3),_6!=null&&_6.$==1)?(B.set_CUI(v.New(B.CUI().Voice,B.CUI().Mic,B.CUI().Term,false,B.CUI().Caption)),B.say("Debug mode is now off.")):(_8=q.QuickHello(_3),_8!=null&&_8.$==1?(_7=_8.$0,true):(_9=q.QuickHelp(_3),_9!=null&&_9.$==1?(_7=_9.$0,true):(_=q.QuickPrograms(_3),_!=null&&_.$==1&&(_7=_.$0,true))))?($=B.updateCtx(_7),A.update(B.CUI(),$)):B.CUI().Wait((ba=null,R.Delay(function(){return R.Bind((new U.New()).Async("SMApp.Web:SMApp.Web.Server.GetMeaning:1209023047",[_3]),function(bb){var bc,bd;bc=q.HelloUser(bb);return bc!=null&&bc.$==1?(bd=B.updateCtx(bc.$0),A.update(B.CUI(),bd),R.Zero()):(d["Terminal.Echo'"](_2,"Sorry I did not understand what you said."),R.Zero());});})));}C.CUI=v.New(null,null,null,false,false);C.echo=(Y=B.CUI().Term,function(_2){d["Terminal.EchoHtml'"](Y,_2);});C.MicState={$:0};C.Context=[];C.stopSpeaking=a.speechSynthesis.speaking||a.speechSynthesis.pending?a.speechSynthesis.cancel():null;C.container=i.Container;C.Main=new y({$:0,$0:function(_2){return function(_3){return _0(_2,_3);};},$1:[function(_2){return function(_3){return _1(_2,_3);};},(Z={},Z.name="Main",Z.greetings="Welcome to Selma. Type hello to begin or help for more assistance.",Z.prompt=">",Z)]});};D.p$3=function(Y){return Y==null?"null":"Some "+H.printList(function(Z){return D.p$4(Z);},Y.$0);};D.p$4=function(Y){return Y.$==1?"Contact "+H.prettyPrint(Y.$0):"User "+H.prettyPrint(Y.$0);};D.p$1=function(Y){return Y==null?"null":"Some "+D.p$2(Y.$0);};D.p$2=function(Y){return"Greetings";};D.p=function(Y){return Y.$==3?"Program":Y.$==2?"Onboard":Y.$==1?"Help":"Hello";};D.p$5=function(Y){return"Meaning ("+D.p(Y.$0)+", "+D.p$1(Y.$1)+", "+D.p$3(Y.$2)+")";};}());
