(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;a=self;b=a.SMApp=a.SMApp||{};c=b.Web=b.Web||{};d=c.User=c.User||{};e=c.Meaning=c.Meaning||{};f=c.Intent=c.Intent||{};g=c.Entity=c.Entity||{};h=c.Interpreter=c.Interpreter||{};i=c.CUIContext=c.CUIContext||{};j=c.Resource=c.Resource||{};k=c.NLU=c.NLU||{};l=a.StartupCode$SMApp_Web$NLU=a.StartupCode$SMApp_Web$NLU||{};m=c.CUI=c.CUI||{};n=a.StartupCode$SMApp_Web$CUI=a.StartupCode$SMApp_Web$CUI||{};o=c.ClientExtensions=c.ClientExtensions||{};p=c.Client=c.Client||{};q=a.StartupCode$SMApp_Web$Client=a.StartupCode$SMApp_Web$Client||{};r=a.IntelliFactory;s=r&&r.Runtime;t=a.WebSharper;u=t&&t.List;v=t&&t.UI;w=v&&v.Doc;x=t&&t.Concurrency;y=t&&t.Utils;z=t&&t.Remoting;A=z&&z.AjaxRemotingProvider;d.New=function(B){return{UserName:B};};e=c.Meaning=s.Class({get_TopIntent:function(){return u.head(u.sortBy(function(B){return B.get_Confidence();},this.get_Intents()));},get_Entities:function(){return(this.get_Unwrap())[1];},get_Intents:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1];}},null,e);f=c.Intent=s.Class({get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1];}},null,f);g=c.Entity=s.Class({get_Value:function(){return(this.get_Unwrap())[3];},get_Role:function(){return(this.get_Unwrap())[2];},get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1,this.$2,this.$3];}},null,g);h=c.Interpreter=s.Class({get_Options:function(){return(this.get_Unwrap())[1];},get_Func:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0[0],this.$0[1]];}},null,h);i.InputCtx={$:2};i.MenuCtx={$:1};j.New=function(B,C,D){return{Name:B,Description:C,Url:D};};k.HelloUser=function(B){var C,D;return(D=k.Hello(B),D!=null&&D.$==1&&(D.$0.$==1&&(D.$0.$1.$==0&&(D.$0.$0.get_Role()==="contact"&&(C=D.$0.$0,true)))))?{$:1,$0:C}:null;};k.Hello=function(B){var C,D;return B!=null&&B.$==1&&(D=k.Intent("Hello",B.$0),D!=null&&D.$==1&&(C=D.$0,true))?{$:1,$0:C}:null;};k.Help=function(B){return B==="help"?{$:0,$0:null}:B==="debug on"?{$:1,$0:null}:B==="debug off"?{$:2,$0:null}:{$:3,$0:null};};k.Intent=function(B,C){return C.get_TopIntent().get_Name()===B&&C.get_TopIntent().get_Confidence()>k.intentConfidenceThreshold()?{$:1,$0:u.filter(function(D){return D.get_Confidence()>k.entityConfidenceThreshold();},C.get_Entities())}:null;};k.entityConfidenceThreshold=function(){l.$cctor();return l.entityConfidenceThreshold;};k.set_entityConfidenceThreshold=function(B){l.$cctor();l.entityConfidenceThreshold=B;};k.intentConfidenceThreshold=function(){l.$cctor();return l.intentConfidenceThreshold;};k.set_intentConfidenceThreshold=function(B){l.$cctor();l.intentConfidenceThreshold=B;};l.$cctor=function(){l.$cctor=a.ignore;l.intentConfidenceThreshold=0.8;l.entityConfidenceThreshold=0.8;};m.helloUserPhrases=function(){n.$cctor();return n.helloUserPhrases;};m.helloPhrases=function(){n.$cctor();return n.helloPhrases;};n.$cctor=function(){n.$cctor=a.ignore;n.helloPhrases=u.ofArray(["Welcome","Welcome to Selma","Hi I'm Selma, how can I help?","Hello I'm Selma, how can I help?"]);n.helloUserPhrases=u.ofArray(["Welcome $user, nice to see you again..","Welcome to Selma","Hi I'm Selma, how can I help?","Hello I'm Selma, how can I help?"]);};o["Terminal.Push"]=function(B,C){var D,E;D=C.get_Func();E=C.get_Options();B.push(s.CreateFuncWithThis(D),E);};o["Terminal.Echo'"]=function(B,C){B.disable();B.echo(C);B.enable();};p.Term=function(){var B,C;B=s.ThisFunc(function(D,E){return((p.Main().get_Func())(D))(E);});C=p.Main().get_Options();a.$("#main").terminal(B,C);return w.get_Empty();};p.Main=function(){q.$cctor();return q.Main;};p.speak=function(B){var C;x.Start((C=null,x.Delay(function(){a.speechSynthesis.speak(new a.SpeechSynthesisUtterance(B));return x.Zero();})),null);};p.transcribe=function(){q.$cctor();return q.transcribe;};p.set_transcribe=function(B){q.$cctor();q.transcribe=B;};p.debugMode=function(){q.$cctor();return q.debugMode;};p.set_debugMode=function(B){q.$cctor();q.debugMode=B;};q.$cctor=function(){var B;q.$cctor=a.ignore;function C(D,E){var F,G;F=k.Help(E);return F.$==1?(p.set_debugMode(true),o["Terminal.Echo'"](D,(function(H){return function(I){return H("Debug mode is now "+y.prettyPrint(I)+".");};}(a.id))(p.debugMode()))):F.$==2?(p.set_debugMode(false),o["Terminal.Echo'"](D,(function(H){return function(I){return H("Debug mode is now "+y.prettyPrint(I)+".");};}(a.id))(p.debugMode()))):F.$==3?(D.disable(),x.Start((G=null,x.Delay(function(){return x.Combine(x.Bind((new A.New()).Async("SMApp.Web:SMApp.Web.Server.GetMeaning:394434405",[E]),function(H){var I,J;I=k.HelloUser(H);return I!=null&&I.$==1?(D.echo((function(K){return function(L){return K("This is the hello intent. The user name is "+y.toSafe(L)+".");};}(a.id))(I.$0.get_Value())),x.Zero()):(J=k.Hello(H),J!=null&&J.$==1)?(D.echo("This is the hello intent but I don't know who the user is."),x.Zero()):(D.echo("This is the whatever intent"),x.Zero());}),x.Delay(function(){D.enable();return x.Zero();}));})),null)):o["Terminal.Echo'"](D,"This is the help commnd");}q.debugMode=false;q.transcribe=false;q.Main=new h({$:0,$0:[function(D){return function(E){return C(D,E);};},(B={},B.name="Main",B.greetings="Welcome to Selma",B.prompt=">",B)]});};}());
