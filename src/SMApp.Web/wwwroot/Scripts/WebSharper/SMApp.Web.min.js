(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG;a=self;b=a.SMApp=a.SMApp||{};c=b.Web=b.Web||{};d=c.ClientExtensions=c.ClientExtensions||{};e=c._Html=c._Html||{};f=c.htmModule=c.htmModule||{};g=a.StartupCode$SMApp_Web$ClientExtensions=a.StartupCode$SMApp_Web$ClientExtensions||{};h=c.TypingDNA=c.TypingDNA||{};i=h.SaveResponse=h.SaveResponse||{};j=h.UserResponse=h.UserResponse||{};k=h.VerifyResponse=h.VerifyResponse||{};l=c.Bs=c.Bs||{};m=b.NLU=b.NLU||{};n=m.Babelfy=m.Babelfy||{};o=n.ApiResponse=n.ApiResponse||{};p=n.TokenFragment=n.TokenFragment||{};q=n.CharFragment=n.CharFragment||{};r=m.Witai=m.Witai||{};s=r.Utterance=r.Utterance||{};t=r.Intent=r.Intent||{};u=r.Entity=r.Entity||{};v=r.Trait=r.Trait||{};w=r["Utterance'"]=r["Utterance'"]||{};x=r["Value'"]=r["Value'"]||{};y=m.QnAMaker=m.QnAMaker||{};z=y.ITSQuestion=y.ITSQuestion||{};A=y.ITSAnswerContext=y.ITSAnswerContext||{};B=y.ITSAnswer=y.ITSAnswer||{};C=y.ITSAnswers=y.ITSAnswers||{};D=c.NLG=c.NLG||{};E=a.StartupCode$SMApp_Web$NLG=a.StartupCode$SMApp_Web$NLG||{};F=c.NLU=c.NLU||{};G=F.Intent=F.Intent||{};H=F.Trait=F.Trait||{};I=F.Entity=F.Entity||{};J=F.Utterance=F.Utterance||{};K=F.Voice=F.Voice||{};L=K["Entity'"]=K["Entity'"]||{};M=F.Text=F.Text||{};N=M["Utterance'"]=M["Utterance'"]||{};O=M["Intent'"]=M["Intent'"]||{};P=M["Entity'"]=M["Entity'"]||{};Q=M["Trait'"]=M["Trait'"]||{};R=F.Domain=F.Domain||{};S=a.StartupCode$SMApp_Web$NLU=a.StartupCode$SMApp_Web$NLU||{};T=c.CUI=c.CUI||{};U=T.MicState=T.MicState||{};V=T.ClientState=T.ClientState||{};W=T.Interpreter=T.Interpreter||{};X=T.CUI=T.CUI||{};Y=c.Dialogue=c.Dialogue||{};Z=c.Question=c.Question||{};_0=c.QuestionType=c.QuestionType||{};_1=c.DialogueModule=c.DialogueModule||{};_2=c.User=c.User||{};_3=a.StartupCode$SMApp_Web$User=a.StartupCode$SMApp_Web$User||{};_4=c.Symptoms=c.Symptoms||{};_5=a.StartupCode$SMApp_Web$Symptoms=a.StartupCode$SMApp_Web$Symptoms||{};_6=c.Main=c.Main||{};_7=a.StartupCode$SMApp_Web$Main=a.StartupCode$SMApp_Web$Main||{};_8=c.Client=c.Client||{};_9=a.StartupCode$SMApp_Web$Client=a.StartupCode$SMApp_Web$Client||{};_=a.SMApp$Web_GeneratedPrintf=a.SMApp$Web_GeneratedPrintf||{};$=a.GeneratedPrintf=a.GeneratedPrintf||{};ba=a.IntelliFactory;bb=ba&&ba.Runtime;bc=a.WebSharper;bd=bc&&bc.Arrays;be=bc&&bc.UI;bf=be&&be.Doc;bg=be&&be.AttrProxy;bh=be&&be.Client;bi=bh&&bh.Templates;bj=bc&&bc.Utils;bk=a.console;bl=a.jQuery;bm=bc&&bc.Strings;bn=bc&&bc.List;bo=bc&&bc.Seq;bp=be&&be.AttrModule;bq=bc&&bc.Concurrency;br=a.JSON;bs=bc&&bc.Random;bt=bc&&bc.Collections;bu=bt&&bt.Map;bv=bc&&bc.JavaScript;bw=bv&&bv.Pervasives;bx=bc&&bc.ClientSideJson;by=bx&&bx.Provider;bz=a.SDK;bA=bc&&bc.Unchecked;bB=bc&&bc.Operators;bC=bc&&bc.Remoting;bD=bC&&bC.AjaxRemotingProvider;bE=a.Wit;bF=a.document;bG=bt&&bt.Dictionary;d.getCameraCanvas=function(){return a.getCameraCanvas();};d.stopCamera=function(){return a.stopCamera();};d.startCamera=function(bH,bI){return a.startCamera(bH,bI);};d.speechSynthesis=function(){return a.speechSynthesis;};d.lastMicData=function(){return a.lastMicData;};d.questionBox=function(bH,bI,bJ,bK,bL,bM,bN,bO){var bP,bQ,bR,bS;bP=(bQ=(bR={},bR.titleText=bH,bR.text=bI,bR.type="question",bR.width=a.String(bJ),bR.html=(((bb.Curried3(function(bT,bU,bV){return bT("<div style=\"width:"+a.String(bU)+"px;height:"+a.String(bV)+"px\"></div>");}))(a.id))(bJ))(bK),bR.input="text",bR.showCancelButton=true,bR.allowOutsideClick=false,bR.confirmButtonText="Ok",bR),(bL!=null?bL.$0(bQ):void 0,bS=a.Sweetalert2(bQ),bS));bM!=null?bM.$0():void 0;bP.then(bN,bO);};d.getDialogueBoxInput=function(){return bd.get(a.jQuery(".swal2-input").get(),0);};d.getDialogueBoxCanvas=function(){return bd.get(a.jQuery("canvas.swal2-content").get(),0);};d.createDialogueBoxCanvas=function(){return d.createCanvas("camera","640","480",bd.get(a.jQuery(".swal2-content").get(),0).firstChild);};d.createCanvas=function(bH,bI,bJ,bK){var bL;bL=bf.Element("canvas",[d.eid(bH),bg.Create("width",bI),bg.Create("height",bJ)],[]);bi.LoadLocalTemplates("");bf.Run(bK,bL);return bK.firstChild;};d.elementHTML=function(bH){return bH.innerHTML;};d.createElement=function(bH){var bI;bI=self.document.createElement("div");self.document.appendChild(bI);bi.LoadLocalTemplates("");bf.RunAppend(bI,bH);};d.container=function(bH){return bf.Element("div",[d.cls("container")],bH);};d.dindex=function(bH){return bg.Create("data-index",a.String(bH));};d.cls=function(bH){return bg.Create("class",bH);};d.eid=function(bH){return bg.Create("id",bH);};d.termOutput=function(){return bd.get(a.jQuery(".terminal-output").get(),0);};d.toLower=function(bH){return bH.toLowerCase();};d.debug=function(bH,bI){d.info((((bb.Curried3(function(bJ,bK,bL){return bJ("DEBUG: "+bj.toSafe(bK)+": "+bj.prettyPrint(bL));}))(a.id))(bH.toUpperCase()))(bI));};d.error=function(bH){bk.error(bH);};d.info=function(bH){bk.info(bH);};d.jserror=function(bH){bl.error(bH);};d.toArray=function(bH){return bd.map(a.id,bl.makeArray(bH));};d["Terminal.EchoHtml'"]=function(bH,bI){bH.pause();bH.echo(bI,d.rawOpt());bH.resume();};d["Terminal.Echo'"]=function(bH,bI){bH.pause();bH.echo(bI);bH.resume();};d.rawOpt=function(){g.$cctor();return g.rawOpt;};e=c._Html=bb.Class({toString:function(){return e.toString(this);}},null,e);e.toString=function(bH){function bI(bJ){return function(bK){var bL,bM,bN,bO,bP,bQ,bR;bM=bm.replicate(bJ," ");switch(bK.$==0?bK.$1.$==1?bK.$1.$0.$==2?bK.$1.$1.$==0?(bL=[bK.$1.$0.$0,bK.$0],1):(bL=[bK.$1,bK.$0],2):(bL=[bK.$1,bK.$0],2):(bL=[bK.$1,bK.$0],2):bK.$==2?(bL=bK.$0,3):(bL=[bK.$0,bK.$1],0)){case 0:return bL[0]+"=\""+bL[1]+"\"";case 1:bN=bL[1];return bM+"<"+bN+">"+bL[0]+"</"+bN+">\r\n";case 2:bO=bL[1];bP=bn.partition(function(bS){return bS.$==1;},bL[0]);bQ=bP[1];bR=bP[0];return bQ.$==0?bM+"<"+bO+(bR.$===0?"":" "+bm.concat(" ",bn.ofSeq(bo.delay(function(){return bo.map(function(bS){return(bI(0))(bS);},bR);}))))+"/>\r\n":bM+"<"+bO+(bR.$===0?"":" "+bm.concat(" ",bn.ofSeq(bo.delay(function(){return bo.map(function(bS){return(bI(0))(bS);},bR);}))))+">\r\n"+bm.concat("",bn.ofSeq(bo.delay(function(){return bo.map(function(bS){return(bI(bJ+1))(bS);},bQ);})))+bM+"</"+bO+">\r\n";case 3:return bM+bL+"\r\n";}};}return(bI(0))(bH);};f.alt=function(bH){return new e({$:1,$0:"alt",$1:bH});};f.src=function(bH){return new e({$:1,$0:"src",$1:bH});};f.cls=function(bH){return new e({$:1,$0:"class",$1:bH});};f.str=function(bH){return e.toString(bH);};f.op_PercentEquals=function(bH,bI){return new e({$:1,$0:bH,$1:bI});};f.op_Splice=function(bH){var bI;return bn.ofArray([new e({$:2,$0:(bI=bH,a.String(bI))})]);};f.strong=function(){g.$cctor();return g.strong;};f.h4=function(){g.$cctor();return g.h4;};f.h3=function(){g.$cctor();return g.h3;};f.h2=function(){g.$cctor();return g.h2;};f.h1=function(){g.$cctor();return g.h1;};f.li=function(){g.$cctor();return g.li;};f.ul=function(){g.$cctor();return g.ul;};f.th=function(){g.$cctor();return g.th;};f.td=function(){g.$cctor();return g.td;};f.tr=function(){g.$cctor();return g.tr;};f.a=function(){g.$cctor();return g.a;};f.p=function(){g.$cctor();return g.p;};f.area=function(){g.$cctor();return g.area;};f.map=function(){g.$cctor();return g.map;};f.img=function(){g.$cctor();return g.img;};f.tfoot=function(){g.$cctor();return g.tfoot;};f.tbody=function(){g.$cctor();return g.tbody;};f.thead=function(){g.$cctor();return g.thead;};f.table=function(){g.$cctor();return g.table;};f.span=function(){g.$cctor();return g.span;};f.section=function(){g.$cctor();return g.section;};f.br=function(){g.$cctor();return g.br;};f.div=function(){g.$cctor();return g.div;};f.body=function(){g.$cctor();return g.body;};f.style=function(){g.$cctor();return g.style;};f.title=function(){g.$cctor();return g.title;};f.head=function(){g.$cctor();return g.head;};f.html=function(){g.$cctor();return g.html;};f.elem=function(bH,bI){return new e({$:0,$0:bH,$1:bI});};g.$cctor=function(){var bH;g.$cctor=a.ignore;g.rawOpt=(bH={},bH.raw=true,bH);g.html=function(bI){return f.elem("html",bI);};g.head=function(bI){return f.elem("head",bI);};g.title=function(bI){return f.elem("title",bI);};g.style=function(bI){return f.elem("style",bI);};g.body=function(bI){return f.elem("body",bI);};g.div=function(bI){return f.elem("div",bI);};g.br=function(bI){return f.elem("br",bI);};g.section=function(bI){return f.elem("section",bI);};g.span=function(bI){return f.elem("span",bI);};g.table=function(bI){return f.elem("table",bI);};g.thead=function(bI){return f.elem("thead",bI);};g.tbody=function(bI){return f.elem("tbody",bI);};g.tfoot=function(bI){return f.elem("tfoot",bI);};g.img=function(bI){return f.elem("img",bI);};g.map=function(bI){return f.elem("map",bI);};g.area=function(bI){return f.elem("area",bI);};g.p=function(bI){return f.elem("p",bI);};g.a=function(bI){return f.elem("a",bI);};g.tr=function(bI){return f.elem("tr",bI);};g.td=function(bI){return f.elem("td",bI);};g.th=function(bI){return f.elem("th",bI);};g.ul=function(bI){return f.elem("ul",bI);};g.li=function(bI){return f.elem("li",bI);};g.h1=function(bI){return f.elem("h1",bI);};g.h2=function(bI){return f.elem("h1",bI);};g.h3=function(bI){return f.elem("h1",bI);};g.h4=function(bI){return f.elem("h1",bI);};g.strong=function(bI){return f.elem("strong",bI);};};i.New=function(bH,bI,bJ,bK){return{name:bH,message:bI,message_code:bJ,status:bK};};j.New=function(bH,bI,bJ,bK,bL){return{message:bH,message_code:bI,success:bJ,count:bK,status:bL};};k.New=function(bH,bI,bJ,bK,bL,bM){return{message:bH,message_code:bI,success:bJ,result:bK,score:bL,confidence:bM};};h.getSameTextTypingPattern=function(bH,bI){var bJ;return bI.getTypingPattern((bJ={type:1},bJ.text=bH,bJ.caseSensitive=true,bJ));};l.Radio=function(bH,bI,bJ,bK,bL){return bf.Element("div",new bn.T({$:1,$0:d.cls("radio"),$1:bI}),[bf.Element("label",bK,[bf.Radio(bL,true,bJ),bf.TextNode(bH)])]);};l.checkbox=function(bH,bI,bJ,bK,bL){return bf.Element("div",new bn.T({$:1,$0:d.cls("checkbox"),$1:bI}),[bf.Element("label",bK,[bf.CheckBox(bL,bJ),bf.TextNode(bH)])]);};l.textArea=function(bH,bI,bJ,bK,bL){return bf.Element("div",new bn.T({$:1,$0:d.cls("form-group"),$1:bI}),[bf.Element("label",bK,[bf.TextNode(bH)]),bf.InputArea(new bn.T({$:1,$0:d.cls("form-control"),$1:bL}),bJ)]);};l.inputPassword=function(bH,bI,bJ,bK,bL){return bf.Element("div",new bn.T({$:1,$0:d.cls("form-group"),$1:bI}),[bf.Element("label",bK,[bf.TextNode(bH)]),bf.PasswordBox(new bn.T({$:1,$0:d.cls("form-control"),$1:bL}),bJ)]);};l.input=function(bH,bI,bJ,bK,bL){return bf.Element("div",new bn.T({$:1,$0:d.cls("form-group"),$1:bI}),[bf.Element("label",bK,[bf.TextNode(bH)]),bf.Input([d.cls("form-control"),bL],bJ)]);};l.btnSecondary=function(bH,bI,bJ){return bf.Element("button",[d.eid(bH),d.cls("btn btn-secondary"),bp.Handler("click",bJ)],[bf.TextNode(bI)]);};l.btnPrimary=function(bH,bI,bJ){return bf.Element("button",[d.eid(bH),d.cls("btn btn-primary"),bp.Handler("click",bJ)],[bf.TextNode(bI)]);};o.New=function(bH,bI,bJ,bK,bL,bM,bN,bO,bP){return{tokenFragment:bH,charFragment:bI,babelSynsetID:bJ,DBpediaURL:bK,BabelNetURL:bL,score:bM,cohrenceScore:bN,globalScore:bO,source:bP};};p.New=function(bH,bI){return{start:bH,end:bI};};q.New=function(bH,bI){return{start:bH,end:bI};};n.disambiguate=function(bH){function bI(bJ,bK){var bL;bl.ajax((bL={},bL.url=(function(bM){return function(bN){return bM("https://babelfy.io/v1/disambiguate?text="+bj.toSafe(bN)+"&lang=EN&extAIDA=true&key=983fc0ec-a6fa-49ef-bd02-203c18aef272");};}(a.id))(bH),bL.type="GET",bL.success=function(bM){return bJ(bM);},bL.error=function(bM){return bK(new a.Error(bM.responseText));},bL));}return bq.FromContinuations(function(bJ,bK,bL){return bI.apply(null,[bJ,bK,bL]);});};s.New=function(bH,bI,bJ,bK){return{text:bH,intents:bI,entities:bJ,traits:bK};};t.New=function(bH,bI,bJ){return{id:bH,name:bI,confidence:bJ};};u.New=function(bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR){return{id:bH,name:bI,role:bJ,start:bK,end:bL,body:bM,confidence:bN,entities:bO,suggested:bP,value:bQ,type:bR};};v.New=function(bH,bI,bJ){return{id:bH,value:bI,confidence:bJ};};w.New=function(bH){return{intent:bH};};x.New=function(bH){return{value:bH};};r.getMeaning2=function(bH,bI){function bJ(bK,bL){var bM;bl.ajax((bM={},bM.url=(function(bN){return function(bO){return bN("https://api.wit.ai/message?q="+bj.toSafe(bO));};}(a.id))(bI),bM.type="GET",bM.beforeSend=function(bN){return bN.setRequestHeader("Authorization","Bearer "+bH);},bM.success=function(bN){return bK(bN);},bM.error=function(bN){return bL(new a.Error(bN.responseText));},bM));}return bq.FromContinuations(function(bK,bL,bM){return bJ.apply(null,[bK,bL,bM]);});};r.getMeaning=function(bH,bI,bJ,bK){var bL;bl.ajax((bL={},bL.url=(function(bM){return function(bN){return bM("https://api.wit.ai/message?q="+bj.toSafe(bN));};}(a.id))(bI),bL.type="GET",bL.beforeSend=function(bM){return bM.setRequestHeader("Authorization","Bearer "+bH);},bL.success=bJ,bL.error=bK,bL));};z.New=function(bH){return{question:bH};};A.New=function(bH,bI){return{isContextOnly:bH,prompts:bI};};B.New=function(bH,bI,bJ,bK,bL,bM,bN){return{questions:bH,answer:bI,score:bJ,id:bK,source:bL,metadata:bM,context:bN};};C.New=function(bH){return{answers:bH};};y.getAnswer=function(bH){function bI(bJ,bK){var bL;bl.ajax((bL={},bL.url="https://lerna.azurewebsites.net/qnamaker/knowledgebases/13a6a026-942b-4612-a8cb-654086ec76ee/generateAnswer",bL.type="POST",bL.beforeSend=function(bM){return bM.setRequestHeader("Authorization","EndpointKey e5a55563-b1b0-4343-8796-bda5a0509385");},bL.contentType="application/json",bL.dataType="json",bL.data=br.stringify(z.New(bH)),bL.success=function(bM){return bJ(bM);},bL.error=function(bM){return bK(new a.Error(bM.responseText));},bL));}return bq.FromContinuations(function(bJ,bK,bL){return bI.apply(null,[bJ,bK,bL]);});};D.waitAddPhrases=function(){E.$cctor();return E.waitAddPhrases;};D.waitRetrievePhrases=function(){E.$cctor();return E.waitRetrievePhrases;};D.helpPhrases=function(){E.$cctor();return E.helpPhrases;};D.helloUserPhrases=function(){E.$cctor();return E.helloUserPhrases;};D.helloPhrases=function(){E.$cctor();return E.helloPhrases;};D["getRandomPhrase'"]=function(bH){return D.replace_tok("$0","",bo.nth(D.rng().Next(0,bH.get_Length()),bH));};D.getRandomPhrase=function(bH,bI){return D.replace_tok("$0",bI,bo.nth(D.rng().Next(0,bH.get_Length()),bH));};D.replace_tok=function(bH,bI,bJ){return bm.Replace(bJ,bH,bI);};D.rng=function(){E.$cctor();return E.rng;};E.$cctor=function(){E.$cctor=a.ignore;E.rng=new bs.New();E.helloPhrases=bn.ofArray(["Welcome!","Welcome, my name is Selma.","Welcome to Selma. How can I help?","Hello this is Selma, how can I help?","Hello, I am Selma. How can I help?","Hello, I am Selma. How may I help you now?","I'm Selma. Tell me your name so we can get started."]);E.helloUserPhrases=bn.ofArray(["Hello $0, welcome back.","Welcome $0, nice to see you again.","Hello $0.","Good to see you $0.","Hello $0, nice to see you."]);E.helpPhrases=bn.ofArray(["What can I help you with $0?"]);E.waitRetrievePhrases=bn.ofArray(["Ok, let me check that $0 for you","Please wait while I check that $0 for you.","Wait while I check that $0.","Ok let me see if I can find that $0."]);E.waitAddPhrases=bn.ofArray(["Ok, let me add that $0 for you","Please wait while I add that $0 for you.","Wait while I add that $0.","I'll add that $0 now."]);};G=F.Intent=bb.Class({toString:function(){return(((bb.Curried3(function(bH,bI,bJ){return bH("Intent("+bj.toSafe(bI)+", "+_.p$2(bJ)+")");}))(a.id))(this.get_Name()))(this.get_Confidence());},get_Confidence:function(){return this.$1;},get_Name:function(){return this.$0;}},null,G);H=F.Trait=bb.Class({toString:function(){return(((bb.Curried3(function(bH,bI,bJ){return bH("Trait("+bj.toSafe(bI)+", "+bj.prettyPrint(bJ)+")");}))(a.id))(this.get_Name()))(this.get_Value());},get_Confidence:function(){return this.$2;},get_Value:function(){return this.$1;},get_Name:function(){return this.$0;}},null,H);I=F.Entity=bb.Class({toString:function(){return(((((bb.Curried(function(bH,bI,bJ,bK,bL){return bH("Entity("+bj.toSafe(bI)+", "+bj.toSafe(bJ)+", "+bj.toSafe(bK)+", "+_.p$2(bL)+")");},5))(a.id))(this.get_Name()))(this.get_Role()))(this.get_Value()))(this.get_Confidence());},get_Confidence:function(){return this.$3;},get_Value:function(){return this.$2;},get_Role:function(){return this.$1;},get_Name:function(){return this.$0;}},null,I);J=F.Utterance=bb.Class({toString:function(){return((((bb.Curried(function(bH,bI,bJ,bK){return bH(_.p(bI)+" "+_.p$3(bJ)+" "+_.p$5(bK));},4))(a.id))(this.get_Intent()))(this.get_Traits()))(this.get_Entities());},get_Entities:function(){var bH;bH=this.$3;return bH!=null?{$:1,$0:bn.sortBy(function(bI){return bI.get_Name();},bH.$0)}:null;},get_Traits:function(){var bH;bH=this.$2;return bH!=null?{$:1,$0:bn.sortBy(function(bI){return bI.get_Name();},bH.$0)}:null;},get_Intent:function(){return this.$1;},get_Text:function(){return this.$0;}},null,J);L.New=function(bH,bI,bJ,bK,bL){return{body:bH,end:bI,start:bJ,suggested:bK,value:bL};};K["Intent'"]=function(bH,bI){return!(bI.intent==null)?{$:1,$0:new G({$:0,$0:d.toLower(bI.intent.value),$1:null})}:null;};K["Trait'"]=function(bH){return!(bH.domain==null)?{$:1,$0:new H({$:0,$0:"domain",$1:d.toLower(bH.domain.value),$2:null})}:!(bH.dialogue_act==null)?{$:1,$0:new H({$:0,$0:"dialogue_act",$1:d.toLower(bH.dialogue_act.value),$2:null})}:null;};K["Entity'$1"]=function(bH){return!(bH.contact==null)?{$:1,$0:new I({$:0,$0:"contact",$1:"",$2:d.toLower(bH.contact.value),$3:null})}:null;};N=M["Utterance'"]=bb.Class({get_TopIntent:function(){return bn.head(bn.sortBy(function(bH){return bH.get_Confidence();},this.get_Intents()));},get_Traits:function(){return this.$3;},get_Entities:function(){return this.$2;},get_Intents:function(){return this.$1;},get_Text:function(){return this.$0;}},null,N);O=M["Intent'"]=bb.Class({get_Confidence:function(){return this.$1;},get_Name:function(){return this.$0;}},null,O);P=M["Entity'"]=bb.Class({get_Value:function(){return(this.get_Unwrap())[3];},get_Role:function(){return(this.get_Unwrap())[2];},get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1,this.$2,this.$3];}},null,P);Q=M["Trait'"]=bb.Class({get_Value:function(){return(this.get_Unwrap())[2];},get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1,this.$2];}},null,Q);M.HasUtterance=function(bH){var bI,bJ,bK,bL,bM,bN;return bH!=null&&bH.$==1&&(bH.$0.$2.get_Length()>0&&(bI=[bH.$0.$2,bH.$0.$1,bH,bH.$0.$0,bH.$0.$3],true))?(bJ=bI[0],(bK=bI[2],(bL=bI[4],(bM=bI[1].$==0?null:{$:1,$0:new G({$:0,$0:bK.$0.get_TopIntent().get_Name(),$1:{$:1,$0:bK.$0.get_TopIntent().get_Confidence()}})},(bN=bJ.$==0?null:{$:1,$0:bn.map(function(bO){return new I({$:0,$0:bO.get_Name(),$1:d.toLower(bO.get_Role()),$2:bO.get_Value(),$3:{$:1,$0:bO.get_Confidence()}});},bn.filter(function(bO){return bO.get_Confidence()>M.entityConfidenceThreshold();},bJ))},{$:1,$0:new J({$:0,$0:bI[3],$1:bM,$2:bL.$==0?null:{$:1,$0:bn.map(function(bO){return new H({$:0,$0:d.toLower(bO.get_Name()),$1:bO.get_Value(),$2:{$:1,$0:bO.get_Confidence()}});},bn.filter(function(bO){return bO.get_Confidence()>M.entityConfidenceThreshold();},bL))},$3:bN})}))))):null;};M.entityConfidenceThreshold=function(){S.$cctor();return S.entityConfidenceThreshold;};M.set_entityConfidenceThreshold=function(bH){S.$cctor();S.entityConfidenceThreshold=bH;};M.intentConfidenceThreshold=function(){S.$cctor();return S.intentConfidenceThreshold;};M.set_intentConfidenceThreshold=function(bH){S.$cctor();S.intentConfidenceThreshold=bH;};M.getUtterance2=function(bH){var bI;bI=null;return bq.Delay(function(){return bq.Bind(r.getMeaning2("4Y2BLQY5TWLIN7HFIV264S53MY4PCUAT",bH),function(bJ){d.debug("NLU",(function(bK){return function(bL){return bK("Wit.ai returned "+$.p(bL)+" ");};}(a.id))(bJ));return bq.Return(new N({$:0,$0:bH,$1:bn.ofArray(bd.map(function(bK){return new O({$:0,$0:bK.name,$1:bK.confidence});},bJ.intents)),$2:bn.map(function(bK){return new P({$:0,$0:bK.name,$1:bK.confidence,$2:bK.role,$3:bK.value});},bn.ofSeq(bo.concat(bo.map(function(bK){return bK[1];},bu.ToSeq(bJ.entities))))),$3:bn.ofSeq(bo.map(function(bK){var bL;bL=bK[1];return new Q({$:0,$0:bK[0],$1:bd.get(bL,0).confidence,$2:bd.get(bL,0).value});},bu.ToSeq(bJ.traits)))}));});});};M.getUtterance=function(bH,bI){r.getMeaning("OOGDHEQL7JZRQASXN2N2GHFUKGO3SCNV",bH,function(bJ){var bK,bL;d.debug("NLU",(function(bM){return function(bN){return bM("Wit.ai returned: "+bj.prettyPrint(bN));};}(a.id))(bJ));bK=!(bJ.intents==null)?bn.ofArray(bd.map(function(bM){return new O({$:0,$0:bM.name,$1:bM.confidence});},bJ.intents)):bn.T.Empty;bL=!(bJ.traits==null)?bn.ofSeq(bo.concat(bn.map(function(bM){return bd.map(function(bN){return new Q({$:0,$0:bM,$1:bN.confidence,$2:bN.value});},bw.GetJS(bJ.traits,[bM]));},bn.filter(function(bM){return!(bw.GetJS(bJ.traits,[bM])==null);},M.trait_types())))):bn.T.Empty;return bI({$:1,$0:new N({$:0,$0:bH,$1:bK,$2:!(bJ.entities==null)?bn.ofSeq(bo.concat(bn.map(function(bM){return bd.map(function(bN){return new P({$:0,$0:bN.name,$1:bN.confidence,$2:bN.role,$3:bN.value});},bw.GetJS(bJ.entities,[bM]));},bn.filter(function(bM){return!(bw.GetJS(bJ.entities,[bM])==null);},M.entity_types())))):bn.T.Empty,$3:bL})});},function(bJ,bK,bL){d.error((((bb.Curried3(function(bM,bN,bO){return bM("Wit.ai returned: "+bj.prettyPrint(bN)+" "+bj.prettyPrint(bO));}))(a.id))(bK))(bL));return bI(null);});};M.trait_types=function(){S.$cctor();return S.trait_types;};M.entity_types=function(){S.$cctor();return S.entity_types;};M.QuickNumber=function(bH){var bI,bJ,bK;return(bJ=M.One(bH),bJ!=null&&bJ.$==1?(bI=bJ.$0,true):(bK=M.Two(bH),bK!=null&&bK.$==1&&(bI=bK.$0,true)))?{$:1,$0:bI}:null;};M.Three=function(bH){var bI;return bH==="3"||bH==="three"?{$:1,$0:new J({$:0,$0:"three",$1:{$:1,$0:new G({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bn.ofArray([new I({$:0,$0:"wit/ordinal",$1:"",$2:"three",$3:{$:1,$0:1}})])}})}:null;};M.Two=function(bH){var bI;return bH==="2"||bH==="two"?{$:1,$0:new J({$:0,$0:"two",$1:{$:1,$0:new G({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bn.ofArray([new I({$:0,$0:"wit/ordinal",$1:"",$2:"two",$3:{$:1,$0:1}})])}})}:null;};M.One=function(bH){var bI;return bH==="1"||bH==="one"?{$:1,$0:new J({$:0,$0:"one",$1:{$:1,$0:new G({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bn.ofArray([new I({$:0,$0:"wit/ordinal",$1:"",$2:"one",$3:{$:1,$0:1}})])}})}:null;};M.QuickNo=function(bH){var bI;return bH==="no"||(bH==="nope"||(bH==="no way"||(bH==="nah"||(bH==="don't do it"||bH==="stop"))))?{$:1,$0:new J({$:0,$0:"no",$1:{$:1,$0:new G({$:0,$0:"reject",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};M.QuickYes=function(bH){var bI;return bH==="yes"||(bH==="ok"||(bH==="sure"||(bH==="yeah"||(bH==="yep"||(bH==="uh huh"||(bH==="go ahead"||bH==="go"))))))?{$:1,$0:new J({$:0,$0:"yes",$1:{$:1,$0:new G({$:0,$0:"verify",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};M.QuickHelp=function(bH){var bI;return bH==="help"||(bH==="help me"||(bH==="what's this?"||bH==="huh"))?{$:1,$0:new J({$:0,$0:"help",$1:{$:1,$0:new G({$:0,$0:"help",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};M.QuickHello=function(bH){var bI;return bH==="hello"||(bH==="hey"||(bH==="yo"||bH==="hi"))?{$:1,$0:new J({$:0,$0:"hello",$1:{$:1,$0:new G({$:0,$0:"greet",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};M.Voices=function(bH){return bH==="voices"?{$:1,$0:null}:null;};M.Debug=function(bH){return bH==="debug"?{$:1,$0:null}:null;};M.Blank=function(bH){return bH===""?{$:1,$0:null}:null;};R.Study=function(bH){return bH.get_Traits()!=null?{$:0,$0:null}:{$:1,$0:null};};F.StrA=function(bH){if(bH!=null&&bH.$==1)try{return{$:1,$0:((by.DecodeArray(by.Id()))())(br.parse(bH.$0))};}catch(bI){return null;}else return null;};F.PStr=function(bH){var bI;return bH!=null&&bH.$==1&&(typeof bH.$0=="string"&&(bI=bH.$0,true))?{$:1,$0:bI}:null;};F.No=function(bH){var bI,bJ;return(bJ=F.Intent$1("reject",bH),bJ!=null&&bJ.$==1&&(bJ.$0[0]==null&&(bJ.$0[1]==null&&(bI=bH,true))))?{$:1,$0:bI}:null;};F.Yes=function(bH){var bI,bJ;return(bJ=F.Intent$1("verify",bH),bJ!=null&&bJ.$==1&&(bJ.$0[0]==null&&(bJ.$0[1]==null&&(bI=bH,true))))?{$:1,$0:bI}:null;};F.EntityManyofMany=function(bH,bI){return{$:1,$0:bu.OfArray(bd.ofSeq(bn.map(function(bJ){return bn.exists(function(bK){return bK.get_Role()===bJ;},bI)?[bJ,{$:1,$0:bn.filter(function(bK){return bK.get_Role()===bJ;},bI)}]:[bJ,null];},bH)))};};F.EntityManyOf1=function(bH,bI){var bJ;return bI!=null&&bI.$==1&&(bn.exists(function(bK){return bK.get_Role()===bH;},bI.$0)&&(bJ=bI.$0,true))?{$:1,$0:bn.filter(function(bK){return bK.get_Role()===bH;},bJ)}:null;};F.Entity1OfAny=function(bH,bI){var bJ;return bI!=null&&bI.$==1&&(bn.exists(function(bK){return bK.get_Role()===bH;},bI.$0)&&(bJ=bI.$0,true))?{$:1,$0:bn.head(bn.sortBy(function(bK){return bK.get_Role();},bn.filter(function(bK){return bK.get_Role()===bH;},bJ)))}:null;};F.Entity1Of1=function(bH,bI){var bJ,bK;return bI!=null&&bI.$==1&&(bI.$0.$==1&&(bI.$0.$1.$==0&&((bK=bI.$0.$0,bK.get_Role()===bH||bK.get_Name()===bH)&&(bJ=bI.$0.$0,true))))?{$:1,$0:bJ}:null;};F.Intent$1=function(bH,bI){return bI.get_Intent()!=null&&bI.get_Intent().$0.get_Name()===bH?{$:1,$0:[bI.get_Traits(),bI.get_Entities()]}:null;};S.$cctor=function(){S.$cctor=a.ignore;S.entity_types=bn.ofArray(["wit$contact:name","wit$datetime:datetime","term:subject","term:object","term:verb"]);S.trait_types=bn.ofArray(["domain","dialogue_act"]);S.intentConfidenceThreshold=0.85;S.entityConfidenceThreshold=0.85;};U.MicReady={$:5};U.MicAudioEnd={$:4};U.MicAudioStart={$:3};U.MicDisconnected={$:2};U.MicConnecting={$:1};U.MicNotInitialized={$:0};V.ClientUnderstand={$:2};V.ClientReady={$:1};V.ClientNotInitialzed={$:0};W=T.Interpreter=bb.Class({get_Options:function(){return(this.get_Unwrap())[2];},get_Text:function(){return(this.get_Unwrap())[1];},get_Voice:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1[0],this.$1[1]];}},null,W);X=T.CUI=bb.Class({GetSameTextTypingPattern:function(bH,bI){var bJ,bK;return this.TypingDNA.getTypingPattern(bI==null?(bJ={type:1},bJ.text=bH,bJ.caseSensitive=false,bJ):(bK={type:1},bK.text=bH,bK.caseSensitive=false,bK.targetId=bI.$0,bK));},MonitorTypingPattern:function(bH){this.TypingDNA.reset();bH!=null?this.TypingDNA.addTarget(bH.$0):void 0;this.TypingDNA.start();},SayVoices:function(){var bH,bI,bJ;bH=this;bI=a.speechSynthesis.getVoices();!(bI==null)?(bJ=d.toArray(bI),bH.Say((function(bK){return function(bL){return bK("There are currently "+a.String(bL)+" voices installed on this computer or device.");};}(a.id))(bd.length(bJ))),bd.iteri(function(bK,bL){return bH.Say(((((bb.Curried(function(bM,bN,bO,bP){return bM("Voice "+a.String(bN)+". Name: "+bj.toSafe(bO)+", Local: "+bj.prettyPrint(bP)+".");},4))(a.id))(bK))(bL.name))(bL.localService));},bJ)):void 0;},Wait:function(bH){this.Wait$1(function(){bq.Start(bH,null);});},Wait$1:function(bH){this["Echo'"]("please wait...");this.Term.pause();bH();this.Term.resume();},sayRandom:function(bH,bI){this.Say(D.getRandomPhrase(bH,bI));},SayAngry:function(bH){var bI,bJ;bI=this;bq.Start((bJ=null,bq.Delay(function(){return bq.Combine(a.speechSynthesis.speaking?(a.speechSynthesis.cancel(),bz.chime(),bq.Zero()):bq.Zero(),bq.Delay(function(){a.addMessage(bI.Avatar,bH,"","");bI.Avatar.processMessages(0);return bq.Zero();}));})),null);},SayDoc:function(bH){var bI,bJ,bK;bI=bd.get(bl(".terminal-output").get(),0).childNodes.length;bJ=bf.Element("div",[d.cls("terminal-command"),d.dindex(bI+1)],[bH]);bK=d.termOutput();bi.LoadLocalTemplates("");bf.RunAppend(bK,bJ);},Say:function(bH){var bI,bJ;bI=this;bq.Start((bJ=null,bq.Delay(function(){return bq.Combine(a.speechSynthesis.speaking?(bz.chime(),bq.Zero()):bq.Zero(),bq.Delay(function(){bI.Avatar.addMessage(bH);bI.Avatar.processMessages(0);return bq.Zero();}));})),null);},Debug:function(bH,bI){d.debug(bH,bI);},"EchoHtml'":function(bH){var bI,bJ;bI=(bJ={},bJ.raw=true,bJ);this.Term.disable();this.Term.echo(bH,bI);this.Term.enable();},"Echo'":function(bH){this.Term.disable();this.Term.echo(bH);this.Term.enable();}},null,X);X.New=function(bH,bI,bJ,bK,bL,bM,bN){return new X({Voice:bH,Mic:bI,Term:bJ,Avatar:bK,Caption:bL,TypingDNA:bM,AudioEnd:bN});};Y=c.Dialogue=bb.Class({get_Utterances:function(){return this.$4;},get_Output:function(){return this.$3;},get_DialogueQuestions:function(){return this.$2;},get_Props:function(){return this.$1;},get_Cui:function(){return this.$0;}},null,Y);Z=c.Question=bb.Class({toString:function(){return((((bb.Curried(function(bH,bI,bJ,bK){return bH("Name: "+bj.toSafe(bI)+" Module: "+bj.toSafe(bJ)+" Type: "+_.p$8(bK)+" ");},4))(a.id))(this.get_Name()))(this.get_Module()))(this.get_Type());},get_Ask:function(){return this.$3;},get_Type:function(){return this.$2;},get_Module:function(){return this.$1;},get_Name:function(){return this.$0;}},null,Z);_0.ConceptCompletion={$:3};_0.Disjunctive={$:2};_0.Verification={$:1};_0.UserAuthentication={$:0};_1["Response'_"]=function(bH,bI,bJ){var bK,bL,bM,bN,bO,bP,bQ,bR;return(bL=_1.PropNotSet_(bH,"user",bJ),bL!=null&&bL.$==1?(bM=_1.Form(bH,bI,bL.$0),bM!=null&&bM.$==1?(bK=bM.$0,true):(bN=_1.PropNotSet_(bH,"user",bJ),bN!=null&&bN.$==1&&(bO=_1.NotForm(bH,bI,bN.$0),bO!=null&&bO.$==1&&(bK=bO.$0,true)))):(bP=_1.PropNotSet_(bH,"user",bJ),bP!=null&&bP.$==1&&(bQ=_1.NotForm(bH,bI,bP.$0),bQ!=null&&bQ.$==1&&(bK=bQ.$0,true))))?(bR=_1.have(bH,bI)?{$:1,$0:_1.prop(bH,bI)}:null,bK.get_Text()!==""?{$:1,$0:[bK,{$:1,$0:bK.get_Text()},bR]}:{$:1,$0:[bK,null,bR]}):null;};_1.Response_=function(bH,bI,bJ){var bK,bL,bM,bN,bO,bP,bQ,bR;return(bL=_1.PropSet_(bH,"user",bJ),bL!=null&&bL.$==1?(bM=_1.Form(bH,bI,bL.$0),bM!=null&&bM.$==1?(bK=bM.$0,true):(bN=_1.PropSet_(bH,"user",bJ),bN!=null&&bN.$==1&&(bO=_1.NotForm(bH,bI,bN.$0),bO!=null&&bO.$==1&&(bK=bO.$0,true)))):(bP=_1.PropSet_(bH,"user",bJ),bP!=null&&bP.$==1&&(bQ=_1.NotForm(bH,bI,bP.$0),bQ!=null&&bQ.$==1&&(bK=bQ.$0,true))))?(bR=_1.have(bH,bI)?{$:1,$0:_1.prop(bH,bI)}:null,bK.get_Text()!==""?{$:1,$0:[bK,{$:1,$0:bK.get_Text()},bR]}:{$:1,$0:[bK,null,bR]}):null;};_1.NotForm=function(bH,bI,bJ){return bH.get_DialogueQuestions().length>0&&(bH.get_DialogueQuestions())[0].get_Name()===bI&&bJ.get_Text()!==""?{$:1,$0:bJ}:null;};_1.Form=function(bH,bI,bJ){return bH.get_DialogueQuestions().length>0&&(bH.get_DialogueQuestions())[0].get_Name()===bI&&bJ.get_Intent()!=null&&bJ.get_Intent().$0.get_Name()===bI&&bA.Equals(bJ.get_Intent().$0.get_Confidence(),{$:1,$0:1})&&bA.Equals(bJ.get_Traits(),null)&&bA.Equals(bJ.get_Entities(),null)?{$:1,$0:bJ}:null;};_1["User'_"]=function(bH,bI){var bJ,bK;return(bK=_1.PropNotSet_(bH,"user",bI),bK!=null&&bK.$==1&&(bH.get_DialogueQuestions().length===0&&(bJ=bK.$0,true)))?{$:1,$0:bJ}:null;};_1.User_=function(bH,bI){var bJ,bK;return(bK=_1.PropSet_(bH,"user",bI),bK!=null&&bK.$==1&&(bH.get_DialogueQuestions().length===0&&(bJ=bK.$0,true)))?{$:1,$0:bJ}:null;};_1.PropNotSet_=function(bH,bI,bJ){return!_1.have(bH,bI)?{$:1,$0:bJ}:null;};_1.PropSet_=function(bH,bI,bJ){return _1.have(bH,bI)?{$:1,$0:bJ}:null;};_1.Agenda_=function(bH,bI,bJ,bK){return bH.get_DialogueQuestions().length>0&&(bH.get_DialogueQuestions())[0].get_Module()===bJ?{$:1,$0:null}:null;};_1.debugInterpreterEnd=function(bH,bI,bJ){bI(((((bb.Curried(function(bK,bL,bM,bN){return bK(bj.toSafe(bL)+" ending utterances:"+bj.prettyPrint(bM)+", questions: "+bj.prettyPrint(bN)+".");},4))(a.id))(bJ))(bH.get_Utterances()))(bH.get_DialogueQuestions()));};_1.debugInterpreterStart=function(bH,bI,bJ){bI(((((bb.Curried(function(bK,bL,bM,bN){return bK(bj.toSafe(bL)+" starting utterances:"+bj.prettyPrint(bM)+", questions: "+bj.prettyPrint(bN)+".");},4))(a.id))(bJ))(bH.get_Utterances()))(bH.get_DialogueQuestions()));};_1.frame=function(bH){return bn.ofSeq(bo.take(bH.length>=5?5:bH.length,bH));};_1.didNotUnderstand=function(bH,bI,bJ){bI((function(bK){return function(bL){return bK(bj.toSafe(bL)+" interpreter did not understand utterance.");};}(a.id))(bJ));_1.popu(bH,bI);_1.say(bH,"Sorry I didn't understand what you meant.");};_1.endt=function(bH,bI,bJ,bK){_1.popu(bH,bI);_1.popq(bH,bI);_1.have(bH,bJ)?_1.remove(bH,bI,bJ):void 0;bI((function(bL){return function(bM){return bL("End turn "+bj.toSafe(bM)+".");};}(a.id))(bJ));bK();};_1.cancel=function(bH,bI,bJ){var bK;bK=(bH.get_DialogueQuestions())[0];bK.get_Name()!==bJ?(((bb.Curried3(function(bL,bM,bN){return bL(_.p$9(bM)+" at the top of the stack does not have the name "+bj.toSafe(bN)+".");}))(bB.FailWith))(bK))(bJ):void 0;_1.popq(bH,bI);bI((function(bL){return function(bM){return bL("Cancel "+_.p$9(bM)+".");};}(a.id))(bK));};_1.trigger=function(bH,bI,bJ,bK,bL){_1.pushu(bH,bI,new J({$:0,$0:br.stringify(bL),$1:{$:1,$0:new G({$:0,$0:bK,$1:{$:1,$0:1}})},$2:null,$3:null}));bJ(bH);};_1.ask=function(bH,bI,bJ){_1.pushq(bH,bI,bJ);(bJ.get_Ask())(bH);};_1.handle=function(bH,bI,bJ,bK){_1.popu(bH,bI);bI((function(bL){return function(bM){return bL("Handle utterance "+bj.toSafe(bM)+".");};}(a.id))(bJ));bK();};_1.dispatch=function(bH,bI,bJ,bK){bI(((((bb.Curried(function(bL,bM,bN,bO){return bL("Dispatch to module "+bj.toSafe(bM)+" utterances: "+bj.prettyPrint(bN)+" questions: "+bj.prettyPrint(bO)+".");},4))(a.id))(bJ))(bH.get_Utterances()))(bH.get_DialogueQuestions()));bK(bH);};_1.popq=function(bH,bI){var bJ;bJ=bH.get_DialogueQuestions().shift();bI((function(bK){return function(bL){return bK("Pop "+_.p$9(bL)+".");};}(a.id))(bJ));};_1.pushq=function(bH,bI,bJ){bH.get_DialogueQuestions().unshift(bJ);bI((function(bK){return function(bL){return bK("Push "+_.p$9(bL)+".");};}(a.id))(bJ));};_1.popu=function(bH,bI){var bJ;bJ=bH.get_Utterances().shift();bI((function(bK){return function(bL){return bK("Pop "+_.p$7(bL)+".");};}(a.id))(bJ));};_1.pushu=function(bH,bI,bJ){bI((function(bK){return function(bL){return bK("Push "+_.p$7(bL)+".");};}(a.id))(bJ));bH.get_Utterances().unshift(bJ);};_1.remove=function(bH,bI,bJ){bI((function(bK){return function(bL){return bK("Remove property "+bj.toSafe(bL)+".");};}(a.id))(bJ));bH.get_Props().Remove(bJ);};_1.add=function(bH,bI,bJ,bK){bH.get_Props().Add(bJ,bK);bI((((bb.Curried3(function(bL,bM,bN){return bL("Add property "+bj.toSafe(bM)+":"+bj.prettyPrint(bN)+".");}))(a.id))(bJ))(bK));};_1.prop=function(bH,bI){return bH.get_Props().ContainsKey(bI)?bH.get_Props().get_Item(bI):(function(bJ){return function(bK){return bJ("The "+bj.toSafe(bK)+" dialogue property does not exist.");};}(bB.FailWith))(bI);};_1.have=function(bH,bI){return bH.get_Props().ContainsKey(bI);};_1["sayRandom'"]=function(bH,bI){_1.sayRandom(bH,bI,"");};_1.sayRandom=function(bH,bI,bJ){var bK;bK=D.getRandomPhrase(bI,bJ);bH.get_Output().unshift(bK);bH.get_Cui().Say(bK);};_1.say=function(bH,bI){bH.get_Output().unshift(bI);_1["say'"](bH,bI);};_1["say'"]=function(bH,bI){bH.get_Cui().Say(bI);};_1.echo=function(bH,bI){(bH.get_Cui())["EchoHtml'"](bI);};_2.update=function(bH){var bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck;function cl(cB){_1.say(bH,cB);}function cm(cB,cC){return _1.sayRandom(bH,cB,cC);}function cn(cB,cC){return _1.add(bH,function(cD){_2.debug(cD);},cB,cC);}function co(cB){_2.debug(cB);}function cp(cB){_2.debug(cB);}function cq(cB){_2.debug(cB);}function cr(cB){_2.update(cB);}function cs(cB){_2.debug(cB);}function ct(cB){_2.debug(cB);}function cu(cB){return _1["User'_"](bH,cB);}function cv(cB,cC){return _1.Response_(bH,cB,cC);}function cw(cB,cC){return _1["Response'_"](bH,cB,cC);}function cx(cB){return new Z({$:0,$0:"authenticateUser",$1:_2.name(),$2:_0.UserAuthentication,$3:function(cC){var cD;function cE(){var cG;cC.get_Cui().MonitorTypingPattern(null);cG=d.createDialogueBoxCanvas();d.startCamera(self.document.body,cG);}function cF(){d.questionBox("Biometric Authentication","",640,480,null,{$:1,$0:cE},function(cG){var cH,cI;cH=d.getCameraCanvas().toDataURL();_2.debug((function(cJ){return function(cK){return cJ("User image is "+bj.toSafe(cK)+"...");};}(a.id))(bm.Substring(cH,0,10)));d.stopCamera();cI=cC.get_Cui().GetSameTextTypingPattern(cD,null);_2.debug((((bb.Curried3(function(cJ,cK,cL){return cJ("User entered typing pattern "+bj.toSafe(cK)+" for text "+bj.toSafe(cL));}))(a.id))(cI))(cG));cG.toLowerCase()!==cD.toLowerCase()?(cl("Sorry, you did not enter the passphrase correctly. Please try again."),cF()):(bK("authenticateUser"))([cB,cI,cH]);},function(){cl("Ok but you must login for me to help you.");d.stopCamera();bL("authenticateUser");});}cD=(function(cG){return function(cH){return cG("Hello my name is "+bj.toSafe(cH)+" and I am an administrator");};}(a.id))(cB);cl((function(cG){return function(cH){return cG("Enter the phrase "+bj.toSafe(cH)+".");};}(a.id))(cD));cF();}});}function cy(cB){var cC;cm(D.waitRetrievePhrases(),"user name");bq.Start((cC=null,bq.Delay(function(){return bq.Bind((new bD.New()).Async("SMApp.Web:SMApp.Web.Server.getUser:359336911",[cB]),function(cD){var cE;return cD==null?(cl((function(cF){return function(cG){return cF("I did not find a user with the name "+bj.toSafe(cG)+".");};}(a.id))(cB)),bJ(new Z({$:0,$0:"addUser",$1:_2.name(),$2:_0.Verification,$3:function(){cn("addUser",cB);cl((function(cF){return function(cG){return cF("Do you want me to add the user "+bj.toSafe(cG)+"?");};}(a.id))(cB));}})),bq.Zero()):(cE=cD.$0,bq.Bind((new bD.New()).Async("SMApp.Web:SMApp.Web.Server.updateUserLastLogin:1253788673",[cE.Name]),function(){cm(D.helloUserPhrases(),(function(cF){return function(cG){return cF(bj.prettyPrint(cG));};}(a.id))(cE.Name));return cE.LastLoggedIn!=null?bq.Bind((new bD.New()).Async("SMApp.Web:SMApp.Web.Server.humanize:-1746035227",[cE.LastLoggedIn.$0]),function(cF){cl((function(cG){return function(cH){return cG("You last logged in "+bj.toSafe(cH)+".");};}(a.id))(cF));bJ(cx(cB));return bq.Zero();}):bq.Zero();}));});})),null);}function cz(cB){return new Z({$:0,$0:"authenticateNewUser",$1:_2.name(),$2:_0.UserAuthentication,$3:function(cC){var cD;function cE(){var cG;cC.get_Cui().MonitorTypingPattern(null);cG=d.createDialogueBoxCanvas();d.startCamera(self.document.body,cG);}function cF(){d.questionBox("Biometric Authentication","",640,480,null,{$:1,$0:cE},function(cG){var cH,cI;cH=d.getCameraCanvas().toDataURL();_2.debug((function(cJ){return function(cK){return cJ("User image is "+bj.toSafe(cK)+"...");};}(a.id))(bm.Substring(cH,0,10)));d.stopCamera();cI=cC.get_Cui().GetSameTextTypingPattern(cD,null);_2.debug((((bb.Curried3(function(cJ,cK,cL){return cJ("User entered typing pattern "+bj.toSafe(cK)+" for text "+bj.toSafe(cL));}))(a.id))(cI))(cG));cG.toLowerCase()!==cD.toLowerCase()?(cl("Sorry you did not enter the passphrase correctly. Please try again."),cF()):(bK("authenticateNewUser"))([cB,cI,cH]);},function(){d.stopCamera();cl((function(cG){return function(cH){return cG("Ok I did not add the user "+bj.toSafe(cH)+". But you must login for me to help you.");};}(a.id))(cB));bL("authenticateNewUser");});}cD=(function(cG){return function(cH){return cG("Hello my name is "+bj.toSafe(cH)+" and I am an administrator");};}(a.id))(cB);cl((function(cG){return function(cH){return cG("Enter the phrase "+bj.toSafe(cH)+".");};}(a.id))(cD));cF();}});}function cA(cB){return new Z({$:0,$0:"switchUser",$1:_2.name(),$2:_0.Verification,$3:function(){cl((function(cC){return function(cD){return cC("Do you want me to switch to the user "+bj.toSafe(cD));};}(a.id))(cB));}});}_1.debugInterpreterStart(bH,function(cB){_2.debug(cB);},_2.name());bI=bb.Curried(_1.handle,2,[bH,co]);bJ=function(cB){_1.ask(bH,cp,cB);};bK=bb.Curried(_1.trigger,2,[bH,cq,cr]);bL=function(cB){_1.cancel(bH,cs,cB);};bM=bb.Curried(_1.endt,2,[bH,ct]);bN=_1.frame(bH.$4);bN.$==1&&(bP=cu(bN.$0),bP!=null&&bP.$==1&&(bQ=F.Intent$1("greet",bP.$0),bQ!=null&&bQ.$==1&&(bR=F.Entity1Of1("name",bQ.$0[1]),bR!=null&&bR.$==1&&(bN.$1.$==0&&(bO=bR.$0,true)))))?(bI("loginUser"))(function(){cy(bO.get_Value());}):bN.$==1&&(bT=cu(bN.$0),bT!=null&&bT.$==1&&(bU=F.Intent$1("hello",bT.$0),bU!=null&&bU.$==1&&(bV=F.Entity1Of1("contact",bU.$0[1]),bV!=null&&bV.$==1&&(bN.$1.$==0&&(bS=bV.$0,true)))))?(bI("loginUser"))(function(){cy(bS.get_Value());}):bN.$==1&&(bX=cw("authenticateUser",bN.$0),bX!=null&&bX.$==1&&(bY=F.StrA(bX.$0[1]),bY!=null&&bY.$==1&&(bN.$1.$==0&&(bW=bY.$0,true))))?(bM("authenticateUser"))(function(){cl((function(cB){return function(cC){return cB("Authenticate user "+bj.toSafe(cC)+".");};}(a.id))(bd.get(bW,0)));}):bN.$==1&&(b0=F.No(bN.$0),b0!=null&&b0.$==1&&(b1=cw("addUser",b0.$0),b1!=null&&b1.$==1&&(b2=F.PStr(b1.$0[2]),b2!=null&&b2.$==1&&(bN.$1.$==0&&(bZ=b2.$0,true)))))?(bM("addUser"))(function(){cl((function(cB){return function(cC){return cB("Ok I did not add the user "+bj.toSafe(cC)+". But you must login for me to help you.");};}(a.id))(bZ));}):bN.$==1&&(b4=F.Yes(bN.$0),b4!=null&&b4.$==1&&(b5=cw("addUser",b4.$0),b5!=null&&b5.$==1&&(b6=F.PStr(b5.$0[2]),b6!=null&&b6.$==1&&(bN.$1.$==0&&(b3=b6.$0,true)))))?(bM("addUser"))(function(){bJ(cz(b3));}):bN.$==1&&(b8=cw("authenticateNewUser",bN.$0),b8!=null&&b8.$==1&&(b9=F.StrA(b8.$0[1]),b9!=null&&b9.$==1&&(bN.$1.$==0&&(b7=b9.$0,true))))?(bM("authenticateNewUser"))(function(){cl((function(cB){return function(cC){return cB("Authenticate new user "+bj.toSafe(cC)+".");};}(a.id))(bd.get(b7,0)));}):bN.$==1&&(b$=_1.User_(bH,bN.$0),b$!=null&&b$.$==1&&(ca=F.Intent$1("hello",b$.$0),ca!=null&&ca.$==1&&(ca.$0[0]==null&&(cb=F.Entity1Of1("name",ca.$0[1]),cb!=null&&cb.$==1&&(bN.$1.$==0&&(b_=cb.$0,true))))))?bq.Start((cc=null,bq.Delay(function(){return bq.Bind((new bD.New()).Async("SMApp.Web:SMApp.Web.Server.getUser:359336911",[b_.get_Value()]),function(cB){return cB==null?(cl((function(cC){return function(cD){return cC("Sorry, the user "+bj.toSafe(cD)+" does not exist.");};}(a.id))(b_.get_Value())),bq.Zero()):(bJ(cA(cB.$0.Name)),bq.Zero());});})),null):bN.$==1&&(ce=F.Yes(bN.$0),ce!=null&&ce.$==1&&(cf=cv("switchUser",ce.$0),cf!=null&&cf.$==1&&(cg=F.PStr(cf.$0[2]),cg!=null&&cg.$==1&&(bN.$1.$==0&&(cd=cg.$0,true)))))?(bH.$1.set_Item("user",cd),cl((function(cB){return function(cC){return cB("Ok I switched to user "+bj.prettyPrint(cC)+".");};}(a.id))(cd))):bN.$==1&&(ci=F.No(bN.$0),ci!=null&&ci.$==1&&(cj=cv("switchUser",ci.$0),cj!=null&&cj.$==1&&(ck=F.PStr(cj.$0[2]),ck!=null&&ck.$==1&&(bN.$1.$==0&&(ch=ck.$0,true)))))?cl((function(cB){return function(cC){return cB("Ok I did not switch to user "+bj.toSafe(cC)+".");};}(a.id))(ch)):_1.didNotUnderstand(bH,function(cB){_2.debug(cB);},_2.name());_1.debugInterpreterEnd(bH,function(cB){_2.debug(cB);},_2.name());};_2.debug=function(bH){d.debug(_2.name(),bH);};_2.name=function(){_3.$cctor();return _3.name;};_3.$cctor=function(){_3.$cctor=a.ignore;_3.name="User";};_4.update=function(bH){var bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY;function bZ(b6){_1.echo(bH,b6);}function b0(b6){_1.say(bH,b6);}function b1(b6,b7){return _1.sayRandom(bH,b6,b7);}function b2(b6){return _1.prop(bH,b6);}function b3(b6){return _1.User_(bH,b6);}function b4(){return b2("user");}function b5(b6,b7,b8){var b9;return bq.Start((b9=null,bq.Delay(function(){b1(D.waitAddPhrases(),"symptom entry");return bq.Bind((new bD.New()).Async("SMApp.Web:SMApp.Web.Server.addSymptomJournalEntry:-1946867386",[b4().Name,b6,b7,b8]),function(b_){return b_.$==1?(b0(function(b$){return b$("Sorry I wasn't able to add that symptom to your journal. Could you try again?");}(a.id)),bq.Zero()):(b0((function(b$){return function(ca){return b$("OK I added that "+bj.toSafe(ca)+" symptom to your journal.");};}(a.id))(b6)),bq.Zero());});})),null);}_1.debugInterpreterStart(bH,function(b6){_4.debug(b6);},_4.name());bI=_1.frame(bH.$4);bI.$==1&&(bK=b3(bI.$0),bK!=null&&bK.$==1&&(bL=F.Intent$1("symptom",bK.$0),bL!=null&&bL.$==1&&(bM=F.Entity1OfAny("symptom_name",bL.$0[1]),bM!=null&&bM.$==1&&(bI.$1.$==0&&(bJ=bM.$0,true)))))?bq.Start((bN=null,bq.Delay(function(){b0("Ok I'll add that entry to your symptom journal");b5(bJ.get_Value(),null,null);return bq.Zero();})),null):bI.$==1&&(bP=F.Yes(bI.$0),bP!=null&&bP.$==1&&((bQ=_1.Response_(bH,"painVideo",bP.$0),bQ!=null&&bQ.$==1)&&bI.$1.$==0))?bH.$0["EchoHtml'"]("<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/SkAqOditKN0\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>"):bI.$==1&&(bS=b3(bI.$0),bS!=null&&bS.$==1&&(bT=F.Intent$1("medjournal",bS.$0),bT!=null&&bT.$==1&&((bU=bT.$0[1],bU!=null&&bU.$==1)&&(bI.$1.$==0&&(bR=bT.$0[1].$0,true)))))?(b0("ok I added that entry to your medication journal."),b0("You should be careful not to take too many painkillers over a short period of time.")):bI.$==1&&(bW=b3(bI.$0),bW!=null&&bW.$==1&&((bX=F.Intent$1("kbquery",bW.$0),bX!=null&&bX.$==1)&&(bI.$1.$==0&&(bV=bW.$0,true))))?bq.Start((bY=null,bq.Delay(function(){return bq.Bind(y.getAnswer(bV.get_Text()),function(b6){var b7;return bq.Bind((b7=bd.get(b6.answers,0).answer,(new bD.New()).Async("SMApp.Web:SMApp.Web.Server.mdtohtml:913755530",[b7])),function(b8){var b9;return bq.Bind((b9=bd.get(b6.answers,0).answer,(new bD.New()).Async("SMApp.Web:SMApp.Web.Server.mdtotext:913755530",[b9])),function(b_){bZ(b8);b0(b_);return bq.Zero();});});});})),null):_1.didNotUnderstand(bH,function(b6){_4.debug(b6);},_4.name());_1.debugInterpreterEnd(bH,function(b6){_4.debug(b6);},_4.name());};_4.debug=function(bH){d.debug(_4.name(),bH);};_4.name=function(){_5.$cctor();return _5.name;};_5.$cctor=function(){_5.$cctor=a.ignore;_5.name="Symptoms";};_6.update=function(bH){var bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2;function b3(b8){_1.say(bH,b8);}function b4(b8){_1["sayRandom'"](bH,b8);}function b5(b8){_6.debug(b8);}function b6(b8){_6.debug(b8);}function b7(b8){return _1["User'_"](bH,b8);}bI=bH.$4;_6.debug(((((bb.Curried(function(b8,b9,b_,b$){return b8("Module "+bj.toSafe(b9)+" starting utterances:"+bj.prettyPrint(b_)+", questions: "+bj.prettyPrint(b$)+".");},4))(a.id))(_6.name()))(bI))(bH.$2));bJ=bb.Curried(_1.dispatch,2,[bH,b5]);bK=bb.Curried(_1.handle,2,[bH,b6]);bL=bn.ofSeq(bo.take(bI.length>=5?5:bI.length,bI));bM=_1.Agenda_(bH,function(b8){_6.debug(b8);},_2.name(),bL);bM!=null&&bM.$==1?(_6.debug((function(b8){return function(b9){return b8("Agenda is "+_.p$9(b9)+".");};}(a.id))((bH.get_DialogueQuestions())[0])),_2.update(bH)):bL.$==1&&(bO=(bP=_1.PropNotSet_(bH,"started",bL.$0),bP!=null&&bP.$==1?{$:1,$0:bP.$0}:null),bO!=null&&bO.$==1&&(bQ=b7(bO.$0),bQ!=null&&bQ.$==1&&(bR=F.Intent$1("greet",bQ.$0),bR!=null&&bR.$==1&&(bR.$0[1]==null&&bL.$1.$==0))))?(_1.add(bH,function(b8){_6.debug(b8);},"started",true),(bK("greet"))(function(){b4(D.helloPhrases());})):bL.$==1&&(bT=b7(bL.$0),bT!=null&&bT.$==1&&(bU=F.Intent$1("greet",bT.$0),bU!=null&&bU.$==1&&(bU.$0[1]==null&&bL.$1.$==0)))?(bK("greet"))(function(){b3("Hello, tell me your name to get started.");}):bL.$==1&&(bW=b7(bL.$0),bW!=null&&bW.$==1&&(bX=F.Intent$1("greet",bW.$0),bX!=null&&bX.$==1&&((bY=F.Entity1Of1("name",bX.$0[1]),bY!=null&&bY.$==1)&&bL.$1.$==0)))?(bJ(_2.name()))(function(b8){_2.update(b8);}):bL.$==1&&(b0=b7(bL.$0),b0!=null&&b0.$==1&&(b1=F.Intent$1("hello",b0.$0),b1!=null&&b1.$==1&&((b2=F.Entity1Of1("contact",b1.$0[1]),b2!=null&&b2.$==1)&&bL.$1.$==0)))?(bJ(_2.name()))(function(b8){_2.update(b8);}):_1.didNotUnderstand(bH,function(b8){_6.debug(b8);},_6.name());_1.debugInterpreterEnd(bH,function(b8){_6.debug(b8);},_6.name());};_6.debug=function(bH){d.debug(_6.name(),bH);};_6.name=function(){_7.$cctor();return _7.name;};_7.$cctor=function(){_7.$cctor=a.ignore;_7.name="Main";};_8.run=function(){var bH,bI;bH=bb.ThisFunc(function(bJ,bK){return((_8.Main().get_Text())(bJ))(bK);});bI=_8.Main().get_Options();a.$("#term").terminal(bH,bI);return bf.get_Empty();};_8.Main=function(){_9.$cctor();return _9.Main;};_8.initMic=function(bH){var bI,bJ;_8.set_CUI((bI={$:1,$0:new bE.Microphone(bF.getElementById("microphone"))},X.New(_8.CUI().Voice,bI,_8.CUI().Term,_8.CUI().Avatar,_8.CUI().Caption,_8.CUI().TypingDNA,_8.CUI().AudioEnd)));bJ=_8.CUI().Mic.$0;bJ.onconnecting=function(){_8.set_MicState(U.MicConnecting);return _8.debug("Mic connecting...");};bJ.ondisconnected=function(){_8.set_MicState(U.MicDisconnected);return _8.debug("Mic disconnected.");};bJ.onaudiostart=function(){_8.set_MicState(U.MicAudioStart);return _8.debug("Mic audio start...");};bJ.onaudioend=function(){_8.set_MicState(U.MicAudioEnd);_8.debug("Mic audio end.");return _8.debug(self.lastMicData);};bJ.onerror=function(bK){_8.set_MicState({$:6,$0:bK});return _8.debug((function(bL){return function(bM){return bL("Mic error : "+bj.toSafe(bM)+".");};}(a.id))(bK));};bJ.onready=function(){_8.set_MicState(U.MicReady);return _8.debug("Mic ready.");};bJ.onresult=function(bK,bL){return _8.ClientState().$==2?_8.echo("I'm still trying to understand what you said before."):_8.ClientState().$==0?d.error("Client is not intialized."):!(bK==null||bL==null)?(_8.set_MicState({$:7,$0:bK,$1:bL}),_8.debug((((bb.Curried3(function(bM,bN,bO){return bM("Mic result: "+bj.prettyPrint(bN)+" "+bj.prettyPrint(bO)+".");}))(a.id))(bK))(bL)),bH(bK,bL)):_8.debug("Mic: No result returned.");};bJ.connect("4Y2BLQY5TWLIN7HFIV264S53MY4PCUAT");};_8.sayRandom=function(bH,bI){_8.say(D.getRandomPhrase(bI,bH));};_8.say=function(bH){_8.Output().unshift(bH);_8["say'"](bH);};_8["say'"]=function(bH){_8.CUI().Say(bH);};_8.initSpeech=function(){var bH;bH=d.toArray(_8.synth().getVoices());bd.length(bH)>0?(bd.iter(function(bI){if(bA.Equals(_8.CUI().Voice,null)&&(bI.name.indexOf("Microsoft Zira")!=-1||bI.name.toLowerCase().indexOf("female")!=-1)){_8.set_CUI(X.New({$:1,$0:bI},_8.CUI().Mic,_8.CUI().Term,_8.CUI().Avatar,_8.CUI().Caption,_8.CUI().TypingDNA,_8.CUI().AudioEnd));_8.debug((function(bJ){return function(bK){return bJ("Using browser speech synthesis voice "+bj.toSafe(bK)+".");};}(a.id))(_8.CUI().Voice.$0.name));}},bH),!bA.Equals(_8.CUI().Voice,null)?(_8.CUI().Avatar.nativeVoice=true,_8.CUI().Avatar.nativeVoiceName=_8.CUI().Voice.$0.name,_8.debug((function(bI){return function(bJ){return bI("Using browser speech synthesis voice "+bj.toSafe(bJ)+".");};}(a.id))(_8.CUI().Voice.$0.name))):void 0):void 0;bA.Equals(_8.CUI().Voice,null)?_8.debug("No female browser speech synthesis voice is available. Using CMU SLT Female voice via TTS."):void 0;};_8.synth=function(){_9.$cctor();return _9.synth;};_8.push=function(bH){_8.Utterances().unshift(bH);return _8.Dialogue();};_8.Dialogue=function(){_9.$cctor();return _9.Dialogue;};_8.Utterances=function(){_9.$cctor();return _9.Utterances;};_8.Questions=function(){_9.$cctor();return _9.Questions;};_8.Output=function(){_9.$cctor();return _9.Output;};_8.Props=function(){_9.$cctor();return _9.Props;};_8.wait=function(bH){d["Terminal.Echo'"](_8.CUI().Term,"please wait");_8.CUI().Term.pause();bH();_8.CUI().Term.resume();};_8.debug=function(bH){d.debug("CLIENT",bH);};_8.echo=function(bH){d["Terminal.EchoHtml'"](_8.CUI().Term,(function(bI){return function(bJ){return bI(bj.prettyPrint(bJ));};}(a.id))(bH));};_8.ClientState=function(){_9.$cctor();return _9.ClientState;};_8.set_ClientState=function(bH){_9.$cctor();_9.ClientState=bH;};_8.MicState=function(){_9.$cctor();return _9.MicState;};_8.set_MicState=function(bH){_9.$cctor();_9.MicState=bH;};_8.CUI=function(){_9.$cctor();return _9.CUI;};_8.set_CUI=function(bH){_9.$cctor();_9.CUI=bH;};_9.$cctor=function(){var bH,bI,bJ,bK;_9.$cctor=a.ignore;function bL(bN,bO){var bP,bQ,bR,bS,bT,bU,bV;_8.debug((((bb.Curried3(function(bW,bX,bY){return bW("Voice: "+bj.prettyPrint(bX)+" "+bj.prettyPrint(bY));}))(a.id))(bN))(bO));bP=(bQ=K["Intent'"](bN,bO),bQ!=null&&bQ.$==1?{$:1,$0:bQ.$0}:null);bR=(bS=K["Trait'"](bO),bS!=null&&bS.$==1?{$:1,$0:bn.ofArray([bS.$0])}:null);bT=(bU=K["Entity'$1"](bO),bU!=null&&bU.$==1?{$:1,$0:bn.ofArray([bU.$0])}:null);bP==null&&(bR==null&&bT==null)?void 0:(_8.debug(((((bb.Curried(function(bW,bX,bY,bZ){return bW("Voice: "+_.p(bX)+" "+_.p$3(bY)+" "+_.p$5(bZ));},4))(a.id))(bP))(bR))(bT)),_6.update(_8.push(new J({$:0,$0:"",$1:bP,$2:bR,$3:bT}))));}function bM(bN,bO){var bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1;_8.set_CUI(X.New(_8.CUI().Voice,_8.CUI().Mic,bN,_8.CUI().Avatar,_8.CUI().Caption,_8.CUI().TypingDNA,_8.CUI().AudioEnd));if(bA.Equals(_8.CUI().Mic,null))_8.initMic(bL);if(bA.Equals(_8.CUI().Voice,null))_8.initSpeech();if(_8.ClientState().$===0)_8.set_ClientState(V.ClientReady);bZ=M.Blank(bO);if(bZ!=null&&bZ.$==1)return _8["say'"]("Tell me what you want me to do or ask me a question.");else{b0=M.Debug(bO);if(b0!=null&&b0.$==1){_8.debug((function(b2){return function(b3){return b2("Utterances: "+bj.prettyPrint(b3));};}(a.id))(_8.Utterances()));_8.debug((function(b2){return function(b3){return b2("Questions: "+bj.prettyPrint(b3));};}(a.id))(_8.Questions()));bP=_8.Props().GetEnumerator$1();try{while(bP.MoveNext()){b1=bP.Current();_8.debug((((bb.Curried3(function(b2,b3,b4){return b2(bj.toSafe(b3)+": "+bj.prettyPrint(b4));}))(a.id))(b1.K))(b1.V));}return;}finally{bP.Dispose();}}else{bQ=M.Voices(bO);return bQ!=null&&bQ.$==1?(bR=d.toArray(d.speechSynthesis().getVoices()),_8["say'"]((function(b2){return function(b3){return b2("There are currently "+a.String(b3)+" voices installed on this computer or device.");};}(a.id))(bd.length(bR))),bd.iteri(function(b2,b3){return _8["say'"](((((bb.Curried(function(b4,b5,b6,b7){return b4("Voice "+a.String(b5)+". Name: "+bj.toSafe(b6)+", Local: "+bj.prettyPrint(b7)+".");},4))(a.id))(b2))(b3.name))(b3.localService));},bR)):_8.ClientState().$==1?(bT=M.QuickHello(bO),(bT!=null&&bT.$==1?(bS=bT.$0,true):(bU=M.QuickHelp(bO),bU!=null&&bU.$==1?(bS=bU.$0,true):(bV=M.QuickYes(bO),bV!=null&&bV.$==1?(bS=bV.$0,true):(bW=M.QuickNo(bO),bW!=null&&bW.$==1?(bS=bW.$0,true):(bX=M.QuickNumber(bO),bX!=null&&bX.$==1&&(bS=bX.$0,true))))))?(_8.debug((function(b2){return function(b3){return b2("Quick Text: "+_.p$7(b3)+".");};}(a.id))(bS)),_6.update(_8.push(bS)),_8.set_ClientState(V.ClientReady)):_8.CUI().Wait((bY=null,bq.Delay(function(){_8.set_ClientState(V.ClientUnderstand);M.getUtterance(bO,function(b2){var b3,b4;b3=M.HasUtterance(b2);b3!=null&&b3.$==1?(b4=b3.$0,_8.debug(((((bb.Curried(function(b5,b6,b7,b8){return b5("Text: Intent: "+_.p(b6)+", Traits: "+_.p$3(b7)+", Entities: "+_.p$5(b8)+".");},4))(a.id))(b4.get_Intent()))(b4.get_Traits()))(b4.get_Entities())),_6.update(_8.push(b4))):(_8.debug("Text: Did not receive a meaning from the server."),_8["say'"]("Sorry I did not understand what you said."));});_8.set_ClientState(V.ClientReady);return bq.Zero();})))):_8.ClientState().$==0?d.error("Client is not initialized."):_8["say'"]("I'm still trying to understand what you said before.");}}}_9.CUI=X.New(null,null,null,(bz.applicationId="4277115329081938617",bH=new a.SDKConnection(),bI=new a.WebAvatar(),bI.version=8.5,bI.connection=bH,bI.avatar="20926186",bI.voice="cmu-slt",bI.voiceMod="default",bI.width=175,bI.createBox(),bI.addMessage(""),bI.processMessages(0),bI),false,(bJ=new a.TypingDNA(),(bJ.stop(),bJ)),[]);_9.MicState=U.MicNotInitialized;_9.ClientState=V.ClientNotInitialzed;_9.Props=new bG.New$5();_9.Output=[];_9.Questions=[];_9.Utterances=[];_9.Dialogue=new Y({$:0,$0:_8.CUI(),$1:_8.Props(),$2:_8.Questions(),$3:_8.Output(),$4:_8.Utterances()});_9.synth=a.speechSynthesis;_9.Main=new W({$:0,$0:function(bN){return bL(bN[0],bN[1]);},$1:[function(bN){return function(bO){return bM(bN,bO);};},(bK={},bK.name="Main",bK.greetings="Welcome to Selma. Enter 'hello' or 'hello my name is...(you) to initialize speech.",bK.prompt=">",bK)]});};_.p$8=function(bH){return bH.$==3?"ConceptCompletion":bH.$==2?"Disjunctive":bH.$==1?"Verification":"UserAuthentication";};$.p=function(bH){return"{"+("text = "+bj.prettyPrint(bH.text))+"; "+("intents = "+bj.printArray(function(bI){return $.p$1(bI);},bH.intents))+"; "+("entities = "+bj.prettyPrint(bH.entities))+"; "+("traits = "+bj.prettyPrint(bH.traits))+"}";};$.p$1=function(bH){return"{"+("id = "+bj.prettyPrint(bH.id))+"; "+("name = "+bj.prettyPrint(bH.name))+"; "+("confidence = "+bj.prettyPrint(bH.confidence))+"}";};_.p$9=function(bH){return"Question ("+bj.prettyPrint(bH.$0)+", "+bj.prettyPrint(bH.$1)+", "+_.p$8(bH.$2)+", "+"<fun>"+")";};_.p$2=function(bH){return bH==null?"null":"Some "+bj.prettyPrint(bH.$0);};_.p$1=function(bH){return"Intent ("+bj.prettyPrint(bH.$0)+", "+_.p$2(bH.$1)+")";};_.p=function(bH){return bH==null?"null":"Some "+_.p$1(bH.$0);};_.p$4=function(bH){return"Trait ("+bj.prettyPrint(bH.$0)+", "+bj.prettyPrint(bH.$1)+", "+_.p$2(bH.$2)+")";};_.p$3=function(bH){return bH==null?"null":"Some "+bj.printList(function(bI){return _.p$4(bI);},bH.$0);};_.p$6=function(bH){return"Entity ("+bj.prettyPrint(bH.$0)+", "+bj.prettyPrint(bH.$1)+", "+bj.prettyPrint(bH.$2)+", "+_.p$2(bH.$3)+")";};_.p$5=function(bH){return bH==null?"null":"Some "+bj.printList(function(bI){return _.p$6(bI);},bH.$0);};_.p$7=function(bH){return"Utterance ("+bj.prettyPrint(bH.$0)+", "+_.p(bH.$1)+", "+_.p$3(bH.$2)+", "+_.p$5(bH.$3)+")";};}());
