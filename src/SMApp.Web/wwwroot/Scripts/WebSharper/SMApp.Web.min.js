(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ;a=self;b=a.SMApp=a.SMApp||{};c=b.Web=b.Web||{};d=c.ClientExtensions=c.ClientExtensions||{};e=d.SweetAlert=d.SweetAlert||{};f=c._Html=c._Html||{};g=c.htmModule=c.htmModule||{};h=a.StartupCode$SMApp_Web$ClientExtensions=a.StartupCode$SMApp_Web$ClientExtensions||{};i=c.TypingDNA=c.TypingDNA||{};j=i.SaveResponse=i.SaveResponse||{};k=i.UserResponse=i.UserResponse||{};l=i.VerifyResponse=i.VerifyResponse||{};m=c.Bs=c.Bs||{};n=b.NLU=b.NLU||{};o=n.Babelfy=n.Babelfy||{};p=o.ApiResponse=o.ApiResponse||{};q=o.TokenFragment=o.TokenFragment||{};r=o.CharFragment=o.CharFragment||{};s=n.Witai=n.Witai||{};t=s.Utterance=s.Utterance||{};u=s.Intent=s.Intent||{};v=s.Entity=s.Entity||{};w=s.Trait=s.Trait||{};x=s["Utterance'"]=s["Utterance'"]||{};y=s["Value'"]=s["Value'"]||{};z=n.QnAMaker=n.QnAMaker||{};A=z.ITSQuestion=z.ITSQuestion||{};B=z.ITSAnswerContext=z.ITSAnswerContext||{};C=z.ITSAnswer=z.ITSAnswer||{};D=z.ITSAnswers=z.ITSAnswers||{};E=c.NLG=c.NLG||{};F=a.StartupCode$SMApp_Web$NLG=a.StartupCode$SMApp_Web$NLG||{};G=c.NLU=c.NLU||{};H=G.Intent=G.Intent||{};I=G.Trait=G.Trait||{};J=G.Entity=G.Entity||{};K=G.Utterance=G.Utterance||{};L=G.Voice=G.Voice||{};M=L["Entity'"]=L["Entity'"]||{};N=G.Text=G.Text||{};O=N["Utterance'"]=N["Utterance'"]||{};P=N["Intent'"]=N["Intent'"]||{};Q=N["Entity'"]=N["Entity'"]||{};R=N["Trait'"]=N["Trait'"]||{};S=G.Domain=G.Domain||{};T=a.StartupCode$SMApp_Web$NLU=a.StartupCode$SMApp_Web$NLU||{};U=c.CUI=c.CUI||{};V=U.MicState=U.MicState||{};W=U.ClientState=U.ClientState||{};X=U.Interpreter=U.Interpreter||{};Y=U.CUI=U.CUI||{};Z=c.Dialogue=c.Dialogue||{};_0=c.Question=c.Question||{};_1=c.QuestionType=c.QuestionType||{};_2=c.DialogueModule=c.DialogueModule||{};_3=c.Questions=c.Questions||{};_4=c.User=c.User||{};_5=a.StartupCode$SMApp_Web$User=a.StartupCode$SMApp_Web$User||{};_6=c.Symptoms=c.Symptoms||{};_7=a.StartupCode$SMApp_Web$Symptoms=a.StartupCode$SMApp_Web$Symptoms||{};_8=c.Main=c.Main||{};_9=a.StartupCode$SMApp_Web$Main=a.StartupCode$SMApp_Web$Main||{};_=c.Client=c.Client||{};$=a.StartupCode$SMApp_Web$Client=a.StartupCode$SMApp_Web$Client||{};ba=a.SMApp$Web_GeneratedPrintf=a.SMApp$Web_GeneratedPrintf||{};bb=a.GeneratedPrintf=a.GeneratedPrintf||{};bc=a.WebSharper;bd=bc&&bc.Arrays;be=a.SweetAlert;bf=a.IntelliFactory;bg=bf&&bf.Runtime;bh=bc&&bc.Operators;bi=bc&&bc.UI;bj=bi&&bi.Doc;bk=bi&&bi.AttrProxy;bl=bi&&bi.Client;bm=bl&&bl.Templates;bn=bc&&bc.Utils;bo=a.console;bp=a.jQuery;bq=bc&&bc.Strings;br=bc&&bc.List;bs=bc&&bc.Seq;bt=bi&&bi.AttrModule;bu=bc&&bc.Concurrency;bv=a.JSON;bw=bc&&bc.Random;bx=bc&&bc.Collections;by=bx&&bx.Map;bz=bc&&bc.JavaScript;bA=bz&&bz.Pervasives;bB=bc&&bc.ClientSideJson;bC=bB&&bB.Provider;bD=a.SDK;bE=bc&&bc.Unchecked;bF=bc&&bc.Remoting;bG=bF&&bF.AjaxRemotingProvider;bH=a.Wit;bI=a.document;bJ=bx&&bx.Dictionary;d.getCameraCanvas=function(){return a.getCameraCanvas();};d.stopCamera=function(){return a.stopCamera();};d.startCamera=function(bK,bL){return a.startCamera(bK,bL);};d.speechSynthesis=function(){return a.speechSynthesis;};d.lastMicData=function(){return a.lastMicData;};d.Terminal=function(){return a.$("#term").terminal();};d.enableTerminal=function(){return a.$("#term").terminal().enable();};d.disableTerminal=function(){return a.$("#term").terminal().disable();};d.boxesWithTitles=function(bK){return bd.map(function(bL){var bM;bM={};bM.titleText=bL;return bM;},bK);};d.confirmQuestionBox=function(){be.clickConfirm();};d.questionBox=function(bK,bL,bM,bN,bO,bP,bQ){var bR,bS,bT,bU,bV,bW;bR=(bS=bN==null?(bT={},bT.titleText=bK,bT.text=bL,bT.icon="question",bT.html="<div></div>",bT.allowOutsideClick=false,bT):(bU=bN.$0[0],(bV={},bV.titleText=bK,bV.text=bL,bV.icon="question",bV.width=a.String(bU),bV.html=(((bg.Curried3(function(bX,bY,bZ){return bX("<div class=\"swal2-content-custom\" style=\"width:"+a.String(bY)+"px;height:"+a.String(bZ)+"px\"></div>");}))(a.id))(bU))(bN.$0[1]),bV.allowOutsideClick=false,bV)),(bO!=null?bO.$0(bS):void 0,bM!=null&&bM.$==1?(bW=bM.$0,(bS.progressSteps=bd.ofSeq(bh.range(1,bd.length(bW))),be.mixin(bS).queue(bd.create(bd.length(bW),bS)))):be.fire(bS)));bP!=null?bP.$0():void 0;bR.then(bQ);};e.get_QueueBoxes=function(){var bK;bK=be.mixin({});return function(bL){return bK.queue(bL);};};d.getDialogueBoxInput=function(){return bd.get(a.jQuery(".swal2-input").get(),0);};d.getDialogueBoxCanvas=function(){return bd.get(a.jQuery("canvas.swal2-content").get(),0);};d.getDialogueBoxContent=function(){return bd.get(a.jQuery("#swal2-content").get(),0).firstChild;};d.createDialogueBoxCanvas=function(){return d.createCanvas("camera","640","480",bd.get(a.jQuery("#swal2-content").get(),0).firstChild);};d.createCanvas=function(bK,bL,bM,bN){var bO;bO=bj.Element("canvas",[d.eid(bK),bk.Create("width",bL),bk.Create("height",bM)],[]);bm.LoadLocalTemplates("");bj.Run(bN,bO);return bN.firstChild;};d.elementHTML=function(bK){return bK.innerHTML;};d.createElement=function(bK){var bL;bL=self.document.createElement("div");self.document.appendChild(bL);bm.LoadLocalTemplates("");bj.RunAppend(bL,bK);};d.getContainer=function(){return bd.get(a.jQuery("#container").get(),0).firstChild;};d.container=function(bK){return bj.Element("div",[d.cls("container")],bK);};d.dindex=function(bK){return bk.Create("data-index",a.String(bK));};d.cls=function(bK){return bk.Create("class",bK);};d.eid=function(bK){return bk.Create("id",bK);};d.getMic=function(){return bd.get(a.jQuery("#microphone").get(),0);};d.terminalOutput=function(){return bd.get(a.jQuery(".terminal-output").get(),0);};d.toLower=function(bK){return bK.toLowerCase();};d.debug=function(bK,bL){d.info((((bg.Curried3(function(bM,bN,bO){return bM("DEBUG: "+bn.toSafe(bN)+": "+bn.prettyPrint(bO));}))(a.id))(bK.toUpperCase()))(bL));};d.error=function(bK){bo.error(bK);};d.info=function(bK){bo.info(bK);};d.jserror=function(bK){bp.error(bK);};d.toArray=function(bK){return bd.map(a.id,bp.makeArray(bK));};d["Terminal.EchoHtml'"]=function(bK,bL){bK.pause();bK.echo(bL,d.rawOpt());bK.resume();};d["Terminal.Echo'"]=function(bK,bL){bK.pause();bK.echo(bL);bK.resume();};d.rawOpt=function(){h.$cctor();return h.rawOpt;};f=c._Html=bg.Class({toString:function(){return f.toString(this);}},null,f);f.toString=function(bK){function bL(bM){return function(bN){var bO,bP,bQ,bR,bS,bT,bU;bP=bq.replicate(bM," ");switch(bN.$==0?bN.$1.$==1?bN.$1.$0.$==2?bN.$1.$1.$==0?(bO=[bN.$1.$0.$0,bN.$0],1):(bO=[bN.$1,bN.$0],2):(bO=[bN.$1,bN.$0],2):(bO=[bN.$1,bN.$0],2):bN.$==2?(bO=bN.$0,3):(bO=[bN.$0,bN.$1],0)){case 0:return bO[0]+"=\""+bO[1]+"\"";case 1:bQ=bO[1];return bP+"<"+bQ+">"+bO[0]+"</"+bQ+">\r\n";case 2:bR=bO[1];bS=br.partition(function(bV){return bV.$==1;},bO[0]);bT=bS[1];bU=bS[0];return bT.$==0?bP+"<"+bR+(bU.$===0?"":" "+bq.concat(" ",br.ofSeq(bs.delay(function(){return bs.map(function(bV){return(bL(0))(bV);},bU);}))))+"/>\r\n":bP+"<"+bR+(bU.$===0?"":" "+bq.concat(" ",br.ofSeq(bs.delay(function(){return bs.map(function(bV){return(bL(0))(bV);},bU);}))))+">\r\n"+bq.concat("",br.ofSeq(bs.delay(function(){return bs.map(function(bV){return(bL(bM+1))(bV);},bT);})))+bP+"</"+bR+">\r\n";case 3:return bP+bO+"\r\n";}};}return(bL(0))(bK);};g.alt=function(bK){return new f({$:1,$0:"alt",$1:bK});};g.src=function(bK){return new f({$:1,$0:"src",$1:bK});};g.cls=function(bK){return new f({$:1,$0:"class",$1:bK});};g.str=function(bK){return f.toString(bK);};g.op_PercentEquals=function(bK,bL){return new f({$:1,$0:bK,$1:bL});};g.op_Splice=function(bK){var bL;return br.ofArray([new f({$:2,$0:(bL=bK,a.String(bL))})]);};g.strong=function(){h.$cctor();return h.strong;};g.h4=function(){h.$cctor();return h.h4;};g.h3=function(){h.$cctor();return h.h3;};g.h2=function(){h.$cctor();return h.h2;};g.h1=function(){h.$cctor();return h.h1;};g.li=function(){h.$cctor();return h.li;};g.ul=function(){h.$cctor();return h.ul;};g.th=function(){h.$cctor();return h.th;};g.td=function(){h.$cctor();return h.td;};g.tr=function(){h.$cctor();return h.tr;};g.a=function(){h.$cctor();return h.a;};g.p=function(){h.$cctor();return h.p;};g.area=function(){h.$cctor();return h.area;};g.map=function(){h.$cctor();return h.map;};g.img=function(){h.$cctor();return h.img;};g.tfoot=function(){h.$cctor();return h.tfoot;};g.tbody=function(){h.$cctor();return h.tbody;};g.thead=function(){h.$cctor();return h.thead;};g.table=function(){h.$cctor();return h.table;};g.span=function(){h.$cctor();return h.span;};g.section=function(){h.$cctor();return h.section;};g.br=function(){h.$cctor();return h.br;};g.div=function(){h.$cctor();return h.div;};g.body=function(){h.$cctor();return h.body;};g.style=function(){h.$cctor();return h.style;};g.title=function(){h.$cctor();return h.title;};g.head=function(){h.$cctor();return h.head;};g.html=function(){h.$cctor();return h.html;};g.elem=function(bK,bL){return new f({$:0,$0:bK,$1:bL});};h.$cctor=function(){var bK;h.$cctor=a.ignore;h.rawOpt=(bK={},bK.raw=true,bK);h.html=function(bL){return g.elem("html",bL);};h.head=function(bL){return g.elem("head",bL);};h.title=function(bL){return g.elem("title",bL);};h.style=function(bL){return g.elem("style",bL);};h.body=function(bL){return g.elem("body",bL);};h.div=function(bL){return g.elem("div",bL);};h.br=function(bL){return g.elem("br",bL);};h.section=function(bL){return g.elem("section",bL);};h.span=function(bL){return g.elem("span",bL);};h.table=function(bL){return g.elem("table",bL);};h.thead=function(bL){return g.elem("thead",bL);};h.tbody=function(bL){return g.elem("tbody",bL);};h.tfoot=function(bL){return g.elem("tfoot",bL);};h.img=function(bL){return g.elem("img",bL);};h.map=function(bL){return g.elem("map",bL);};h.area=function(bL){return g.elem("area",bL);};h.p=function(bL){return g.elem("p",bL);};h.a=function(bL){return g.elem("a",bL);};h.tr=function(bL){return g.elem("tr",bL);};h.td=function(bL){return g.elem("td",bL);};h.th=function(bL){return g.elem("th",bL);};h.ul=function(bL){return g.elem("ul",bL);};h.li=function(bL){return g.elem("li",bL);};h.h1=function(bL){return g.elem("h1",bL);};h.h2=function(bL){return g.elem("h1",bL);};h.h3=function(bL){return g.elem("h1",bL);};h.h4=function(bL){return g.elem("h1",bL);};h.strong=function(bL){return g.elem("strong",bL);};};j.New=function(bK,bL,bM,bN){return{name:bK,message:bL,message_code:bM,status:bN};};k.New=function(bK,bL,bM,bN,bO){return{message:bK,message_code:bL,success:bM,count:bN,status:bO};};l.New=function(bK,bL,bM,bN,bO,bP){return{message:bK,message_code:bL,success:bM,result:bN,score:bO,confidence:bP};};m.Radio=function(bK,bL,bM,bN,bO){return bj.Element("div",new br.T({$:1,$0:d.cls("radio"),$1:bL}),[bj.Element("label",bN,[bj.Radio(bO,true,bM),bj.TextNode(bK)])]);};m.checkbox=function(bK,bL,bM,bN,bO){return bj.Element("div",new br.T({$:1,$0:d.cls("checkbox"),$1:bL}),[bj.Element("label",bN,[bj.CheckBox(bO,bM),bj.TextNode(bK)])]);};m.textArea=function(bK,bL,bM,bN,bO){return bj.Element("div",new br.T({$:1,$0:d.cls("form-group"),$1:bL}),[bj.Element("label",bN,[bj.TextNode(bK)]),bj.InputArea(new br.T({$:1,$0:d.cls("form-control"),$1:bO}),bM)]);};m.inputPassword=function(bK,bL,bM,bN,bO){return bj.Element("div",new br.T({$:1,$0:d.cls("form-group"),$1:bL}),[bj.Element("label",bN,[bj.TextNode(bK)]),bj.PasswordBox(new br.T({$:1,$0:d.cls("form-control"),$1:bO}),bM)]);};m.input=function(bK,bL,bM,bN,bO){return bj.Element("div",new br.T({$:1,$0:d.cls("form-group"),$1:bL}),[bj.Element("label",bN,[bj.TextNode(bK)]),bj.Input([d.cls("form-control"),bO],bM)]);};m.btnSecondary=function(bK,bL,bM){return bj.Element("button",[d.eid(bK),d.cls("btn btn-secondary"),bt.Handler("click",bM)],[bj.TextNode(bL)]);};m.btnPrimary=function(bK,bL,bM){return bj.Element("button",[d.eid(bK),d.cls("btn btn-primary"),bt.Handler("click",bM)],[bj.TextNode(bL)]);};p.New=function(bK,bL,bM,bN,bO,bP,bQ,bR,bS){return{tokenFragment:bK,charFragment:bL,babelSynsetID:bM,DBpediaURL:bN,BabelNetURL:bO,score:bP,cohrenceScore:bQ,globalScore:bR,source:bS};};q.New=function(bK,bL){return{start:bK,end:bL};};r.New=function(bK,bL){return{start:bK,end:bL};};o.disambiguate=function(bK){function bL(bM,bN){var bO;bp.ajax((bO={},bO.url=(function(bP){return function(bQ){return bP("https://babelfy.io/v1/disambiguate?text="+bn.toSafe(bQ)+"&lang=EN&extAIDA=true&key=983fc0ec-a6fa-49ef-bd02-203c18aef272");};}(a.id))(bK),bO.type="GET",bO.success=function(bP){return bM(bP);},bO.error=function(bP){return bN(new a.Error(bP.responseText));},bO));}return bu.FromContinuations(function(bM,bN,bO){return bL.apply(null,[bM,bN,bO]);});};t.New=function(bK,bL,bM,bN){return{text:bK,intents:bL,entities:bM,traits:bN};};u.New=function(bK,bL,bM){return{id:bK,name:bL,confidence:bM};};v.New=function(bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU){return{id:bK,name:bL,role:bM,start:bN,end:bO,body:bP,confidence:bQ,entities:bR,suggested:bS,value:bT,type:bU};};w.New=function(bK,bL,bM){return{id:bK,value:bL,confidence:bM};};x.New=function(bK){return{intent:bK};};y.New=function(bK){return{value:bK};};s.getMeaning2=function(bK,bL){function bM(bN,bO){var bP;bp.ajax((bP={},bP.url=(function(bQ){return function(bR){return bQ("https://api.wit.ai/message?q="+bn.toSafe(bR));};}(a.id))(bL),bP.type="GET",bP.beforeSend=function(bQ){return bQ.setRequestHeader("Authorization","Bearer "+bK);},bP.success=function(bQ){return bN(bQ);},bP.error=function(bQ){return bO(new a.Error(bQ.responseText));},bP));}return bu.FromContinuations(function(bN,bO,bP){return bM.apply(null,[bN,bO,bP]);});};s.getMeaning=function(bK,bL,bM,bN){var bO;bp.ajax((bO={},bO.url=(function(bP){return function(bQ){return bP("https://api.wit.ai/message?q="+bn.toSafe(bQ));};}(a.id))(bL),bO.type="GET",bO.beforeSend=function(bP){return bP.setRequestHeader("Authorization","Bearer "+bK);},bO.success=bM,bO.error=bN,bO));};A.New=function(bK){return{question:bK};};B.New=function(bK,bL){return{isContextOnly:bK,prompts:bL};};C.New=function(bK,bL,bM,bN,bO,bP,bQ){return{questions:bK,answer:bL,score:bM,id:bN,source:bO,metadata:bP,context:bQ};};D.New=function(bK){return{answers:bK};};z.getAnswer=function(bK){function bL(bM,bN){var bO;bp.ajax((bO={},bO.url="https://lerna.azurewebsites.net/qnamaker/knowledgebases/13a6a026-942b-4612-a8cb-654086ec76ee/generateAnswer",bO.type="POST",bO.beforeSend=function(bP){return bP.setRequestHeader("Authorization","EndpointKey e5a55563-b1b0-4343-8796-bda5a0509385");},bO.contentType="application/json",bO.dataType="json",bO.data=bv.stringify(A.New(bK)),bO.success=function(bP){return bM(bP);},bO.error=function(bP){return bN(new a.Error(bP.responseText));},bO));}return bu.FromContinuations(function(bM,bN,bO){return bL.apply(null,[bM,bN,bO]);});};E.waitAddPhrases=function(){F.$cctor();return F.waitAddPhrases;};E.waitRetrievePhrases=function(){F.$cctor();return F.waitRetrievePhrases;};E.helpPhrases=function(){F.$cctor();return F.helpPhrases;};E.helloUserPhrases=function(){F.$cctor();return F.helloUserPhrases;};E.helloPhrases=function(){F.$cctor();return F.helloPhrases;};E["getRandomPhrase'"]=function(bK){return E.replace_tok("$0","",bs.nth(E.rng().Next(0,bK.get_Length()),bK));};E.getRandomPhrase=function(bK,bL){return E.replace_tok("$0",bL,bs.nth(E.rng().Next(0,bK.get_Length()),bK));};E.replace_tok=function(bK,bL,bM){return bq.Replace(bM,bK,bL);};E.rng=function(){F.$cctor();return F.rng;};F.$cctor=function(){F.$cctor=a.ignore;F.rng=new bw.New();F.helloPhrases=br.ofArray(["Welcome!","Welcome, my name is Selma.","Welcome to Selma. How can I help?","Hello this is Selma, how can I help?","Hello, I am Selma. How can I help?","Hello, I am Selma. How may I help you now?","I'm Selma. Tell me your name so we can get started."]);F.helloUserPhrases=br.ofArray(["Hello $0, welcome back.","Welcome $0, nice to see you again.","Hello $0.","Good to see you $0.","Hello $0, nice to see you."]);F.helpPhrases=br.ofArray(["What can I help you with $0?"]);F.waitRetrievePhrases=br.ofArray(["Ok, let me check that $0 for you","Please wait while I check that $0 for you.","Wait while I check that $0.","Ok let me see if I can find that $0."]);F.waitAddPhrases=br.ofArray(["Ok, let me add that $0 for you","Please wait while I add that $0 for you.","Wait while I add that $0.","I'll add that $0 now."]);};H=G.Intent=bg.Class({toString:function(){return(((bg.Curried3(function(bK,bL,bM){return bK("Intent("+bn.toSafe(bL)+", "+ba.p$2(bM)+")");}))(a.id))(this.get_Name()))(this.get_Confidence());},get_Confidence:function(){return this.$1;},get_Name:function(){return this.$0;}},null,H);I=G.Trait=bg.Class({toString:function(){return(((bg.Curried3(function(bK,bL,bM){return bK("Trait("+bn.toSafe(bL)+", "+bn.prettyPrint(bM)+")");}))(a.id))(this.get_Name()))(this.get_Value());},get_Confidence:function(){return this.$2;},get_Value:function(){return this.$1;},get_Name:function(){return this.$0;}},null,I);J=G.Entity=bg.Class({toString:function(){return(((((bg.Curried(function(bK,bL,bM,bN,bO){return bK("Entity("+bn.toSafe(bL)+", "+bn.toSafe(bM)+", "+bn.toSafe(bN)+", "+ba.p$2(bO)+")");},5))(a.id))(this.get_Name()))(this.get_Role()))(this.get_Value()))(this.get_Confidence());},get_Confidence:function(){return this.$3;},get_Value:function(){return this.$2;},get_Role:function(){return this.$1;},get_Name:function(){return this.$0;}},null,J);K=G.Utterance=bg.Class({toString:function(){return((((bg.Curried(function(bK,bL,bM,bN){return bK(ba.p(bL)+" "+ba.p$3(bM)+" "+ba.p$5(bN));},4))(a.id))(this.get_Intent()))(this.get_Traits()))(this.get_Entities());},get_Entities:function(){var bK;bK=this.$3;return bK!=null?{$:1,$0:br.sortBy(function(bL){return bL.get_Name();},bK.$0)}:null;},get_Traits:function(){var bK;bK=this.$2;return bK!=null?{$:1,$0:br.sortBy(function(bL){return bL.get_Name();},bK.$0)}:null;},get_Intent:function(){return this.$1;},get_Text:function(){return this.$0;}},null,K);M.New=function(bK,bL,bM,bN,bO){return{body:bK,end:bL,start:bM,suggested:bN,value:bO};};L["Intent'"]=function(bK,bL){return!(bL.intent==null)?{$:1,$0:new H({$:0,$0:d.toLower(bL.intent.value),$1:null})}:null;};L["Trait'"]=function(bK){return!(bK.domain==null)?{$:1,$0:new I({$:0,$0:"domain",$1:d.toLower(bK.domain.value),$2:null})}:!(bK.dialogue_act==null)?{$:1,$0:new I({$:0,$0:"dialogue_act",$1:d.toLower(bK.dialogue_act.value),$2:null})}:null;};L["Entity'$1"]=function(bK){return!(bK.contact==null)?{$:1,$0:new J({$:0,$0:"contact",$1:"",$2:d.toLower(bK.contact.value),$3:null})}:null;};O=N["Utterance'"]=bg.Class({get_TopIntent:function(){return br.head(br.sortBy(function(bK){return bK.get_Confidence();},this.get_Intents()));},get_Traits:function(){return this.$3;},get_Entities:function(){return this.$2;},get_Intents:function(){return this.$1;},get_Text:function(){return this.$0;}},null,O);P=N["Intent'"]=bg.Class({get_Confidence:function(){return this.$1;},get_Name:function(){return this.$0;}},null,P);Q=N["Entity'"]=bg.Class({get_Value:function(){return(this.get_Unwrap())[3];},get_Role:function(){return(this.get_Unwrap())[2];},get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1,this.$2,this.$3];}},null,Q);R=N["Trait'"]=bg.Class({get_Value:function(){return(this.get_Unwrap())[2];},get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1,this.$2];}},null,R);N.HasUtterance=function(bK){var bL,bM,bN,bO,bP,bQ;return bK!=null&&bK.$==1&&(bK.$0.$2.get_Length()>0&&(bL=[bK.$0.$2,bK.$0.$1,bK,bK.$0.$0,bK.$0.$3],true))?(bM=bL[0],(bN=bL[2],(bO=bL[4],(bP=bL[1].$==0?null:{$:1,$0:new H({$:0,$0:bN.$0.get_TopIntent().get_Name(),$1:{$:1,$0:bN.$0.get_TopIntent().get_Confidence()}})},(bQ=bM.$==0?null:{$:1,$0:br.map(function(bR){return new J({$:0,$0:bR.get_Name(),$1:d.toLower(bR.get_Role()),$2:bR.get_Value(),$3:{$:1,$0:bR.get_Confidence()}});},br.filter(function(bR){return bR.get_Confidence()>N.entityConfidenceThreshold();},bM))},{$:1,$0:new K({$:0,$0:bL[3],$1:bP,$2:bO.$==0?null:{$:1,$0:br.map(function(bR){return new I({$:0,$0:d.toLower(bR.get_Name()),$1:bR.get_Value(),$2:{$:1,$0:bR.get_Confidence()}});},br.filter(function(bR){return bR.get_Confidence()>N.entityConfidenceThreshold();},bO))},$3:bQ})}))))):null;};N.entityConfidenceThreshold=function(){T.$cctor();return T.entityConfidenceThreshold;};N.set_entityConfidenceThreshold=function(bK){T.$cctor();T.entityConfidenceThreshold=bK;};N.intentConfidenceThreshold=function(){T.$cctor();return T.intentConfidenceThreshold;};N.set_intentConfidenceThreshold=function(bK){T.$cctor();T.intentConfidenceThreshold=bK;};N.getUtterance2=function(bK){var bL;bL=null;return bu.Delay(function(){return bu.Bind(s.getMeaning2("4Y2BLQY5TWLIN7HFIV264S53MY4PCUAT",bK),function(bM){d.debug("NLU",(function(bN){return function(bO){return bN("Wit.ai returned "+bb.p(bO)+" ");};}(a.id))(bM));return bu.Return(new O({$:0,$0:bK,$1:br.ofArray(bd.map(function(bN){return new P({$:0,$0:bN.name,$1:bN.confidence});},bM.intents)),$2:br.map(function(bN){return new Q({$:0,$0:bN.name,$1:bN.confidence,$2:bN.role,$3:bN.value});},br.ofSeq(bs.concat(bs.map(function(bN){return bN[1];},by.ToSeq(bM.entities))))),$3:br.ofSeq(bs.map(function(bN){var bO;bO=bN[1];return new R({$:0,$0:bN[0],$1:bd.get(bO,0).confidence,$2:bd.get(bO,0).value});},by.ToSeq(bM.traits)))}));});});};N.getUtterance=function(bK,bL){s.getMeaning("OOGDHEQL7JZRQASXN2N2GHFUKGO3SCNV",bK,function(bM){var bN,bO;d.debug("NLU",(function(bP){return function(bQ){return bP("Wit.ai returned: "+bn.prettyPrint(bQ));};}(a.id))(bM));bN=!(bM.intents==null)?br.ofArray(bd.map(function(bP){return new P({$:0,$0:bP.name,$1:bP.confidence});},bM.intents)):br.T.Empty;bO=!(bM.traits==null)?br.ofSeq(bs.concat(br.map(function(bP){return bd.map(function(bQ){return new R({$:0,$0:bP,$1:bQ.confidence,$2:bQ.value});},bA.GetJS(bM.traits,[bP]));},br.filter(function(bP){return!(bA.GetJS(bM.traits,[bP])==null);},N.trait_types())))):br.T.Empty;return bL({$:1,$0:new O({$:0,$0:bK,$1:bN,$2:!(bM.entities==null)?br.ofSeq(bs.concat(br.map(function(bP){return bd.map(function(bQ){return new Q({$:0,$0:bQ.name,$1:bQ.confidence,$2:bQ.role,$3:bQ.value});},bA.GetJS(bM.entities,[bP]));},br.filter(function(bP){return!(bA.GetJS(bM.entities,[bP])==null);},N.entity_types())))):br.T.Empty,$3:bO})});},function(bM,bN,bO){d.error((((bg.Curried3(function(bP,bQ,bR){return bP("Wit.ai returned: "+bn.prettyPrint(bQ)+" "+bn.prettyPrint(bR));}))(a.id))(bN))(bO));return bL(null);});};N.trait_types=function(){T.$cctor();return T.trait_types;};N.entity_types=function(){T.$cctor();return T.entity_types;};N.QuickNumber=function(bK){var bL,bM,bN;return(bM=N.One(bK),bM!=null&&bM.$==1?(bL=bM.$0,true):(bN=N.Two(bK),bN!=null&&bN.$==1&&(bL=bN.$0,true)))?{$:1,$0:bL}:null;};N.Three=function(bK){var bL;return bK==="3"||bK==="three"?{$:1,$0:new K({$:0,$0:"three",$1:{$:1,$0:new H({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:br.ofArray([new J({$:0,$0:"wit/ordinal",$1:"",$2:"three",$3:{$:1,$0:1}})])}})}:null;};N.Two=function(bK){var bL;return bK==="2"||bK==="two"?{$:1,$0:new K({$:0,$0:"two",$1:{$:1,$0:new H({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:br.ofArray([new J({$:0,$0:"wit/ordinal",$1:"",$2:"two",$3:{$:1,$0:1}})])}})}:null;};N.One=function(bK){var bL;return bK==="1"||bK==="one"?{$:1,$0:new K({$:0,$0:"one",$1:{$:1,$0:new H({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:br.ofArray([new J({$:0,$0:"wit/ordinal",$1:"",$2:"one",$3:{$:1,$0:1}})])}})}:null;};N.QuickNo=function(bK){var bL;return bK==="no"||(bK==="nope"||(bK==="no way"||(bK==="nah"||(bK==="don't do it"||bK==="stop"))))?{$:1,$0:new K({$:0,$0:"no",$1:{$:1,$0:new H({$:0,$0:"reject",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};N.QuickYes=function(bK){var bL;return bK==="yes"||(bK==="ok"||(bK==="sure"||(bK==="yeah"||(bK==="yep"||(bK==="uh huh"||(bK==="go ahead"||bK==="go"))))))?{$:1,$0:new K({$:0,$0:"yes",$1:{$:1,$0:new H({$:0,$0:"verify",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};N.QuickHelp=function(bK){var bL;return bK==="help"||(bK==="help me"||(bK==="what's this?"||bK==="huh"))?{$:1,$0:new K({$:0,$0:"help",$1:{$:1,$0:new H({$:0,$0:"help",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};N.QuickHello=function(bK){var bL;return bK==="hello"||(bK==="hey"||(bK==="yo"||bK==="hi"))?{$:1,$0:new K({$:0,$0:"hello",$1:{$:1,$0:new H({$:0,$0:"greet",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};N.Voices=function(bK){return bK==="voices"?{$:1,$0:null}:null;};N.Debug=function(bK){return bK==="debug"?{$:1,$0:null}:null;};N.Blank=function(bK){return bK===""?{$:1,$0:null}:null;};S.Study=function(bK){return bK.get_Traits()!=null?{$:0,$0:null}:{$:1,$0:null};};G.StrA=function(bK){if(bK!=null&&bK.$==1)try{return{$:1,$0:((bC.DecodeArray(bC.Id()))())(bv.parse(bK.$0))};}catch(bL){return null;}else return null;};G.PStr=function(bK){var bL;return bK!=null&&bK.$==1&&(typeof bK.$0=="string"&&(bL=bK.$0,true))?{$:1,$0:bL}:null;};G.No=function(bK){var bL,bM;return(bM=G.Intent$1("reject",bK),bM!=null&&bM.$==1&&(bM.$0[0]==null&&(bM.$0[1]==null&&(bL=bK,true))))?{$:1,$0:bL}:null;};G.Yes=function(bK){var bL,bM;return(bM=G.Intent$1("verify",bK),bM!=null&&bM.$==1&&(bM.$0[0]==null&&(bM.$0[1]==null&&(bL=bK,true))))?{$:1,$0:bL}:null;};G.EntityManyofMany=function(bK,bL){return{$:1,$0:by.OfArray(bd.ofSeq(br.map(function(bM){return br.exists(function(bN){return bN.get_Role()===bM;},bL)?[bM,{$:1,$0:br.filter(function(bN){return bN.get_Role()===bM;},bL)}]:[bM,null];},bK)))};};G.EntityManyOf1=function(bK,bL){var bM;return bL!=null&&bL.$==1&&(br.exists(function(bN){return bN.get_Role()===bK;},bL.$0)&&(bM=bL.$0,true))?{$:1,$0:br.filter(function(bN){return bN.get_Role()===bK;},bM)}:null;};G.Entity1OfAny=function(bK,bL){var bM;return bL!=null&&bL.$==1&&(br.exists(function(bN){return bN.get_Role()===bK;},bL.$0)&&(bM=bL.$0,true))?{$:1,$0:br.head(br.sortBy(function(bN){return bN.get_Role();},br.filter(function(bN){return bN.get_Role()===bK;},bM)))}:null;};G.Entity1Of1=function(bK,bL){var bM,bN;return bL!=null&&bL.$==1&&(bL.$0.$==1&&(bL.$0.$1.$==0&&((bN=bL.$0.$0,bN.get_Role()===bK||bN.get_Name()===bK)&&(bM=bL.$0.$0,true))))?{$:1,$0:bM}:null;};G.Intent$1=function(bK,bL){return bL.get_Intent()!=null&&bL.get_Intent().$0.get_Name()===bK?{$:1,$0:[bL.get_Traits(),bL.get_Entities()]}:null;};T.$cctor=function(){T.$cctor=a.ignore;T.entity_types=br.ofArray(["wit$contact:name","wit$datetime:datetime","term:subject","term:object","term:verb"]);T.trait_types=br.ofArray(["domain","dialogue_act"]);T.intentConfidenceThreshold=0.85;T.entityConfidenceThreshold=0.85;};V.MicReady={$:5};V.MicAudioEnd={$:4};V.MicAudioStart={$:3};V.MicDisconnected={$:2};V.MicConnecting={$:1};V.MicNotInitialized={$:0};W.ClientUnderstand={$:2};W.ClientReady={$:1};W.ClientNotInitialzed={$:0};X=U.Interpreter=bg.Class({get_Options:function(){return(this.get_Unwrap())[2];},get_Text:function(){return(this.get_Unwrap())[1];},get_Voice:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1[0],this.$1[1]];}},null,X);Y=U.CUI=bg.Class({SayVoices:function(){var bK,bL,bM;bK=this;bL=a.speechSynthesis.getVoices();!(bL==null)?(bM=d.toArray(bL),bK.Say((function(bN){return function(bO){return bN("There are currently "+a.String(bO)+" voices installed on this computer or device.");};}(a.id))(bd.length(bM))),bd.iteri(function(bN,bO){return bK.Say(((((bg.Curried(function(bP,bQ,bR,bS){return bP("Voice "+a.String(bQ)+". Name: "+bn.toSafe(bR)+", Local: "+bn.prettyPrint(bS)+".");},4))(a.id))(bN))(bO.name))(bO.localService));},bM)):void 0;},Wait:function(bK){this.Wait$1(function(){bu.Start(bK,null);});},Wait$1:function(bK){this["Echo'"]("please wait...");this.Term.pause();bK();this.Term.resume();},sayRandom:function(bK,bL){this.Say(E.getRandomPhrase(bK,bL));},SayAngry:function(bK){var bL,bM;bL=this;bu.Start((bM=null,bu.Delay(function(){return bu.Combine(a.speechSynthesis.speaking?(a.speechSynthesis.cancel(),bD.chime(),bu.Zero()):bu.Zero(),bu.Delay(function(){a.addMessage(bL.Avatar,bK,"","");bL.Avatar.processMessages(0);return bu.Zero();}));})),null);},SayDoc:function(bK){var bL,bM,bN;bL=bd.get(bp(".terminal-output").get(),0).childNodes.length;bM=bj.Element("div",[d.cls("terminal-command"),d.dindex(bL+1)],[bK]);bN=d.terminalOutput();bm.LoadLocalTemplates("");bj.RunAppend(bN,bM);},Say:function(bK){var bL,bM;bL=this;bu.Start((bM=null,bu.Delay(function(){return bu.Combine(a.speechSynthesis.speaking?(bD.chime(),bu.Zero()):bu.Zero(),bu.Delay(function(){bL.Avatar.addMessage(bK);bL.Avatar.processMessages(0);return bu.Zero();}));})),null);},Debug:function(bK,bL){d.debug(bK,bL);},"EchoHtml'":function(bK){var bL,bM;bL=(bM={},bM.raw=true,bM);this.Term.disable();this.Term.echo(bK,bL);this.Term.enable();},"Echo'":function(bK){this.Term.disable();this.Term.echo(bK);this.Term.enable();}},null,Y);Y.New=function(bK,bL,bM,bN,bO,bP,bQ){return new Y({Voice:bK,Mic:bL,Term:bM,Avatar:bN,Caption:bO,AudioHandlers:bP,TypingDNA:bQ});};Z=c.Dialogue=bg.Class({get_Utterances:function(){return this.$4;},get_Output:function(){return this.$3;},get_DialogueQuestions:function(){return this.$2;},get_Props:function(){return this.$1;},get_Cui:function(){return this.$0;}},null,Z);_0=c.Question=bg.Class({toString:function(){return((((bg.Curried(function(bK,bL,bM,bN){return bK("Name: "+bn.toSafe(bL)+" Module: "+bn.toSafe(bM)+" Type: "+ba.p$8(bN)+" ");},4))(a.id))(this.get_Name()))(this.get_Module()))(this.get_Type());},get_Target:function(){return this.$4;},get_Params:function(){return this.$3;},get_Type:function(){return this.$2;},get_Module:function(){return this.$1;},get_Name:function(){return this.$0;}},null,_0);_1.ConceptCompletion={$:3};_1.Disjunctive={$:2};_1.Verification={$:1};_2["Response'_"]=function(bK,bL,bM){var bN,bO,bP,bQ,bR,bS,bT,bU;return(bO=_2.PropNotSet_(bK,"user",bM),bO!=null&&bO.$==1?(bP=_2.Form(bK,bL,bO.$0),bP!=null&&bP.$==1?(bN=bP.$0,true):(bQ=_2.PropNotSet_(bK,"user",bM),bQ!=null&&bQ.$==1&&(bR=_2.NotForm(bK,bL,bQ.$0),bR!=null&&bR.$==1&&(bN=bR.$0,true)))):(bS=_2.PropNotSet_(bK,"user",bM),bS!=null&&bS.$==1&&(bT=_2.NotForm(bK,bL,bS.$0),bT!=null&&bT.$==1&&(bN=bT.$0,true))))?(bU=_2.have(bK,bL)?{$:1,$0:_2.prop(bK,bL)}:null,bN.get_Text()!==""?{$:1,$0:[bN,{$:1,$0:bN.get_Text()},bU]}:{$:1,$0:[bN,null,bU]}):null;};_2.Response_=function(bK,bL,bM){var bN,bO,bP,bQ,bR,bS,bT,bU;return(bO=_2.PropSet_(bK,"user",bM),bO!=null&&bO.$==1?(bP=_2.Form(bK,bL,bO.$0),bP!=null&&bP.$==1?(bN=bP.$0,true):(bQ=_2.PropSet_(bK,"user",bM),bQ!=null&&bQ.$==1&&(bR=_2.NotForm(bK,bL,bQ.$0),bR!=null&&bR.$==1&&(bN=bR.$0,true)))):(bS=_2.PropSet_(bK,"user",bM),bS!=null&&bS.$==1&&(bT=_2.NotForm(bK,bL,bS.$0),bT!=null&&bT.$==1&&(bN=bT.$0,true))))?(bU=_2.have(bK,bL)?{$:1,$0:_2.prop(bK,bL)}:null,bN.get_Text()!==""?{$:1,$0:[bN,{$:1,$0:bN.get_Text()},bU]}:{$:1,$0:[bN,null,bU]}):null;};_2.NotForm=function(bK,bL,bM){return bK.get_DialogueQuestions().length>0&&(bK.get_DialogueQuestions())[0].get_Name()===bL&&bM.get_Text()!==""?{$:1,$0:bM}:null;};_2.Form=function(bK,bL,bM){return bK.get_DialogueQuestions().length>0&&(bK.get_DialogueQuestions())[0].get_Name()===bL&&bM.get_Intent()!=null&&bM.get_Intent().$0.get_Name()===bL&&bE.Equals(bM.get_Intent().$0.get_Confidence(),{$:1,$0:1})&&bE.Equals(bM.get_Traits(),null)&&bE.Equals(bM.get_Entities(),null)?{$:1,$0:bM}:null;};_2["User'_"]=function(bK,bL){var bM,bN;return(bN=_2.PropNotSet_(bK,"user",bL),bN!=null&&bN.$==1&&(bK.get_DialogueQuestions().length===0&&(bM=bN.$0,true)))?{$:1,$0:bM}:null;};_2.User_=function(bK,bL){var bM,bN;return(bN=_2.PropSet_(bK,"user",bL),bN!=null&&bN.$==1&&(bK.get_DialogueQuestions().length===0&&(bM=bN.$0,true)))?{$:1,$0:bM}:null;};_2.PropNotSet_=function(bK,bL,bM){return!_2.have(bK,bL)?{$:1,$0:bM}:null;};_2.PropSet_=function(bK,bL,bM){return _2.have(bK,bL)?{$:1,$0:bM}:null;};_2.Agenda_=function(bK,bL,bM,bN){return bK.get_DialogueQuestions().length>0&&(bK.get_DialogueQuestions())[0].get_Module()===bM?{$:1,$0:null}:null;};_2.debugInterpreterEnd=function(bK,bL,bM){bL(((((bg.Curried(function(bN,bO,bP,bQ){return bN(bn.toSafe(bO)+" ending utterances:"+bn.prettyPrint(bP)+", questions: "+bn.prettyPrint(bQ)+".");},4))(a.id))(bM))(bK.get_Utterances()))(bK.get_DialogueQuestions()));};_2.debugInterpreterStart=function(bK,bL,bM){bL(((((bg.Curried(function(bN,bO,bP,bQ){return bN(bn.toSafe(bO)+" starting utterances:"+bn.prettyPrint(bP)+", questions: "+bn.prettyPrint(bQ)+".");},4))(a.id))(bM))(bK.get_Utterances()))(bK.get_DialogueQuestions()));};_2.frame=function(bK){return br.ofSeq(bs.take(bK.length>=5?5:bK.length,bK));};_2.didNotUnderstand=function(bK,bL,bM){bL((function(bN){return function(bO){return bN(bn.toSafe(bO)+" interpreter did not understand utterance.");};}(a.id))(bM));_2.popu(bK,bL);_2.say(bK,"Sorry I didn't understand what you meant.");};_2.endt=function(bK,bL,bM,bN){_2.popu(bK,bL);_2.popq(bK,bL);_2.have(bK,bM)?_2.remove(bK,bL,bM):void 0;bL((function(bO){return function(bP){return bO("End turn "+bn.toSafe(bP)+".");};}(a.id))(bM));bN();};_2.cancel=function(bK,bL,bM){var bN;bN=(bK.get_DialogueQuestions())[0];bN.get_Name()!==bM?(((bg.Curried3(function(bO,bP,bQ){return bO(ba.p$9(bP)+" at the top of the stack does not have the name "+bn.toSafe(bQ)+".");}))(bh.FailWith))(bN))(bM):void 0;_2.popq(bK,bL);bL((function(bO){return function(bP){return bO("Cancel "+ba.p$9(bP)+".");};}(a.id))(bN));};_2.trigger=function(bK,bL,bM,bN,bO){_2.pushu(bK,bL,new K({$:0,$0:bv.stringify(bO),$1:{$:1,$0:new H({$:0,$0:bN,$1:{$:1,$0:1}})},$2:null,$3:null}));bM(bK);};_2.handle=function(bK,bL,bM,bN){_2.popu(bK,bL);bL((function(bO){return function(bP){return bO("Handle utterance "+bn.toSafe(bP)+".");};}(a.id))(bM));bN();};_2.dispatch=function(bK,bL,bM,bN){bL(((((bg.Curried(function(bO,bP,bQ,bR){return bO("Dispatch to module "+bn.toSafe(bP)+" utterances: "+bn.prettyPrint(bQ)+" questions: "+bn.prettyPrint(bR)+".");},4))(a.id))(bM))(bK.get_Utterances()))(bK.get_DialogueQuestions()));bN(bK);};_2.popq=function(bK,bL){var bM;bM=bK.get_DialogueQuestions().shift();bL((function(bN){return function(bO){return bN("Pop "+ba.p$9(bO)+".");};}(a.id))(bM));};_2.pushq=function(bK,bL,bM){bK.get_DialogueQuestions().unshift(bM);bL((function(bN){return function(bO){return bN("Push "+ba.p$9(bO)+".");};}(a.id))(bM));};_2.popu=function(bK,bL){var bM;bM=bK.get_Utterances().shift();bL((function(bN){return function(bO){return bN("Pop "+ba.p$7(bO)+".");};}(a.id))(bM));};_2.pushu=function(bK,bL,bM){bL((function(bN){return function(bO){return bN("Push "+ba.p$7(bO)+".");};}(a.id))(bM));bK.get_Utterances().unshift(bM);};_2.remove=function(bK,bL,bM){bL((function(bN){return function(bO){return bN("Remove property "+bn.toSafe(bO)+".");};}(a.id))(bM));bK.get_Props().Remove(bM);};_2.add=function(bK,bL,bM,bN){bK.get_Props().Add(bM,bN);bL((((bg.Curried3(function(bO,bP,bQ){return bO("Add property "+bn.toSafe(bP)+":"+bn.prettyPrint(bQ)+".");}))(a.id))(bM))(bN));};_2.prop=function(bK,bL){return bK.get_Props().ContainsKey(bL)?bK.get_Props().get_Item(bL):(function(bM){return function(bN){return bM("The "+bn.toSafe(bN)+" dialogue property does not exist.");};}(bh.FailWith))(bL);};_2.have=function(bK,bL){return bK.get_Props().ContainsKey(bL);};_2["sayRandom'"]=function(bK,bL){_2.sayRandom(bK,bL,"");};_2.sayRandom=function(bK,bL,bM){var bN;bN=E.getRandomPhrase(bL,bM);bK.get_Output().unshift(bN);bK.get_Cui().Say(bN);};_2.say=function(bK,bL){bK.get_Output().unshift(bL);_2["say'"](bK,bL);};_2["say'"]=function(bK,bL){bK.get_Cui().Say(bL);};_2.echo=function(bK,bL){(bK.get_Cui())["EchoHtml'"](bL);};_3.ask=function(bK,bL,bM){var bN,bO,bP,bQ;function bR(bW){_2.say(bK,bW);}function bS(bW){bW.input="text";bW.showCancelButton=true;bW.confirmButtonText="Ok";}function bT(bW){bW.confirmButtonClass="invisible";bW.showCancelButton=true;}function bU(){var bW;bW=d.createDialogueBoxCanvas();d.startCamera(self.document.body,bW);}function bV(bW){var bX,bY;bX=bW[0];bY=bW[1];d.questionBox("Biometric Authentication","",{$:1,$0:d.boxesWithTitles(["2","3"])},{$:1,$0:[640,480]},{$:1,$0:bS},{$:1,$0:bU},function(bZ){var b0,b1,b2,b3;bZ.isConfirmed?(b0=bK.get_Cui().TypingDNA.getTypingPattern((b1={},b1.type=1,b1.text=bQ,b1.caseSensitive=false,b1)),b2=bZ.value,b3=d.getCameraCanvas().toDataURL(),bL((function(b4){return function(b5){return b4("User image is "+bn.toSafe(b5)+"...");};}(a.id))(bq.Substring(b3,0,10))),d.stopCamera(),bL((((bg.Curried3(function(b4,b5,b6){return b4("User entered typing pattern "+bn.toSafe(b5)+" for text "+bn.toSafe(b6));}))(a.id))(b0))(b2)),b2.toLowerCase()!==bQ.toLowerCase()?(bR("Sorry you did not enter the passphrase correctly. Please try again."),bV([bX,bY])):d.questionBox("Biometric Authentication","",null,null,{$:1,$0:bT},{$:1,$0:function(){d.getDialogueBoxContent().appendChild(d.getMic());bK.get_Cui().AudioHandlers.Add("VoiceAuthentication",function(b4){bv.stringify(((bC.Id())())(b4));d.confirmQuestionBox();});}},function(b4){if(!b4.isConfirmed){bK.get_Cui().AudioHandlers.Remove("VoiceAuthentication");bR("OK but you must login for me to help you.");}})):bR("OK but you must login for me to help you.");});}_2.pushq(bK,bL,bM);bN=bM.get_Type();bN.$==0?(bO=bM.get_Target(),bP=bM.get_Name(),bQ=(function(bW){return function(bX){return bW("Hello my name is "+bn.toSafe(bX)+" and I am an administrator");};}(a.id))(bN.$0),bR((function(bW){return function(bX){return bW("Enter the phrase "+bn.toSafe(bX)+".");};}(a.id))(bQ)),bV([0,[]])):bh.FailWith("Not implemented");};_4.update=function(bK){var bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl;function cm(cx){_2.say(bK,cx);}function cn(cx,cy){return _2.sayRandom(bK,cx,cy);}function co(cx,cy){return _2.add(bK,function(cz){_4.debug(cz);},cx,cy);}function cp(cx){_4.debug(cx);}function cq(cx){_4.debug(cx);}function cr(cx){_4.debug(cx);}function cs(cx){return _2["User'_"](bK,cx);}function ct(cx,cy){return _2.Response_(bK,cx,cy);}function cu(cx,cy){return _2["Response'_"](bK,cx,cy);}function cv(cx){var cy;cn(E.waitRetrievePhrases(),"user name");bu.Start((cy=null,bu.Delay(function(){return bu.Bind((new bG.New()).Async("SMApp.Web:SMApp.Web.Server.getUser:1355099892",[cx]),function(cz){var cA;return cz==null?(cm((function(cB){return function(cC){return cB("I did not find a user with the name "+bn.toSafe(cC)+".");};}(a.id))(cx)),bN(new _0({$:0,$0:"addUser",$1:_4.name(),$2:_1.Verification,$3:null,$4:function(){co("addUser",cx);cm((function(cB){return function(cC){return cB("Do you want me to add the user "+bn.toSafe(cC)+"?");};}(a.id))(cx));}})),bu.Zero()):(cA=cz.$0,bu.Bind((new bG.New()).Async("SMApp.Web:SMApp.Web.Server.updateUserLastLogin:134107504",[cA.Name]),function(){cn(E.helloUserPhrases(),(function(cB){return function(cC){return cB(bn.prettyPrint(cC));};}(a.id))(cA.Name));return cA.LastLoggedIn!=null?bu.Bind((new bG.New()).Async("SMApp.Web:SMApp.Web.Server.humanize:-1821636148",[cA.LastLoggedIn.$0]),function(cB){cm((function(cC){return function(cD){return cC("You last logged in "+bn.toSafe(cD)+".");};}(a.id))(cB));bN(new _0({$:0,$0:"authenticateUser",$1:_4.name(),$2:{$:0,$0:cx},$3:null,$4:function(cC){_4.update(cC);}}));return bu.Zero();}):bu.Zero();}));});})),null);}function cw(cx){return new _0({$:0,$0:"switchUser",$1:_4.name(),$2:_1.Verification,$3:null,$4:function(){cm((function(cy){return function(cz){return cy("Do you want me to switch to the user "+bn.toSafe(cz));};}(a.id))(cx));}});}_2.debugInterpreterStart(bK,function(cx){_4.debug(cx);},_4.name());bL=bg.Curried(_2.handle,2,[bK,cp]);bM=bg.Curried(_2.endt,2,[bK,cq]);bN=function(cx){_3.ask(bK,cr,cx);};bO=_2.frame(bK.$4);bO.$==1&&(bQ=cs(bO.$0),bQ!=null&&bQ.$==1&&(bR=G.Intent$1("greet",bQ.$0),bR!=null&&bR.$==1&&(bS=G.Entity1Of1("name",bR.$0[1]),bS!=null&&bS.$==1&&(bO.$1.$==0&&(bP=bS.$0,true)))))?(bL("loginUser"))(function(){cv(bP.get_Value());}):bO.$==1&&(bU=cs(bO.$0),bU!=null&&bU.$==1&&(bV=G.Intent$1("hello",bU.$0),bV!=null&&bV.$==1&&(bW=G.Entity1Of1("contact",bV.$0[1]),bW!=null&&bW.$==1&&(bO.$1.$==0&&(bT=bW.$0,true)))))?(bL("loginUser"))(function(){cv(bT.get_Value());}):bO.$==1&&(bY=cu("authenticateUser",bO.$0),bY!=null&&bY.$==1&&(bZ=G.StrA(bY.$0[1]),bZ!=null&&bZ.$==1&&(bO.$1.$==0&&(bX=bZ.$0,true))))?(bM("authenticateUser"))(function(){var cx;_4.debug(bX);bu.Start((cx=null,bu.Delay(function(){return bu.Bind((new bG.New()).Async("SMApp.Web:SMApp.Web.Server.hasFace:357222155",[bd.get(bX,2)]),function(cy){return cy?(cm("Face detected"),bu.Zero()):(cm(function(cz){return cz("Sorry I did not detect a face in the camera image. Make sure you can see the red square around your face in the camera window when you click the OK button.");}(a.id)),bu.Zero());});})),null);}):bO.$==1&&(b1=G.No(bO.$0),b1!=null&&b1.$==1&&(b2=cu("addUser",b1.$0),b2!=null&&b2.$==1&&(b3=G.PStr(b2.$0[2]),b3!=null&&b3.$==1&&(bO.$1.$==0&&(b0=b3.$0,true)))))?(bM("addUser"))(function(){cm((function(cx){return function(cy){return cx("Ok I did not add the user "+bn.toSafe(cy)+". But you must login for me to help you.");};}(a.id))(b0));}):bO.$==1&&(b5=G.Yes(bO.$0),b5!=null&&b5.$==1&&(b6=cu("addUser",b5.$0),b6!=null&&b6.$==1&&(b7=G.PStr(b6.$0[2]),b7!=null&&b7.$==1&&(bO.$1.$==0&&(b4=b7.$0,true)))))?(bM("addUser"))(function(){bN(new _0({$:0,$0:"authenticateNewUser1",$1:_4.name(),$2:{$:0,$0:b4},$3:null,$4:function(cx){_4.update(cx);}}));}):bO.$==1&&(b9=cu("authenticateNewUser1",bO.$0),b9!=null&&b9.$==1&&(b_=G.StrA(b9.$0[1]),b_!=null&&b_.$==1&&(bO.$1.$==0&&(b8=b_.$0,true))))?(bM("authenticateNewUser1"))(function(){cm((function(cx){return function(cy){return cx("Authenticate new user "+bn.toSafe(cy)+".");};}(a.id))(bd.get(b8,0)));}):bO.$==1&&(ca=_2.User_(bK,bO.$0),ca!=null&&ca.$==1&&(cb=G.Intent$1("hello",ca.$0),cb!=null&&cb.$==1&&(cb.$0[0]==null&&(cc=G.Entity1Of1("name",cb.$0[1]),cc!=null&&cc.$==1&&(bO.$1.$==0&&(b$=cc.$0,true))))))?bu.Start((cd=null,bu.Delay(function(){return bu.Bind((new bG.New()).Async("SMApp.Web:SMApp.Web.Server.getUser:1355099892",[b$.get_Value()]),function(cx){return cx==null?(cm((function(cy){return function(cz){return cy("Sorry, the user "+bn.toSafe(cz)+" does not exist.");};}(a.id))(b$.get_Value())),bu.Zero()):(bN(cw(cx.$0.Name)),bu.Zero());});})),null):bO.$==1&&(cf=G.Yes(bO.$0),cf!=null&&cf.$==1&&(cg=ct("switchUser",cf.$0),cg!=null&&cg.$==1&&(ch=G.PStr(cg.$0[2]),ch!=null&&ch.$==1&&(bO.$1.$==0&&(ce=ch.$0,true)))))?(bK.$1.set_Item("user",ce),cm((function(cx){return function(cy){return cx("Ok I switched to user "+bn.prettyPrint(cy)+".");};}(a.id))(ce))):bO.$==1&&(cj=G.No(bO.$0),cj!=null&&cj.$==1&&(ck=ct("switchUser",cj.$0),ck!=null&&ck.$==1&&(cl=G.PStr(ck.$0[2]),cl!=null&&cl.$==1&&(bO.$1.$==0&&(ci=cl.$0,true)))))?cm((function(cx){return function(cy){return cx("Ok I did not switch to user "+bn.toSafe(cy)+".");};}(a.id))(ci)):_2.didNotUnderstand(bK,function(cx){_4.debug(cx);},_4.name());_2.debugInterpreterEnd(bK,function(cx){_4.debug(cx);},_4.name());};_4.debug=function(bK){d.debug(_4.name(),bK);};_4.name=function(){_5.$cctor();return _5.name;};_5.$cctor=function(){_5.$cctor=a.ignore;_5.name="User";};_6.update=function(bK){var bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1;function b2(b9){_2.echo(bK,b9);}function b3(b9){_2.say(bK,b9);}function b4(b9,b_){return _2.sayRandom(bK,b9,b_);}function b5(b9){return _2.prop(bK,b9);}function b6(b9){return _2.User_(bK,b9);}function b7(){return b5("user");}function b8(b9,b_,b$){var ca;return bu.Start((ca=null,bu.Delay(function(){b4(E.waitAddPhrases(),"symptom entry");return bu.Bind((new bG.New()).Async("SMApp.Web:SMApp.Web.Server.addSymptomJournalEntry:184599257",[b7().Name,b9,b_,b$]),function(cb){return cb.$==1?(b3(function(cc){return cc("Sorry I wasn't able to add that symptom to your journal. Could you try again?");}(a.id)),bu.Zero()):(b3((function(cc){return function(cd){return cc("OK I added that "+bn.toSafe(cd)+" symptom to your journal.");};}(a.id))(b9)),bu.Zero());});})),null);}_2.debugInterpreterStart(bK,function(b9){_6.debug(b9);},_6.name());bL=_2.frame(bK.$4);bL.$==1&&(bN=b6(bL.$0),bN!=null&&bN.$==1&&(bO=G.Intent$1("symptom",bN.$0),bO!=null&&bO.$==1&&(bP=G.Entity1OfAny("symptom_name",bO.$0[1]),bP!=null&&bP.$==1&&(bL.$1.$==0&&(bM=bP.$0,true)))))?bu.Start((bQ=null,bu.Delay(function(){b3("Ok I'll add that entry to your symptom journal");b8(bM.get_Value(),null,null);return bu.Zero();})),null):bL.$==1&&(bS=G.Yes(bL.$0),bS!=null&&bS.$==1&&((bT=_2.Response_(bK,"painVideo",bS.$0),bT!=null&&bT.$==1)&&bL.$1.$==0))?bK.$0["EchoHtml'"]("<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/SkAqOditKN0\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>"):bL.$==1&&(bV=b6(bL.$0),bV!=null&&bV.$==1&&(bW=G.Intent$1("medjournal",bV.$0),bW!=null&&bW.$==1&&((bX=bW.$0[1],bX!=null&&bX.$==1)&&(bL.$1.$==0&&(bU=bW.$0[1].$0,true)))))?(b3("ok I added that entry to your medication journal."),b3("You should be careful not to take too many painkillers over a short period of time.")):bL.$==1&&(bZ=b6(bL.$0),bZ!=null&&bZ.$==1&&((b0=G.Intent$1("kbquery",bZ.$0),b0!=null&&b0.$==1)&&(bL.$1.$==0&&(bY=bZ.$0,true))))?bu.Start((b1=null,bu.Delay(function(){return bu.Bind(z.getAnswer(bY.get_Text()),function(b9){var b_;return bu.Bind((b_=bd.get(b9.answers,0).answer,(new bG.New()).Async("SMApp.Web:SMApp.Web.Server.mdtohtml:-2095920726",[b_])),function(b$){var ca;return bu.Bind((ca=bd.get(b9.answers,0).answer,(new bG.New()).Async("SMApp.Web:SMApp.Web.Server.mdtotext:-2095920726",[ca])),function(cb){b2(b$);b3(cb);return bu.Zero();});});});})),null):_2.didNotUnderstand(bK,function(b9){_6.debug(b9);},_6.name());_2.debugInterpreterEnd(bK,function(b9){_6.debug(b9);},_6.name());};_6.debug=function(bK){d.debug(_6.name(),bK);};_6.name=function(){_7.$cctor();return _7.name;};_7.$cctor=function(){_7.$cctor=a.ignore;_7.name="Symptoms";};_8.update=function(bK){var bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5;function b6(b$){_2.say(bK,b$);}function b7(b$){_2["sayRandom'"](bK,b$);}function b8(b$){_8.debug(b$);}function b9(b$){_8.debug(b$);}function b_(b$){return _2["User'_"](bK,b$);}bL=bK.$4;_8.debug(((((bg.Curried(function(b$,ca,cb,cc){return b$("Module "+bn.toSafe(ca)+" starting utterances:"+bn.prettyPrint(cb)+", questions: "+bn.prettyPrint(cc)+".");},4))(a.id))(_8.name()))(bL))(bK.$2));bM=bg.Curried(_2.dispatch,2,[bK,b8]);bN=bg.Curried(_2.handle,2,[bK,b9]);bO=_2.frame(bL);bP=_2.Agenda_(bK,function(b$){_8.debug(b$);},_4.name(),bO);bP!=null&&bP.$==1?(_8.debug((function(b$){return function(ca){return b$("Agenda is "+ba.p$9(ca)+".");};}(a.id))((bK.get_DialogueQuestions())[0])),_4.update(bK)):bO.$==1&&(bR=(bS=_2.PropNotSet_(bK,"started",bO.$0),bS!=null&&bS.$==1?{$:1,$0:bS.$0}:null),bR!=null&&bR.$==1&&(bT=b_(bR.$0),bT!=null&&bT.$==1&&(bU=G.Intent$1("greet",bT.$0),bU!=null&&bU.$==1&&(bU.$0[1]==null&&bO.$1.$==0))))?(_2.add(bK,function(b$){_8.debug(b$);},"started",true),(bN("greet"))(function(){b7(E.helloPhrases());})):bO.$==1&&(bW=b_(bO.$0),bW!=null&&bW.$==1&&(bX=G.Intent$1("greet",bW.$0),bX!=null&&bX.$==1&&(bX.$0[1]==null&&bO.$1.$==0)))?(bN("greet"))(function(){b6("Hello, tell me your name to get started.");}):bO.$==1&&(bZ=b_(bO.$0),bZ!=null&&bZ.$==1&&(b0=G.Intent$1("greet",bZ.$0),b0!=null&&b0.$==1&&((b1=G.Entity1Of1("name",b0.$0[1]),b1!=null&&b1.$==1)&&bO.$1.$==0)))?(bM(_4.name()))(function(b$){_4.update(b$);}):bO.$==1&&(b3=b_(bO.$0),b3!=null&&b3.$==1&&(b4=G.Intent$1("hello",b3.$0),b4!=null&&b4.$==1&&((b5=G.Entity1Of1("contact",b4.$0[1]),b5!=null&&b5.$==1)&&bO.$1.$==0)))?(bM(_4.name()))(function(b$){_4.update(b$);}):_2.didNotUnderstand(bK,function(b$){_8.debug(b$);},_8.name());_2.debugInterpreterEnd(bK,function(b$){_8.debug(b$);},_8.name());};_8.debug=function(bK){d.debug(_8.name(),bK);};_8.name=function(){_9.$cctor();return _9.name;};_9.$cctor=function(){_9.$cctor=a.ignore;_9.name="Main";};_.run=function(){var bK,bL;bK=bg.ThisFunc(function(bM,bN){return((_.Main().get_Text())(bM))(bN);});bL=_.Main().get_Options();a.$("#term").terminal(bK,bL);return bj.get_Empty();};_.Main=function(){$.$cctor();return $.Main;};_.initMic=function(bK){var bL,bM;_.set_CUI((bL={$:1,$0:new bH.Microphone(bI.getElementById("microphone"))},Y.New(_.CUI().Voice,bL,_.CUI().Term,_.CUI().Avatar,_.CUI().Caption,_.CUI().AudioHandlers,_.CUI().TypingDNA)));bM=_.CUI().Mic.$0;bM.onconnecting=function(){_.set_MicState(V.MicConnecting);return _.debug("Mic connecting...");};bM.ondisconnected=function(){_.set_MicState(V.MicDisconnected);return _.debug("Mic disconnected.");};bM.onaudiostart=function(){_.set_MicState(V.MicAudioStart);return _.debug("Mic audio start...");};bM.onaudioend=function(){var bN,bO,bP,bQ;_.debug("Mic audio end.");bO=_.CUI().AudioHandlers;bN=bO.GetEnumerator$1();try{while(bN.MoveNext()){bP=bN.Current();_.debug((function(bR){return function(bS){return bR("Executing audio handler "+bn.toSafe(bS)+".");};}(a.id))(bP.K));_.set_MicState({$:7,$0:bP.K});bQ=bP.V;_.CUI().AudioHandlers.Remove(bP.K);bQ(d.lastMicData());}return;}finally{bN.Dispose();}};bM.onerror=function(bN){_.set_MicState({$:6,$0:bN});return _.debug((function(bO){return function(bP){return bO("Mic error : "+bn.toSafe(bP)+".");};}(a.id))(bN));};bM.onready=function(){_.set_MicState(V.MicReady);return _.debug("Mic ready.");};bM.onresult=function(bN,bO){return _.ClientState().$==2?_.echo("I'm still trying to understand what you said before."):_.ClientState().$==0?d.error("Client is not intialized."):_.MicState().$==7?null:!(bN==null||bO==null)?(_.set_MicState({$:8,$0:bN,$1:bO}),_.debug((((bg.Curried3(function(bP,bQ,bR){return bP("Mic result: "+bn.prettyPrint(bQ)+" "+bn.prettyPrint(bR)+".");}))(a.id))(bN))(bO)),bK(bN,bO)):_.debug("Mic: No result returned.");};bM.connect("4Y2BLQY5TWLIN7HFIV264S53MY4PCUAT");};_.sayRandom=function(bK,bL){_.say(E.getRandomPhrase(bL,bK));};_.say=function(bK){_.Output().unshift(bK);_["say'"](bK);};_["say'"]=function(bK){_.CUI().Say(bK);};_.initSpeech=function(){var bK;bK=d.toArray(_.synth().getVoices());bd.length(bK)>0?(bd.iter(function(bL){if(bE.Equals(_.CUI().Voice,null)&&(bL.name.indexOf("Microsoft Zira")!=-1||bL.name.toLowerCase().indexOf("female")!=-1)){_.set_CUI(Y.New({$:1,$0:bL},_.CUI().Mic,_.CUI().Term,_.CUI().Avatar,_.CUI().Caption,_.CUI().AudioHandlers,_.CUI().TypingDNA));_.debug((function(bM){return function(bN){return bM("Using browser speech synthesis voice "+bn.toSafe(bN)+".");};}(a.id))(_.CUI().Voice.$0.name));}},bK),!bE.Equals(_.CUI().Voice,null)?(_.CUI().Avatar.nativeVoice=true,_.CUI().Avatar.nativeVoiceName=_.CUI().Voice.$0.name,_.debug((function(bL){return function(bM){return bL("Using browser speech synthesis voice "+bn.toSafe(bM)+".");};}(a.id))(_.CUI().Voice.$0.name))):void 0):void 0;bE.Equals(_.CUI().Voice,null)?_.debug("No female browser speech synthesis voice is available. Using CMU SLT Female voice via TTS."):void 0;};_.synth=function(){$.$cctor();return $.synth;};_.push=function(bK){_.Utterances().unshift(bK);return _.Dialogue();};_.Dialogue=function(){$.$cctor();return $.Dialogue;};_.Utterances=function(){$.$cctor();return $.Utterances;};_.Questions=function(){$.$cctor();return $.Questions;};_.Output=function(){$.$cctor();return $.Output;};_.Props=function(){$.$cctor();return $.Props;};_.wait=function(bK){d["Terminal.Echo'"](_.CUI().Term,"please wait");_.CUI().Term.pause();bK();_.CUI().Term.resume();};_.debug=function(bK){d.debug("CLIENT",bK);};_.echo=function(bK){d["Terminal.EchoHtml'"](_.CUI().Term,(function(bL){return function(bM){return bL(bn.prettyPrint(bM));};}(a.id))(bK));};_.ClientState=function(){$.$cctor();return $.ClientState;};_.set_ClientState=function(bK){$.$cctor();$.ClientState=bK;};_.MicState=function(){$.$cctor();return $.MicState;};_.set_MicState=function(bK){$.$cctor();$.MicState=bK;};_.CUI=function(){$.$cctor();return $.CUI;};_.set_CUI=function(bK){$.$cctor();$.CUI=bK;};$.$cctor=function(){var bK,bL,bM;$.$cctor=a.ignore;function bN(bP,bQ){var bR,bS,bT,bU,bV,bW,bX;_.debug((((bg.Curried3(function(bY,bZ,b0){return bY("Voice: "+bn.prettyPrint(bZ)+" "+bn.prettyPrint(b0));}))(a.id))(bP))(bQ));bR=(bS=L["Intent'"](bP,bQ),bS!=null&&bS.$==1?{$:1,$0:bS.$0}:null);bT=(bU=L["Trait'"](bQ),bU!=null&&bU.$==1?{$:1,$0:br.ofArray([bU.$0])}:null);bV=(bW=L["Entity'$1"](bQ),bW!=null&&bW.$==1?{$:1,$0:br.ofArray([bW.$0])}:null);bR==null&&(bT==null&&bV==null)?void 0:(_.debug(((((bg.Curried(function(bY,bZ,b0,b1){return bY("Voice: "+ba.p(bZ)+" "+ba.p$3(b0)+" "+ba.p$5(b1));},4))(a.id))(bR))(bT))(bV)),_8.update(_.push(new K({$:0,$0:"",$1:bR,$2:bT,$3:bV}))));}function bO(bP,bQ){var bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6;_.set_CUI(Y.New(_.CUI().Voice,_.CUI().Mic,bP,_.CUI().Avatar,_.CUI().Caption,_.CUI().AudioHandlers,_.CUI().TypingDNA));if(bE.Equals(_.CUI().Mic,null))_.initMic(bN);if(bE.Equals(_.CUI().Voice,null))_.initSpeech();if(_.ClientState().$===0)_.set_ClientState(W.ClientReady);b4=N.Blank(bQ);if(b4!=null&&b4.$==1)return _["say'"]("Tell me what you want me to do or ask me a question.");else{b5=N.Debug(bQ);if(b5!=null&&b5.$==1){_.debug((function(b7){return function(b8){return b7("Utterances: "+bn.prettyPrint(b8));};}(a.id))(_.Utterances()));_.debug((function(b7){return function(b8){return b7("Questions: "+bn.prettyPrint(b8));};}(a.id))(_.Questions()));bR=_.Props().GetEnumerator$1();try{while(bR.MoveNext()){b6=bR.Current();_.debug((((bg.Curried3(function(b7,b8,b9){return b7(bn.toSafe(b8)+": "+bn.prettyPrint(b9));}))(a.id))(b6.K))(b6.V));}}finally{bR.Dispose();}(e.get_QueueBoxes())([(bS={},bS.titleText="1",bS),(bT={},bT.titleText="2",bT),(bU={},bU.titleText="3",bU)]);return;}else{bV=N.Voices(bQ);return bV!=null&&bV.$==1?(bW=d.toArray(d.speechSynthesis().getVoices()),_["say'"]((function(b7){return function(b8){return b7("There are currently "+a.String(b8)+" voices installed on this computer or device.");};}(a.id))(bd.length(bW))),bd.iteri(function(b7,b8){return _["say'"](((((bg.Curried(function(b9,b_,b$,ca){return b9("Voice "+a.String(b_)+". Name: "+bn.toSafe(b$)+", Local: "+bn.prettyPrint(ca)+".");},4))(a.id))(b7))(b8.name))(b8.localService));},bW)):_.ClientState().$==1?(bY=N.QuickHello(bQ),(bY!=null&&bY.$==1?(bX=bY.$0,true):(bZ=N.QuickHelp(bQ),bZ!=null&&bZ.$==1?(bX=bZ.$0,true):(b0=N.QuickYes(bQ),b0!=null&&b0.$==1?(bX=b0.$0,true):(b1=N.QuickNo(bQ),b1!=null&&b1.$==1?(bX=b1.$0,true):(b2=N.QuickNumber(bQ),b2!=null&&b2.$==1&&(bX=b2.$0,true))))))?(_.debug((function(b7){return function(b8){return b7("Quick Text: "+ba.p$7(b8)+".");};}(a.id))(bX)),_8.update(_.push(bX)),_.set_ClientState(W.ClientReady)):_.CUI().Wait((b3=null,bu.Delay(function(){_.set_ClientState(W.ClientUnderstand);N.getUtterance(bQ,function(b7){var b8,b9;b8=N.HasUtterance(b7);b8!=null&&b8.$==1?(b9=b8.$0,_.debug(((((bg.Curried(function(b_,b$,ca,cb){return b_("Text: Intent: "+ba.p(b$)+", Traits: "+ba.p$3(ca)+", Entities: "+ba.p$5(cb)+".");},4))(a.id))(b9.get_Intent()))(b9.get_Traits()))(b9.get_Entities())),_8.update(_.push(b9))):(_.debug("Text: Did not receive a meaning from the server."),_["say'"]("Sorry I did not understand what you said."));});_.set_ClientState(W.ClientReady);return bu.Zero();})))):_.ClientState().$==0?d.error("Client is not initialized."):_["say'"]("I'm still trying to understand what you said before.");}}}$.CUI=Y.New(null,null,null,(bD.applicationId="4277115329081938617",bK=new a.SDKConnection(),bL=new a.WebAvatar(),bL.version=8.5,bL.connection=bK,bL.avatar="20926186",bL.voice="cmu-slt",bL.voiceMod="default",bL.width=175,bL.createBox(),bL.addMessage(""),bL.processMessages(0),bL),false,new bJ.New$5(),new a.TypingDNA());$.MicState=V.MicNotInitialized;$.ClientState=W.ClientNotInitialzed;$.Props=new bJ.New$5();$.Output=[];$.Questions=[];$.Utterances=[];$.Dialogue=new Z({$:0,$0:_.CUI(),$1:_.Props(),$2:_.Questions(),$3:_.Output(),$4:_.Utterances()});$.synth=a.speechSynthesis;$.Main=new X({$:0,$0:function(bP){return bN(bP[0],bP[1]);},$1:[function(bP){return function(bQ){return bO(bP,bQ);};},(bM={},bM.name="Main",bM.greetings="Welcome to Selma. Enter 'hello' or 'hello my name is...(you) to initialize speech.",bM.prompt=">",bM)]});};ba.p$8=function(bK){return bK.$==3?"ConceptCompletion":bK.$==2?"Disjunctive":bK.$==1?"Verification":"UserAuthentication "+bn.prettyPrint(bK.$0);};bb.p=function(bK){return"{"+("text = "+bn.prettyPrint(bK.text))+"; "+("intents = "+bn.printArray(function(bL){return bb.p$1(bL);},bK.intents))+"; "+("entities = "+bn.prettyPrint(bK.entities))+"; "+("traits = "+bn.prettyPrint(bK.traits))+"}";};bb.p$1=function(bK){return"{"+("id = "+bn.prettyPrint(bK.id))+"; "+("name = "+bn.prettyPrint(bK.name))+"; "+("confidence = "+bn.prettyPrint(bK.confidence))+"}";};ba.p$9=function(bK){return"Question ("+bn.prettyPrint(bK.$0)+", "+bn.prettyPrint(bK.$1)+", "+ba.p$8(bK.$2)+", "+ba.p$10(bK.$3)+", "+"<fun>"+")";};ba.p$10=function(bK){return bK==null?"null":"Some "+bn.printArray(bn.prettyPrint,bK.$0);};ba.p$2=function(bK){return bK==null?"null":"Some "+bn.prettyPrint(bK.$0);};ba.p$1=function(bK){return"Intent ("+bn.prettyPrint(bK.$0)+", "+ba.p$2(bK.$1)+")";};ba.p=function(bK){return bK==null?"null":"Some "+ba.p$1(bK.$0);};ba.p$4=function(bK){return"Trait ("+bn.prettyPrint(bK.$0)+", "+bn.prettyPrint(bK.$1)+", "+ba.p$2(bK.$2)+")";};ba.p$3=function(bK){return bK==null?"null":"Some "+bn.printList(function(bL){return ba.p$4(bL);},bK.$0);};ba.p$6=function(bK){return"Entity ("+bn.prettyPrint(bK.$0)+", "+bn.prettyPrint(bK.$1)+", "+bn.prettyPrint(bK.$2)+", "+ba.p$2(bK.$3)+")";};ba.p$5=function(bK){return bK==null?"null":"Some "+bn.printList(function(bL){return ba.p$6(bL);},bK.$0);};ba.p$7=function(bK){return"Utterance ("+bn.prettyPrint(bK.$0)+", "+ba.p(bK.$1)+", "+ba.p$3(bK.$2)+", "+ba.p$5(bK.$3)+")";};}());
