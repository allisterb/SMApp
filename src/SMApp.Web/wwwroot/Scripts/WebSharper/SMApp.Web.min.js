(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N;a=self;b=a.SMApp=a.SMApp||{};c=b.Bootstrap=b.Bootstrap||{};d=c.Controls=c.Controls||{};e=a.StartupCode$SMApp_Web$Bootstrap=a.StartupCode$SMApp_Web$Bootstrap||{};f=b.Web=b.Web||{};g=f.User=f.User||{};h=f.Meaning=f.Meaning||{};i=f.Intent=f.Intent||{};j=f.Entity=f.Entity||{};k=f.Interpreter=f.Interpreter||{};l=f.Resource=f.Resource||{};m=f.NLU=f.NLU||{};n=a.StartupCode$SMApp_Web$NLU=a.StartupCode$SMApp_Web$NLU||{};o=f.CUI=f.CUI||{};p=a.StartupCode$SMApp_Web$CUI=a.StartupCode$SMApp_Web$CUI||{};q=f.ClientExtensions=f.ClientExtensions||{};r=f._Html=f._Html||{};s=f._hModule=f._hModule||{};t=a.StartupCode$SMApp_Web$ClientExtensions=a.StartupCode$SMApp_Web$ClientExtensions||{};u=f.Client=f.Client||{};v=a.StartupCode$SMApp_Web$Client=a.StartupCode$SMApp_Web$Client||{};w=a.WebSharper;x=w&&w.UI;y=x&&x.Doc;z=w&&w.List;A=x&&x.AttrModule;B=a.IntelliFactory;C=B&&B.Runtime;D=w&&w.Seq;E=w&&w.Random;F=w&&w.Arrays;G=a.jQuery;H=a.console;I=w&&w.Strings;J=w&&w.Concurrency;K=w&&w.Utils;L=w&&w.Unchecked;M=w&&w.Remoting;N=M&&M.AjaxRemotingProvider;d.Radio=function(O,P,Q,R,S){return y.Element("div",new z.T({$:1,$0:(d.cls())("radio"),$1:P}),[y.Element("label",R,[y.Radio(S,true,Q),y.TextNode(O)])]);};d.Checkbox=function(O,P,Q,R,S){return y.Element("div",new z.T({$:1,$0:(d.cls())("checkbox"),$1:P}),[y.Element("label",R,[y.CheckBox(S,Q),y.TextNode(O)])]);};d.TextArea=function(O,P,Q,R,S){return y.Element("div",new z.T({$:1,$0:(d.cls())("form-group"),$1:P}),[y.Element("label",R,[y.TextNode(O)]),y.InputArea(new z.T({$:1,$0:(d.cls())("form-control"),$1:S}),Q)]);};d.InputPassword=function(O,P,Q,R,S){return y.Element("div",new z.T({$:1,$0:(d.cls())("form-group"),$1:P}),[y.Element("label",R,[y.TextNode(O)]),y.PasswordBox(new z.T({$:1,$0:(d.cls())("form-control"),$1:S}),Q)]);};d.Input=function(O,P,Q,R,S){return y.Element("div",new z.T({$:1,$0:(d.cls())("form-group"),$1:P}),[y.Element("label",R,[y.TextNode(O)]),y.Input(new z.T({$:1,$0:(d.cls())("form-control"),$1:S}),Q)]);};d.Container=function(O){return y.Element("div",[(d.cls())("container")],O);};d.Class=function(){e.$cctor();return e.Class;};d.cls=function(){e.$cctor();return e.cls;};e.$cctor=function(){e.$cctor=a.ignore;e.cls=A.Class;e.Class=A.Class;};g.New=function(O){return{UserName:O};};h=f.Meaning=C.Class({get_TopIntent:function(){return z.head(z.sortBy(function(O){return O.get_Confidence();},this.get_Intents()));},get_Entities:function(){return(this.get_Unwrap())[1];},get_Intents:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1];}},null,h);i=f.Intent=C.Class({get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1];}},null,i);j=f.Entity=C.Class({get_Value:function(){return(this.get_Unwrap())[3];},get_Role:function(){return(this.get_Unwrap())[2];},get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1,this.$2,this.$3];}},null,j);k=f.Interpreter=C.Class({get_Options:function(){return(this.get_Unwrap())[1];},get_Func:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0[0],this.$0[1]];}},null,k);l.New=function(O,P,Q){return{Name:O,Description:P,Url:Q};};m.HelloUser=function(O){var P,Q;return(Q=m.Hello(O),Q!=null&&Q.$==1&&(Q.$0.$==1&&(Q.$0.$1.$==0&&(Q.$0.$0.get_Role()==="contact"&&(P=Q.$0.$0,true)))))?{$:1,$0:P}:null;};m.Hello=function(O){var P,Q;return O!=null&&O.$==1&&(Q=m.Intent("Hello",O.$0),Q!=null&&Q.$==1&&(P=Q.$0,true))?{$:1,$0:P}:null;};m.QuickHello=function(O){var P;switch(O==="hello"?0:O==="hey"?0:O==="yo"?0:O==="hi"?0:O==="help"?1:O==="debug on"?2:O==="debug off"?3:O.toLowerCase()==="programs"?4:5){case 0:return{$:0,$0:null};case 1:return{$:1,$0:null};case 2:return{$:2,$0:null};case 3:return{$:3,$0:null};case 4:return{$:4,$0:null};case 5:return{$:5,$0:null};}};m.Intent=function(O,P){return P.get_TopIntent().get_Name()===O&&P.get_TopIntent().get_Confidence()>m.intentConfidenceThreshold()?{$:1,$0:z.filter(function(Q){return Q.get_Confidence()>m.entityConfidenceThreshold();},P.get_Entities())}:null;};m.availablePrograms=function(){n.$cctor();return n.availablePrograms;};m.entityConfidenceThreshold=function(){n.$cctor();return n.entityConfidenceThreshold;};m.set_entityConfidenceThreshold=function(O){n.$cctor();n.entityConfidenceThreshold=O;};m.intentConfidenceThreshold=function(){n.$cctor();return n.intentConfidenceThreshold;};m.set_intentConfidenceThreshold=function(O){n.$cctor();n.intentConfidenceThreshold=O;};n.$cctor=function(){n.$cctor=a.ignore;n.intentConfidenceThreshold=0.85;n.entityConfidenceThreshold=0.85;n.availablePrograms=z.ofArray(["Depression","Arthritis"]);};o.helloUserPhrases=function(){p.$cctor();return p.helloUserPhrases;};o.helloPhrases=function(){p.$cctor();return p.helloPhrases;};o.getRandomPhrase=function(O){return D.nth(o.rng().Next(0,O.get_Length()),O);};o.rng=function(){p.$cctor();return p.rng;};p.$cctor=function(){p.$cctor=a.ignore;p.rng=new E.New();p.helloPhrases=z.ofArray(["Welcome!","Welcome, my name is Selma.","Welcome to Selma. How can I help?","Hello this is Selma, how can I help?","Hello, I am Selma. How can I help?","Hello, I am Selma. How may I help you now?"]);p.helloUserPhrases=z.ofArray(["Hi $user, welcome back.","Welcome $user, nice to see you again..","Hello $user","Good to see you $user."]);};q.toArray=function(O){return F.map(a.id,G.makeArray(O));};q.info=function(O){H.info(O);};q.error=function(O){G.error(O);};q["Terminal.Push"]=function(O,P){var Q,R;Q=P.get_Func();R=P.get_Options();O.push(C.CreateFuncWithThis(Q),R);};q["Terminal.EchoHtml'"]=function(O,P){O.disable();O.echo(P,q.rawOpt());O.enable();};q["Terminal.Echo'"]=function(O,P){O.disable();O.echo(P);O.enable();};q.rawOpt=function(){t.$cctor();return t.rawOpt;};r=f._Html=C.Class({toString:function(){return r.toString(this);}},null,r);r.toString=function(O){function P(Q){return function(R){var S,T,U,V,W,X,Y;T=I.replicate(Q," ");switch(R.$==0?R.$1.$==1?R.$1.$0.$==2?R.$1.$1.$==0?(S=[R.$1.$0.$0,R.$0],1):(S=[R.$1,R.$0],2):(S=[R.$1,R.$0],2):(S=[R.$1,R.$0],2):R.$==2?(S=R.$0,3):(S=[R.$0,R.$1],0)){case 0:return S[0]+"=\""+S[1]+"\"";case 1:U=S[1];return T+"<"+U+">"+S[0]+"</"+U+">\r\n";case 2:V=S[1];W=z.partition(function(Z){return Z.$==1;},S[0]);X=W[1];Y=W[0];return X.$==0?T+"<"+V+(Y.$===0?"":" "+I.concat(" ",z.ofSeq(D.delay(function(){return D.map(function(Z){return(P(0))(Z);},Y);}))))+"/>\r\n":T+"<"+V+(Y.$===0?"":" "+I.concat(" ",z.ofSeq(D.delay(function(){return D.map(function(Z){return(P(0))(Z);},Y);}))))+">\r\n"+I.concat("",z.ofSeq(D.delay(function(){return D.map(function(Z){return(P(Q+1))(Z);},X);})))+T+"</"+V+">\r\n";case 3:return T+S+"\r\n";}};}return(P(0))(O);};s.alt=function(O){return new r({$:1,$0:"alt",$1:O});};s.src=function(O){return new r({$:1,$0:"src",$1:O});};s.cls=function(O){return new r({$:1,$0:"class",$1:O});};s.str=function(O){return r.toString(O);};s.op_PercentEquals=function(O,P){return new r({$:1,$0:O,$1:P});};s.op_Splice=function(O){var P;return z.ofArray([new r({$:2,$0:(P=O,a.String(P))})]);};s.strong=function(){t.$cctor();return t.strong;};s.h4=function(){t.$cctor();return t.h4;};s.h3=function(){t.$cctor();return t.h3;};s.h2=function(){t.$cctor();return t.h2;};s.h1=function(){t.$cctor();return t.h1;};s.li=function(){t.$cctor();return t.li;};s.ul=function(){t.$cctor();return t.ul;};s.th=function(){t.$cctor();return t.th;};s.td=function(){t.$cctor();return t.td;};s.tr=function(){t.$cctor();return t.tr;};s.a=function(){t.$cctor();return t.a;};s.p=function(){t.$cctor();return t.p;};s.area=function(){t.$cctor();return t.area;};s.map=function(){t.$cctor();return t.map;};s.img=function(){t.$cctor();return t.img;};s.tfoot=function(){t.$cctor();return t.tfoot;};s.tbody=function(){t.$cctor();return t.tbody;};s.thead=function(){t.$cctor();return t.thead;};s.table=function(){t.$cctor();return t.table;};s.span=function(){t.$cctor();return t.span;};s.section=function(){t.$cctor();return t.section;};s.br=function(){t.$cctor();return t.br;};s.div=function(){t.$cctor();return t.div;};s.body=function(){t.$cctor();return t.body;};s.style=function(){t.$cctor();return t.style;};s.title=function(){t.$cctor();return t.title;};s.head=function(){t.$cctor();return t.head;};s.html=function(){t.$cctor();return t.html;};s.elem=function(O,P){return new r({$:0,$0:O,$1:P});};t.$cctor=function(){var O;t.$cctor=a.ignore;t.rawOpt=(O={},O.raw=true,O);t.html=function(P){return s.elem("html",P);};t.head=function(P){return s.elem("head",P);};t.title=function(P){return s.elem("title",P);};t.style=function(P){return s.elem("style",P);};t.body=function(P){return s.elem("body",P);};t.div=function(P){return s.elem("div",P);};t.br=function(P){return s.elem("br",P);};t.section=function(P){return s.elem("section",P);};t.span=function(P){return s.elem("span",P);};t.table=function(P){return s.elem("table",P);};t.thead=function(P){return s.elem("thead",P);};t.tbody=function(P){return s.elem("tbody",P);};t.tfoot=function(P){return s.elem("tfoot",P);};t.img=function(P){return s.elem("img",P);};t.map=function(P){return s.elem("map",P);};t.area=function(P){return s.elem("area",P);};t.p=function(P){return s.elem("p",P);};t.a=function(P){return s.elem("a",P);};t.tr=function(P){return s.elem("tr",P);};t.td=function(P){return s.elem("td",P);};t.th=function(P){return s.elem("th",P);};t.ul=function(P){return s.elem("ul",P);};t.li=function(P){return s.elem("li",P);};t.h1=function(P){return s.elem("h1",P);};t.h2=function(P){return s.elem("h1",P);};t.h3=function(P){return s.elem("h1",P);};t.h4=function(P){return s.elem("h1",P);};t.strong=function(P){return s.elem("strong",P);};};u.Term=function(){var O,P;O=C.ThisFunc(function(Q,R){return((u.Main().get_Func())(Q))(R);});P=u.Main().get_Options();a.$("#main").terminal(O,P);u.context().unshift({$:0,$0:u.Main()});return y.get_Empty();};u.Main=function(){v.$cctor();return v.Main;};u.container=function(){v.$cctor();return v.container;};u.d=function(){v.$cctor();return v.d;};u.wait=function(O){var P;J.Start((P=null,J.Delay(function(){O();return J.Zero();})),null);q["Terminal.Echo'"](u.currentTerm(),"please wait");u.currentTerm().disable();O();u.currentTerm().enable();};u.stopSpeaking=function(){v.$cctor();return v.stopSpeaking;};u.sayRandom=function(O){u.say(o.getRandomPhrase(O));};u.sayVoices=function(){var O,P,Q,R;O=q.toArray(a.speechSynthesis.getVoices());u.say((function(S){return function(T){return S("There are currently "+a.String(T)+" voices installed on this computer or device.");};}(a.id))(F.length(O)));for(P=0,Q=F.length(O)-1;P<=Q;P++){R=F.get(O,P);u.say(((((C.Curried(function(S,T,U,V){return S("Voice "+a.String(T)+". Name: "+K.toSafe(U)+", Local: "+K.prettyPrint(V)+".");},4))(a.id))(P))(R.name))(R.localService));}};u.say=function(O){var P;J.Start((P=null,J.Delay(function(){var Q;Q=new a.SpeechSynthesisUtterance(O);Q.voice=u.currentVoice();a.speechSynthesis.speak(Q);return J.Zero();})),null);u.transcribe()?u.currentTerm().echo(O):void 0;};u.initSpeech=function(){var O,P,Q;O=q.toArray(a.speechSynthesis.getVoices());F.iter(function(R){if(L.Equals(u.currentVoice(),null)&&(R.name.indexOf("Microsoft Zira")!=-1||R.name.toLowerCase().indexOf("female")!=-1)){u.set_currentVoice(R);q.info((function(S){return function(T){return S("Using voice "+K.toSafe(T)+".");};}(a.id))(u.currentVoice().name));}},O);L.Equals(u.currentVoice(),null)&&F.length(O)>0?(u.set_currentVoice(F.find(function(R){return R["default"];},O)),q.info((function(R){return function(S){return R("Using voice "+K.toSafe(S)+".");};}(a.id))(u.currentVoice().name)),P=new a.SpeechSynthesisUtterance(function(R){return R("Using the default speech synthesis voice.");}(a.id)),J.Start((Q=null,J.Delay(function(){a.speechSynthesis.speak(P);return J.Zero();})),null)):L.Equals(u.currentVoice(),null)?q.error("No speech synthesis voice is available. In order to use Selma you must install a speech synthesis voice on this device or computer."):void 0;};u.transcribe=function(){v.$cctor();return v.transcribe;};u.set_transcribe=function(O){v.$cctor();v.transcribe=O;};u.debugMode=function(){v.$cctor();return v.debugMode;};u.set_debugMode=function(O){v.$cctor();v.debugMode=O;};u.currentTerm=function(){v.$cctor();return v.currentTerm;};u.set_currentTerm=function(O){v.$cctor();v.currentTerm=O;};u.currentVoice=function(){v.$cctor();return v.currentVoice;};u.set_currentVoice=function(O){v.$cctor();v.currentVoice=O;};u.context=function(){v.$cctor();return v.context;};v.$cctor=function(){var O;v.$cctor=a.ignore;function P(Q,R){var S,T;u.set_currentTerm(Q);L.Equals(u.currentVoice(),null)?u.initSpeech():void 0;S=m.QuickHello(R);return S.$==1?q["Terminal.EchoHtml'"](Q,s.str((s.div())(z.ofArray([(s.img())(z.ofArray([s.cls("card-img-top"),s.src("...")]))])))):S.$==2?(u.set_debugMode(true),u.say("Debug mode is now on.")):S.$==3?(u.set_debugMode(false),u.say("Debug mode is now off.")):S.$==4?(u.say("The following programs are available:"),z.iteri(function(U,V){return u.say((((C.Curried3(function(W,X,Y){return W(a.String(X)+". "+K.toSafe(Y));}))(a.id))(U))(V));},m.availablePrograms())):S.$==5?(q["Terminal.Echo'"](u.currentTerm(),"please wait"),Q.disable(),J.Start((T=null,J.Delay(function(){return J.Combine(J.Bind((new N.New()).Async("SMApp.Web:SMApp.Web.Server.GetMeaning:904730489",[R]),function(U){var V;V=m.HelloUser(U);return V!=null&&V.$==1?(u.say((function(W){return function(X){return W("This is the hello intent. The user name is "+K.toSafe(X)+".");};}(a.id))(V.$0.get_Value())),J.Zero()):(q["Terminal.Echo'"](Q,"This is the whatever intent"),J.Zero());}),J.Delay(function(){Q.enable();return J.Zero();}));})),null)):u.sayRandom(o.helloPhrases());}v.context=[];v.currentVoice=null;v.currentTerm=null;v.debugMode=false;v.transcribe=false;v.stopSpeaking=a.speechSynthesis.speaking||a.speechSynthesis.pending?a.speechSynthesis.cancel():null;v.d="\n        <div class=\"card\" style=\"width: 18rem;\">\n        <img class=\"card-img-top\" src=\"...\" alt=\"Card image cap\">\n        <div class=\"card-body\">\n          <h5 class=\"card-title\">Card title</h5>\n          <p class=\"card-text\">Some quick example text to build on the card title and make up the bulk of the card's content.</p>\n          <a href=\"#\" class=\"btn btn-primary\">Go somewhere</a>\n        </div>\n</div>\n    ";v.container=d.Container;v.Main=new k({$:0,$0:[function(Q){return function(R){return P(Q,R);};},(O={},O.name="Main",O.greetings="Welcome to Selma. Type hello to begin or help for more assistance.",O.prompt=">",O)]});};}());
