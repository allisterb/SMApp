(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M;a=self;b=a.SMApp=a.SMApp||{};c=b.Bootstrap=b.Bootstrap||{};d=c.Controls=c.Controls||{};e=a.StartupCode$SMApp_Web$Bootstrap=a.StartupCode$SMApp_Web$Bootstrap||{};f=b.Web=b.Web||{};g=f.User=f.User||{};h=f.Meaning=f.Meaning||{};i=f.Intent=f.Intent||{};j=f.Entity=f.Entity||{};k=f.Interpreter=f.Interpreter||{};l=f.Resource=f.Resource||{};m=f.NLU=f.NLU||{};n=a.StartupCode$SMApp_Web$NLU=a.StartupCode$SMApp_Web$NLU||{};o=f.CUI=f.CUI||{};p=a.StartupCode$SMApp_Web$CUI=a.StartupCode$SMApp_Web$CUI||{};q=f.ClientExtensions=f.ClientExtensions||{};r=a.StartupCode$SMApp_Web$ClientExtensions=a.StartupCode$SMApp_Web$ClientExtensions||{};s=f.Client=f.Client||{};t=a.StartupCode$SMApp_Web$Client=a.StartupCode$SMApp_Web$Client||{};u=a.WebSharper;v=u&&u.UI;w=v&&v.Doc;x=u&&u.List;y=v&&v.AttrModule;z=a.IntelliFactory;A=z&&z.Runtime;B=u&&u.Seq;C=u&&u.Random;D=u&&u.Arrays;E=a.jQuery;F=a.console;G=v&&v.Var$1;H=v&&v.AttrProxy;I=u&&u.Concurrency;J=u&&u.Utils;K=u&&u.Unchecked;L=u&&u.Remoting;M=L&&L.AjaxRemotingProvider;d.Radio=function(N,O,P,Q,R){return w.Element("div",new x.T({$:1,$0:(d.cls())("radio"),$1:O}),[w.Element("label",Q,[w.Radio(R,true,P),w.TextNode(N)])]);};d.Checkbox=function(N,O,P,Q,R){return w.Element("div",new x.T({$:1,$0:(d.cls())("checkbox"),$1:O}),[w.Element("label",Q,[w.CheckBox(R,P),w.TextNode(N)])]);};d.TextArea=function(N,O,P,Q,R){return w.Element("div",new x.T({$:1,$0:(d.cls())("form-group"),$1:O}),[w.Element("label",Q,[w.TextNode(N)]),w.InputArea(new x.T({$:1,$0:(d.cls())("form-control"),$1:R}),P)]);};d.InputPassword=function(N,O,P,Q,R){return w.Element("div",new x.T({$:1,$0:(d.cls())("form-group"),$1:O}),[w.Element("label",Q,[w.TextNode(N)]),w.PasswordBox(new x.T({$:1,$0:(d.cls())("form-control"),$1:R}),P)]);};d.Input=function(N,O,P,Q,R){return w.Element("div",new x.T({$:1,$0:(d.cls())("form-group"),$1:O}),[w.Element("label",Q,[w.TextNode(N)]),w.Input(new x.T({$:1,$0:(d.cls())("form-control"),$1:R}),P)]);};d.Container=function(N){return w.Element("div",[(d.cls())("container")],N);};d.Class=function(){e.$cctor();return e.Class;};d.cls=function(){e.$cctor();return e.cls;};e.$cctor=function(){e.$cctor=a.ignore;e.cls=y.Class;e.Class=y.Class;};g.New=function(N){return{UserName:N};};h=f.Meaning=A.Class({get_TopIntent:function(){return x.head(x.sortBy(function(N){return N.get_Confidence();},this.get_Intents()));},get_Entities:function(){return(this.get_Unwrap())[1];},get_Intents:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1];}},null,h);i=f.Intent=A.Class({get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1];}},null,i);j=f.Entity=A.Class({get_Value:function(){return(this.get_Unwrap())[3];},get_Role:function(){return(this.get_Unwrap())[2];},get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1,this.$2,this.$3];}},null,j);k=f.Interpreter=A.Class({get_Options:function(){return(this.get_Unwrap())[1];},get_Func:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0[0],this.$0[1]];}},null,k);l.New=function(N,O,P){return{Name:N,Description:O,Url:P};};m.HelloUser=function(N){var O,P;return(P=m.Hello(N),P!=null&&P.$==1&&(P.$0.$==1&&(P.$0.$1.$==0&&(P.$0.$0.get_Role()==="contact"&&(O=P.$0.$0,true)))))?{$:1,$0:O}:null;};m.Hello=function(N){var O,P;return N!=null&&N.$==1&&(P=m.Intent("Hello",N.$0),P!=null&&P.$==1&&(O=P.$0,true))?{$:1,$0:O}:null;};m.QuickHello=function(N){var O;switch(N==="hello"?0:N==="hey"?0:N==="yo"?0:N==="hi"?0:N==="help"?1:N==="debug on"?2:N==="debug off"?3:N.toLowerCase()==="programs"?4:5){case 0:return{$:0,$0:null};case 1:return{$:1,$0:null};case 2:return{$:2,$0:null};case 3:return{$:3,$0:null};case 4:return{$:4,$0:null};case 5:return{$:5,$0:null};}};m.Intent=function(N,O){return O.get_TopIntent().get_Name()===N&&O.get_TopIntent().get_Confidence()>m.intentConfidenceThreshold()?{$:1,$0:x.filter(function(P){return P.get_Confidence()>m.entityConfidenceThreshold();},O.get_Entities())}:null;};m.availablePrograms=function(){n.$cctor();return n.availablePrograms;};m.entityConfidenceThreshold=function(){n.$cctor();return n.entityConfidenceThreshold;};m.set_entityConfidenceThreshold=function(N){n.$cctor();n.entityConfidenceThreshold=N;};m.intentConfidenceThreshold=function(){n.$cctor();return n.intentConfidenceThreshold;};m.set_intentConfidenceThreshold=function(N){n.$cctor();n.intentConfidenceThreshold=N;};n.$cctor=function(){n.$cctor=a.ignore;n.intentConfidenceThreshold=0.85;n.entityConfidenceThreshold=0.85;n.availablePrograms=x.ofArray(["Depression","Arthritis"]);};o.helloUserPhrases=function(){p.$cctor();return p.helloUserPhrases;};o.helloPhrases=function(){p.$cctor();return p.helloPhrases;};o.getRandomPhrase=function(N){return B.nth(o.rng().Next(0,N.get_Length()),N);};o.rng=function(){p.$cctor();return p.rng;};p.$cctor=function(){p.$cctor=a.ignore;p.rng=new C.New();p.helloPhrases=x.ofArray(["Welcome!","Welcome, my name is Selma.","Welcome to Selma. How can I help?","Hello this is Selma, how can I help?","Hello, I am Selma. How can I help?","Hello, I am Selma. How may I help you now?"]);p.helloUserPhrases=x.ofArray(["Hi $user, welcome back.","Welcome $user, nice to see you again..","Hello $user","Good to see you $user."]);};q.toArray=function(N){return D.map(a.id,E.makeArray(N));};q.info=function(N){F.info(N);};q.error=function(N){E.error(N);};q["Terminal.Push"]=function(N,O){var P,Q;P=O.get_Func();Q=O.get_Options();N.push(A.CreateFuncWithThis(P),Q);};q["Terminal.EchoHtml'"]=function(N,O){N.disable();N.echo(O,q.rawOpt());N.enable();};q["Terminal.Echo'"]=function(N,O){N.disable();N.echo(O);N.enable();};q.rawOpt=function(){r.$cctor();return r.rawOpt;};r.$cctor=function(){var N;r.$cctor=a.ignore;r.rawOpt=(N={},N.raw=true,N);};s.Term=function(){var N,O;d.Input("Username",x.T.Empty,G.Create$1("dd"),[y.Class("sr-only")],x.ofArray([y.Class("input-lg"),H.Create("readonly","")]));N=A.ThisFunc(function(P,Q){return((s.Main().get_Func())(P))(Q);});O=s.Main().get_Options();a.$("#main").terminal(N,O);s.context().unshift({$:0,$0:s.Main()});return w.get_Empty();};s.Main=function(){t.$cctor();return t.Main;};s.container=function(){t.$cctor();return t.container;};s.d=function(){t.$cctor();return t.d;};s.wait=function(N){var O;I.Start((O=null,I.Delay(function(){N();return I.Zero();})),null);q["Terminal.Echo'"](s.currentTerm(),"please wait");s.currentTerm().disable();N();s.currentTerm().enable();};s.stopSpeaking=function(){t.$cctor();return t.stopSpeaking;};s.sayRandom=function(N){s.say(o.getRandomPhrase(N));};s.sayVoices=function(){var N,O,P,Q;N=q.toArray(a.speechSynthesis.getVoices());s.say((function(R){return function(S){return R("There are currently "+a.String(S)+" voices installed on this computer or device.");};}(a.id))(D.length(N)));for(O=0,P=D.length(N)-1;O<=P;O++){Q=D.get(N,O);s.say(((((A.Curried(function(R,S,T,U){return R("Voice "+a.String(S)+". Name: "+J.toSafe(T)+", Local: "+J.prettyPrint(U)+".");},4))(a.id))(O))(Q.name))(Q.localService));}};s.say=function(N){var O;I.Start((O=null,I.Delay(function(){var P;P=new a.SpeechSynthesisUtterance(N);P.voice=s.currentVoice();a.speechSynthesis.speak(P);return I.Zero();})),null);s.transcribe()?s.currentTerm().echo(N):void 0;};s.initSpeech=function(){var N,O,P;N=q.toArray(a.speechSynthesis.getVoices());D.iter(function(Q){if(K.Equals(s.currentVoice(),null)&&(Q.name.indexOf("Microsoft Zira")!=-1||Q.name.toLowerCase().indexOf("female")!=-1)){s.set_currentVoice(Q);q.info((function(R){return function(S){return R("Using voice "+J.toSafe(S)+".");};}(a.id))(s.currentVoice().name));}},N);K.Equals(s.currentVoice(),null)&&D.length(N)>0?(s.set_currentVoice(D.find(function(Q){return Q["default"];},N)),q.info((function(Q){return function(R){return Q("Using voice "+J.toSafe(R)+".");};}(a.id))(s.currentVoice().name)),O=new a.SpeechSynthesisUtterance(function(Q){return Q("Using the default speech synthesis voice.");}(a.id)),I.Start((P=null,I.Delay(function(){a.speechSynthesis.speak(O);return I.Zero();})),null)):K.Equals(s.currentVoice(),null)?q.error("No speech synthesis voice is available. In order to use Selma you must install a speech synthesis voice on this device or computer."):void 0;};s.transcribe=function(){t.$cctor();return t.transcribe;};s.set_transcribe=function(N){t.$cctor();t.transcribe=N;};s.debugMode=function(){t.$cctor();return t.debugMode;};s.set_debugMode=function(N){t.$cctor();t.debugMode=N;};s.currentTerm=function(){t.$cctor();return t.currentTerm;};s.set_currentTerm=function(N){t.$cctor();t.currentTerm=N;};s.currentVoice=function(){t.$cctor();return t.currentVoice;};s.set_currentVoice=function(N){t.$cctor();t.currentVoice=N;};s.context=function(){t.$cctor();return t.context;};t.$cctor=function(){var N;t.$cctor=a.ignore;function O(P,Q){var R,S;s.set_currentTerm(P);K.Equals(s.currentVoice(),null)?s.initSpeech():void 0;R=m.QuickHello(Q);return R.$==1?q["Terminal.EchoHtml'"](P,s.d()):R.$==2?(s.set_debugMode(true),s.say("Debug mode is now on.")):R.$==3?(s.set_debugMode(false),s.say("Debug mode is now off.")):R.$==4?(s.say("The following programs are available:"),x.iteri(function(T,U){return s.say((((A.Curried3(function(V,W,X){return V(a.String(W)+". "+J.toSafe(X));}))(a.id))(T))(U));},m.availablePrograms())):R.$==5?(q["Terminal.Echo'"](s.currentTerm(),"please wait"),P.disable(),I.Start((S=null,I.Delay(function(){return I.Combine(I.Bind((new M.New()).Async("SMApp.Web:SMApp.Web.Server.GetMeaning:-753496133",[Q]),function(T){var U;U=m.HelloUser(T);return U!=null&&U.$==1?(s.say((function(V){return function(W){return V("This is the hello intent. The user name is "+J.toSafe(W)+".");};}(a.id))(U.$0.get_Value())),I.Zero()):(q["Terminal.Echo'"](P,"This is the whatever intent"),I.Zero());}),I.Delay(function(){P.enable();return I.Zero();}));})),null)):s.sayRandom(o.helloPhrases());}t.context=[];t.currentVoice=null;t.currentTerm=null;t.debugMode=false;t.transcribe=false;t.stopSpeaking=a.speechSynthesis.speaking||a.speechSynthesis.pending?a.speechSynthesis.cancel():null;t.d="\n        <div class=\"card\" style=\"width: 18rem;\">\n        <img class=\"card-img-top\" src=\"...\" alt=\"Card image cap\">\n        <div class=\"card-body\">\n          <h5 class=\"card-title\">Card title</h5>\n          <p class=\"card-text\">Some quick example text to build on the card title and make up the bulk of the card's content.</p>\n          <a href=\"#\" class=\"btn btn-primary\">Go somewhere</a>\n        </div>\n</div>\n    ";t.container=d.Container;t.Main=new k({$:0,$0:[function(P){return function(Q){return O(P,Q);};},(N={},N.name="Main",N.greetings="Welcome to Selma. Type hello to begin or help for more assistance.",N.prompt=">",N)]});};}());
