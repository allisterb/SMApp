(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG;a=self;b=a.SMApp=a.SMApp||{};c=b.Web=b.Web||{};d=c.ClientExtensions=c.ClientExtensions||{};e=d.SweetAlert=d.SweetAlert||{};f=c._Html=c._Html||{};g=c.htmModule=c.htmModule||{};h=a.StartupCode$SMApp_Web$ClientExtensions=a.StartupCode$SMApp_Web$ClientExtensions||{};i=c.TypingDNA=c.TypingDNA||{};j=i.SaveResponse=i.SaveResponse||{};k=i.UserResponse=i.UserResponse||{};l=i.VerifyResponse=i.VerifyResponse||{};m=c.Bs=c.Bs||{};n=b.NLU=b.NLU||{};o=n.Witai=n.Witai||{};p=o.Utterance=o.Utterance||{};q=o.Intent=o.Intent||{};r=o.Entity=o.Entity||{};s=o.Trait=o.Trait||{};t=o["Utterance'"]=o["Utterance'"]||{};u=o["Value'"]=o["Value'"]||{};v=c.NLG=c.NLG||{};w=a.StartupCode$SMApp_Web$NLG=a.StartupCode$SMApp_Web$NLG||{};x=c.NLU=c.NLU||{};y=x.Intent=x.Intent||{};z=x.Trait=x.Trait||{};A=x.Entity=x.Entity||{};B=x.Utterance=x.Utterance||{};C=x.Voice=x.Voice||{};D=C["Entity'"]=C["Entity'"]||{};E=x.Text=x.Text||{};F=E["Utterance'"]=E["Utterance'"]||{};G=E["Intent'"]=E["Intent'"]||{};H=E["Entity'"]=E["Entity'"]||{};I=E["Trait'"]=E["Trait'"]||{};J=x.Domain=x.Domain||{};K=a.StartupCode$SMApp_Web$NLU=a.StartupCode$SMApp_Web$NLU||{};L=c.Knowledge=c.Knowledge||{};M=L.EmotionalTrait=L.EmotionalTrait||{};N=L.Relation=L.Relation||{};O=L.Subject=L.Subject||{};P=L.Verb=L.Verb||{};Q=L.Object=L.Object||{};R=c.CUI=c.CUI||{};S=R.MicState=R.MicState||{};T=R.ClientState=R.ClientState||{};U=R.Interpreter=R.Interpreter||{};V=R.CUI=R.CUI||{};W=c.Dialogue=c.Dialogue||{};X=c.Question=c.Question||{};Y=c.QuestionType=c.QuestionType||{};Z=c.DialogueModule=c.DialogueModule||{};_0=c.Questions=c.Questions||{};_1=c.User=c.User||{};_2=a.StartupCode$SMApp_Web$User=a.StartupCode$SMApp_Web$User||{};_3=c.Symptoms=c.Symptoms||{};_4=a.StartupCode$SMApp_Web$Symptoms=a.StartupCode$SMApp_Web$Symptoms||{};_5=c.Main=c.Main||{};_6=a.StartupCode$SMApp_Web$Main=a.StartupCode$SMApp_Web$Main||{};_7=c.Client=c.Client||{};_8=a.StartupCode$SMApp_Web$Client=a.StartupCode$SMApp_Web$Client||{};_9=a.SMApp$Web_GeneratedPrintf=a.SMApp$Web_GeneratedPrintf||{};_=a.GeneratedPrintf=a.GeneratedPrintf||{};$=a.WebSharper;ba=$&&$.Arrays;bb=a.SweetAlert;bc=a.IntelliFactory;bd=bc&&bc.Runtime;be=$&&$.Operators;bf=$&&$.UI;bg=bf&&bf.Doc;bh=bf&&bf.AttrProxy;bi=bf&&bf.Client;bj=bi&&bi.Templates;bk=$&&$.Utils;bl=a.console;bm=a.jQuery;bn=$&&$.Strings;bo=$&&$.List;bp=$&&$.Seq;bq=bf&&bf.AttrModule;br=$&&$.Concurrency;bs=$&&$.Random;bt=$&&$.Collections;bu=bt&&bt.Map;bv=$&&$.JavaScript;bw=bv&&bv.Pervasives;bx=$&&$.ClientSideJson;by=bx&&bx.Provider;bz=a.JSON;bA=a.SDK;bB=$&&$.Unchecked;bC=$&&$.Remoting;bD=bC&&bC.AjaxRemotingProvider;bE=a.Wit;bF=a.document;bG=bt&&bt.Dictionary;d.getCameraCanvas=function(){return a.getCameraCanvas();};d.stopCamera=function(){return a.stopCamera();};d.startCamera=function(bH,bI){return a.startCamera(bH,bI);};d.speechSynthesis=function(){return a.speechSynthesis;};d.lastMicData=function(){return a.lastMicData;};d.Terminal=function(){return a.$("#term").terminal();};d.enableTerminal=function(){return a.$("#term").terminal().enable();};d.disableTerminal=function(){return a.$("#term").terminal().disable();};d.boxesWithTitles=function(bH){return ba.map(function(bI){var bJ;bJ={};bJ.titleText=bI;return bJ;},bH);};d.confirmQuestionBox=function(){bb.clickConfirm();};d.questionBox=function(bH,bI,bJ,bK,bL,bM,bN){var bO,bP,bQ,bR,bS,bT;bO=(bP=bK==null?(bQ={},bQ.titleText=bH,bQ.text=bI,bQ.icon="question",bQ.html="<div></div>",bQ.allowOutsideClick=false,bQ):(bR=bK.$0[0],(bS={},bS.titleText=bH,bS.text=bI,bS.icon="question",bS.width=a.String(bR),bS.html=(((bd.Curried3(function(bU,bV,bW){return bU("<div class=\"swal2-content-custom\" style=\"width:"+a.String(bV)+"px;height:"+a.String(bW)+"px\"></div>");}))(a.id))(bR))(bK.$0[1]),bS.allowOutsideClick=false,bS)),(bL!=null?bL.$0(bP):void 0,bJ!=null&&bJ.$==1?(bT=bJ.$0,(bP.progressSteps=ba.ofSeq(be.range(1,ba.length(bT))),bb.mixin(bP).queue(ba.create(ba.length(bT),bP)))):bb.fire(bP)));bM!=null?bM.$0():void 0;bO.then(bN);};e.get_QueueBoxes=function(){var bH;bH=bb.mixin({});return function(bI){return bH.queue(bI);};};d.getDialogueBoxInput=function(){return ba.get(a.jQuery(".swal2-input").get(),0);};d.getDialogueBoxCanvas=function(){return ba.get(a.jQuery("canvas.swal2-content").get(),0);};d.getDialogueBoxContent=function(){return ba.get(a.jQuery("#swal2-content").get(),0).firstChild;};d.createDialogueBoxCanvas=function(){return d.createCanvas("camera","640","480",ba.get(a.jQuery("#swal2-content").get(),0).firstChild);};d.createCanvas=function(bH,bI,bJ,bK){var bL;bL=bg.Element("canvas",[d.eid(bH),bh.Create("width",bI),bh.Create("height",bJ)],[]);bj.LoadLocalTemplates("");bg.Run(bK,bL);return bK.firstChild;};d.elementHTML=function(bH){return bH.innerHTML;};d.createElement=function(bH){var bI;bI=self.document.createElement("div");self.document.appendChild(bI);bj.LoadLocalTemplates("");bg.RunAppend(bI,bH);};d.getContainer=function(){return ba.get(a.jQuery("#container").get(),0).firstChild;};d.container=function(bH){return bg.Element("div",[d.cls("container")],bH);};d.dindex=function(bH){return bh.Create("data-index",a.String(bH));};d.cls=function(bH){return bh.Create("class",bH);};d.eid=function(bH){return bh.Create("id",bH);};d.getMic=function(){return ba.get(a.jQuery("#microphone").get(),0);};d.terminalOutput=function(){return ba.get(a.jQuery(".terminal-output").get(),0);};d.toLower=function(bH){return bH.toLowerCase();};d.debug=function(bH,bI){d.info((((bd.Curried3(function(bJ,bK,bL){return bJ("DEBUG: "+bk.toSafe(bK)+": "+bk.prettyPrint(bL));}))(a.id))(bH.toUpperCase()))(bI));};d.error=function(bH){bl.error(bH);};d.info=function(bH){bl.info(bH);};d.jserror=function(bH){bm.error(bH);};d.toArray=function(bH){return ba.map(a.id,bm.makeArray(bH));};d["Terminal.EchoHtml'"]=function(bH,bI){bH.pause();bH.echo(bI,d.rawOpt());bH.resume();};d["Terminal.Echo'"]=function(bH,bI){bH.pause();bH.echo(bI);bH.resume();};d.rawOpt=function(){h.$cctor();return h.rawOpt;};f=c._Html=bd.Class({toString:function(){return f.toString(this);}},null,f);f.toString=function(bH){function bI(bJ){return function(bK){var bL,bM,bN,bO,bP,bQ,bR;bM=bn.replicate(bJ," ");switch(bK.$==0?bK.$1.$==1?bK.$1.$0.$==2?bK.$1.$1.$==0?(bL=[bK.$1.$0.$0,bK.$0],1):(bL=[bK.$1,bK.$0],2):(bL=[bK.$1,bK.$0],2):(bL=[bK.$1,bK.$0],2):bK.$==2?(bL=bK.$0,3):(bL=[bK.$0,bK.$1],0)){case 0:return bL[0]+"=\""+bL[1]+"\"";case 1:bN=bL[1];return bM+"<"+bN+">"+bL[0]+"</"+bN+">\r\n";case 2:bO=bL[1];bP=bo.partition(function(bS){return bS.$==1;},bL[0]);bQ=bP[1];bR=bP[0];return bQ.$==0?bM+"<"+bO+(bR.$===0?"":" "+bn.concat(" ",bo.ofSeq(bp.delay(function(){return bp.map(function(bS){return(bI(0))(bS);},bR);}))))+"/>\r\n":bM+"<"+bO+(bR.$===0?"":" "+bn.concat(" ",bo.ofSeq(bp.delay(function(){return bp.map(function(bS){return(bI(0))(bS);},bR);}))))+">\r\n"+bn.concat("",bo.ofSeq(bp.delay(function(){return bp.map(function(bS){return(bI(bJ+1))(bS);},bQ);})))+bM+"</"+bO+">\r\n";case 3:return bM+bL+"\r\n";}};}return(bI(0))(bH);};g.alt=function(bH){return new f({$:1,$0:"alt",$1:bH});};g.src=function(bH){return new f({$:1,$0:"src",$1:bH});};g.cls=function(bH){return new f({$:1,$0:"class",$1:bH});};g.str=function(bH){return f.toString(bH);};g.op_PercentEquals=function(bH,bI){return new f({$:1,$0:bH,$1:bI});};g.op_Splice=function(bH){var bI;return bo.ofArray([new f({$:2,$0:(bI=bH,a.String(bI))})]);};g.strong=function(){h.$cctor();return h.strong;};g.h4=function(){h.$cctor();return h.h4;};g.h3=function(){h.$cctor();return h.h3;};g.h2=function(){h.$cctor();return h.h2;};g.h1=function(){h.$cctor();return h.h1;};g.li=function(){h.$cctor();return h.li;};g.ul=function(){h.$cctor();return h.ul;};g.th=function(){h.$cctor();return h.th;};g.td=function(){h.$cctor();return h.td;};g.tr=function(){h.$cctor();return h.tr;};g.a=function(){h.$cctor();return h.a;};g.p=function(){h.$cctor();return h.p;};g.area=function(){h.$cctor();return h.area;};g.map=function(){h.$cctor();return h.map;};g.img=function(){h.$cctor();return h.img;};g.tfoot=function(){h.$cctor();return h.tfoot;};g.tbody=function(){h.$cctor();return h.tbody;};g.thead=function(){h.$cctor();return h.thead;};g.table=function(){h.$cctor();return h.table;};g.span=function(){h.$cctor();return h.span;};g.section=function(){h.$cctor();return h.section;};g.br=function(){h.$cctor();return h.br;};g.div=function(){h.$cctor();return h.div;};g.body=function(){h.$cctor();return h.body;};g.style=function(){h.$cctor();return h.style;};g.title=function(){h.$cctor();return h.title;};g.head=function(){h.$cctor();return h.head;};g.html=function(){h.$cctor();return h.html;};g.elem=function(bH,bI){return new f({$:0,$0:bH,$1:bI});};h.$cctor=function(){var bH;h.$cctor=a.ignore;h.rawOpt=(bH={},bH.raw=true,bH);h.html=function(bI){return g.elem("html",bI);};h.head=function(bI){return g.elem("head",bI);};h.title=function(bI){return g.elem("title",bI);};h.style=function(bI){return g.elem("style",bI);};h.body=function(bI){return g.elem("body",bI);};h.div=function(bI){return g.elem("div",bI);};h.br=function(bI){return g.elem("br",bI);};h.section=function(bI){return g.elem("section",bI);};h.span=function(bI){return g.elem("span",bI);};h.table=function(bI){return g.elem("table",bI);};h.thead=function(bI){return g.elem("thead",bI);};h.tbody=function(bI){return g.elem("tbody",bI);};h.tfoot=function(bI){return g.elem("tfoot",bI);};h.img=function(bI){return g.elem("img",bI);};h.map=function(bI){return g.elem("map",bI);};h.area=function(bI){return g.elem("area",bI);};h.p=function(bI){return g.elem("p",bI);};h.a=function(bI){return g.elem("a",bI);};h.tr=function(bI){return g.elem("tr",bI);};h.td=function(bI){return g.elem("td",bI);};h.th=function(bI){return g.elem("th",bI);};h.ul=function(bI){return g.elem("ul",bI);};h.li=function(bI){return g.elem("li",bI);};h.h1=function(bI){return g.elem("h1",bI);};h.h2=function(bI){return g.elem("h1",bI);};h.h3=function(bI){return g.elem("h1",bI);};h.h4=function(bI){return g.elem("h1",bI);};h.strong=function(bI){return g.elem("strong",bI);};};j.New=function(bH,bI,bJ,bK){return{name:bH,message:bI,message_code:bJ,status:bK};};k.New=function(bH,bI,bJ,bK,bL){return{message:bH,message_code:bI,success:bJ,count:bK,status:bL};};l.New=function(bH,bI,bJ,bK,bL,bM){return{message:bH,message_code:bI,success:bJ,result:bK,score:bL,confidence:bM};};m.Radio=function(bH,bI,bJ,bK,bL){return bg.Element("div",new bo.T({$:1,$0:d.cls("radio"),$1:bI}),[bg.Element("label",bK,[bg.Radio(bL,true,bJ),bg.TextNode(bH)])]);};m.checkbox=function(bH,bI,bJ,bK,bL){return bg.Element("div",new bo.T({$:1,$0:d.cls("checkbox"),$1:bI}),[bg.Element("label",bK,[bg.CheckBox(bL,bJ),bg.TextNode(bH)])]);};m.textArea=function(bH,bI,bJ,bK,bL){return bg.Element("div",new bo.T({$:1,$0:d.cls("form-group"),$1:bI}),[bg.Element("label",bK,[bg.TextNode(bH)]),bg.InputArea(new bo.T({$:1,$0:d.cls("form-control"),$1:bL}),bJ)]);};m.inputPassword=function(bH,bI,bJ,bK,bL){return bg.Element("div",new bo.T({$:1,$0:d.cls("form-group"),$1:bI}),[bg.Element("label",bK,[bg.TextNode(bH)]),bg.PasswordBox(new bo.T({$:1,$0:d.cls("form-control"),$1:bL}),bJ)]);};m.input=function(bH,bI,bJ,bK,bL){return bg.Element("div",new bo.T({$:1,$0:d.cls("form-group"),$1:bI}),[bg.Element("label",bK,[bg.TextNode(bH)]),bg.Input([d.cls("form-control"),bL],bJ)]);};m.btnSecondary=function(bH,bI,bJ){return bg.Element("button",[d.eid(bH),d.cls("btn btn-secondary"),bq.Handler("click",bJ)],[bg.TextNode(bI)]);};m.btnPrimary=function(bH,bI,bJ){return bg.Element("button",[d.eid(bH),d.cls("btn btn-primary"),bq.Handler("click",bJ)],[bg.TextNode(bI)]);};p.New=function(bH,bI,bJ,bK){return{text:bH,intents:bI,entities:bJ,traits:bK};};q.New=function(bH,bI,bJ){return{id:bH,name:bI,confidence:bJ};};r.New=function(bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR){return{id:bH,name:bI,role:bJ,start:bK,end:bL,body:bM,confidence:bN,entities:bO,suggested:bP,value:bQ,type:bR};};s.New=function(bH,bI,bJ){return{id:bH,value:bI,confidence:bJ};};t.New=function(bH){return{intent:bH};};u.New=function(bH){return{value:bH};};o.getMeaning2=function(bH,bI){function bJ(bK,bL){var bM;bm.ajax((bM={},bM.url=(function(bN){return function(bO){return bN("https://api.wit.ai/message?q="+bk.toSafe(bO));};}(a.id))(bI),bM.type="GET",bM.beforeSend=function(bN){return bN.setRequestHeader("Authorization","Bearer "+bH);},bM.success=function(bN){return bK(bN);},bM.error=function(bN){return bL(new a.Error(bN.responseText));},bM));}return br.FromContinuations(function(bK,bL,bM){return bJ.apply(null,[bK,bL,bM]);});};o.getMeaning=function(bH,bI,bJ,bK){var bL;bm.ajax((bL={},bL.url=(function(bM){return function(bN){return bM("https://api.wit.ai/message?q="+bk.toSafe(bN));};}(a.id))(bI),bL.type="GET",bL.beforeSend=function(bM){return bM.setRequestHeader("Authorization","Bearer "+bH);},bL.success=bJ,bL.error=bK,bL));};v.waitAddPhrases=function(){w.$cctor();return w.waitAddPhrases;};v.waitRetrievePhrases=function(){w.$cctor();return w.waitRetrievePhrases;};v.helpPhrases=function(){w.$cctor();return w.helpPhrases;};v.helloUserPhrases=function(){w.$cctor();return w.helloUserPhrases;};v.helloPhrases=function(){w.$cctor();return w.helloPhrases;};v["getRandomPhrase'"]=function(bH){return v.replace_tok("$0","",bp.nth(v.rng().Next(0,bH.get_Length()),bH));};v.getRandomPhrase=function(bH,bI){return v.replace_tok("$0",bI,bp.nth(v.rng().Next(0,bH.get_Length()),bH));};v.replace_tok=function(bH,bI,bJ){return bn.Replace(bJ,bH,bI);};v.rng=function(){w.$cctor();return w.rng;};w.$cctor=function(){w.$cctor=a.ignore;w.rng=new bs.New();w.helloPhrases=bo.ofArray(["Welcome!","Welcome, my name is Selma.","Welcome to Selma. How can I help?","Hello this is Selma, how can I help?","Hello, I am Selma. How can I help?","Hello, I am Selma. How may I help you now?","I'm Selma. Tell me your name so we can get started."]);w.helloUserPhrases=bo.ofArray(["Hello $0, welcome back.","Welcome $0, nice to see you again.","Hello $0.","Good to see you $0.","Hello $0, nice to see you."]);w.helpPhrases=bo.ofArray(["What can I help you with $0?"]);w.waitRetrievePhrases=bo.ofArray(["Ok, let me check that $0 for you","Please wait while I check that $0 for you.","Wait while I check that $0.","Ok let me see if I can find that $0."]);w.waitAddPhrases=bo.ofArray(["Ok, let me add that $0 for you","Please wait while I add that $0 for you.","Wait while I add that $0.","I'll add that $0 now."]);};y=x.Intent=bd.Class({toString:function(){return(((bd.Curried3(function(bH,bI,bJ){return bH("Intent("+bk.toSafe(bI)+", "+_9.p$2(bJ)+")");}))(a.id))(this.get_Name()))(this.get_Confidence());},get_Confidence:function(){return this.$1;},get_Name:function(){return this.$0;}},null,y);z=x.Trait=bd.Class({toString:function(){return(((bd.Curried3(function(bH,bI,bJ){return bH("Trait("+bk.toSafe(bI)+", "+bk.prettyPrint(bJ)+")");}))(a.id))(this.get_Name()))(this.get_Value());},get_Confidence:function(){return this.$2;},get_Value:function(){return this.$1;},get_Name:function(){return this.$0;}},null,z);A=x.Entity=bd.Class({toString:function(){return(((((bd.Curried(function(bH,bI,bJ,bK,bL){return bH("Entity("+bk.toSafe(bI)+", "+bk.toSafe(bJ)+", "+bk.toSafe(bK)+", "+_9.p$2(bL)+")");},5))(a.id))(this.get_Name()))(this.get_Role()))(this.get_Value()))(this.get_Confidence());},get_Confidence:function(){return this.$3;},get_Value:function(){return this.$2;},get_Role:function(){return this.$1;},get_Name:function(){return this.$0;}},null,A);B=x.Utterance=bd.Class({toString:function(){return((((bd.Curried(function(bH,bI,bJ,bK){return bH(_9.p(bI)+" "+_9.p$3(bJ)+" "+_9.p$5(bK));},4))(a.id))(this.get_Intent()))(this.get_Traits()))(this.get_Entities());},get_Entities:function(){var bH;bH=this.$3;return bH!=null?{$:1,$0:bo.sortBy(function(bI){return bI.get_Name();},bH.$0)}:null;},get_Traits:function(){var bH;bH=this.$2;return bH!=null?{$:1,$0:bo.sortBy(function(bI){return bI.get_Name();},bH.$0)}:null;},get_Intent:function(){return this.$1;},get_Text:function(){return this.$0;}},null,B);D.New=function(bH,bI,bJ,bK,bL){return{body:bH,end:bI,start:bJ,suggested:bK,value:bL};};C["Intent'"]=function(bH,bI){return!(bI.intent==null)?{$:1,$0:new y({$:0,$0:d.toLower(bI.intent.value),$1:null})}:null;};C["Trait'"]=function(bH){return!(bH.domain==null)?{$:1,$0:new z({$:0,$0:"domain",$1:d.toLower(bH.domain.value),$2:null})}:!(bH.dialogue_act==null)?{$:1,$0:new z({$:0,$0:"dialogue_act",$1:d.toLower(bH.dialogue_act.value),$2:null})}:null;};C["Entity'$1"]=function(bH){return!(bH.contact==null)?{$:1,$0:new A({$:0,$0:"contact",$1:"",$2:d.toLower(bH.contact.value),$3:null})}:null;};F=E["Utterance'"]=bd.Class({get_TopIntent:function(){return bo.head(bo.sortBy(function(bH){return bH.get_Confidence();},this.get_Intents()));},get_Traits:function(){return this.$3;},get_Entities:function(){return this.$2;},get_Intents:function(){return this.$1;},get_Text:function(){return this.$0;}},null,F);G=E["Intent'"]=bd.Class({get_Confidence:function(){return this.$1;},get_Name:function(){return this.$0;}},null,G);H=E["Entity'"]=bd.Class({get_Value:function(){return(this.get_Unwrap())[3];},get_Role:function(){return(this.get_Unwrap())[2];},get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1,this.$2,this.$3];}},null,H);I=E["Trait'"]=bd.Class({get_Value:function(){return(this.get_Unwrap())[2];},get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1,this.$2];}},null,I);E.HasUtterance=function(bH){var bI,bJ,bK,bL,bM,bN;return bH!=null&&bH.$==1&&(bH.$0.$2.get_Length()>0&&(bI=[bH.$0.$2,bH.$0.$1,bH,bH.$0.$0,bH.$0.$3],true))?(bJ=bI[0],(bK=bI[2],(bL=bI[4],(bM=bI[1].$==0?null:{$:1,$0:new y({$:0,$0:bK.$0.get_TopIntent().get_Name(),$1:{$:1,$0:bK.$0.get_TopIntent().get_Confidence()}})},(bN=bJ.$==0?null:{$:1,$0:bo.map(function(bO){return new A({$:0,$0:bO.get_Name(),$1:d.toLower(bO.get_Role()),$2:bO.get_Value(),$3:{$:1,$0:bO.get_Confidence()}});},bo.filter(function(bO){return bO.get_Confidence()>E.entityConfidenceThreshold();},bJ))},{$:1,$0:new B({$:0,$0:bI[3],$1:bM,$2:bL.$==0?null:{$:1,$0:bo.map(function(bO){return new z({$:0,$0:d.toLower(bO.get_Name()),$1:bO.get_Value(),$2:{$:1,$0:bO.get_Confidence()}});},bo.filter(function(bO){return bO.get_Confidence()>E.entityConfidenceThreshold();},bL))},$3:bN})}))))):null;};E.entityConfidenceThreshold=function(){K.$cctor();return K.entityConfidenceThreshold;};E.set_entityConfidenceThreshold=function(bH){K.$cctor();K.entityConfidenceThreshold=bH;};E.intentConfidenceThreshold=function(){K.$cctor();return K.intentConfidenceThreshold;};E.set_intentConfidenceThreshold=function(bH){K.$cctor();K.intentConfidenceThreshold=bH;};E.getUtterance2=function(bH){var bI;bI=null;return br.Delay(function(){return br.Bind(o.getMeaning2("4Y2BLQY5TWLIN7HFIV264S53MY4PCUAT",bH),function(bJ){d.debug("NLU",(function(bK){return function(bL){return bK("Wit.ai returned "+_.p(bL)+" ");};}(a.id))(bJ));return br.Return(new F({$:0,$0:bH,$1:bo.ofArray(ba.map(function(bK){return new G({$:0,$0:bK.name,$1:bK.confidence});},bJ.intents)),$2:bo.map(function(bK){return new H({$:0,$0:bK.name,$1:bK.confidence,$2:bK.role,$3:bK.value});},bo.ofSeq(bp.concat(bp.map(function(bK){return bK[1];},bu.ToSeq(bJ.entities))))),$3:bo.ofSeq(bp.map(function(bK){var bL;bL=bK[1];return new I({$:0,$0:bK[0],$1:ba.get(bL,0).confidence,$2:ba.get(bL,0).value});},bu.ToSeq(bJ.traits)))}));});});};E.getUtterance=function(bH,bI){o.getMeaning("OOGDHEQL7JZRQASXN2N2GHFUKGO3SCNV",bH,function(bJ){var bK,bL;d.debug("NLU",(function(bM){return function(bN){return bM("Wit.ai returned: "+bk.prettyPrint(bN));};}(a.id))(bJ));bK=!(bJ.intents==null)?bo.ofArray(ba.map(function(bM){return new G({$:0,$0:bM.name,$1:bM.confidence});},bJ.intents)):bo.T.Empty;bL=!(bJ.traits==null)?bo.ofSeq(bp.concat(bo.map(function(bM){return ba.map(function(bN){return new I({$:0,$0:bM,$1:bN.confidence,$2:bN.value});},bw.GetJS(bJ.traits,[bM]));},bo.filter(function(bM){return!(bw.GetJS(bJ.traits,[bM])==null);},E.trait_types())))):bo.T.Empty;return bI({$:1,$0:new F({$:0,$0:bH,$1:bK,$2:!(bJ.entities==null)?bo.ofSeq(bp.concat(bo.map(function(bM){return ba.map(function(bN){return new H({$:0,$0:bN.name,$1:bN.confidence,$2:bN.role,$3:bN.value});},bw.GetJS(bJ.entities,[bM]));},bo.filter(function(bM){return!(bw.GetJS(bJ.entities,[bM])==null);},E.entity_types())))):bo.T.Empty,$3:bL})});},function(bJ,bK,bL){d.error((((bd.Curried3(function(bM,bN,bO){return bM("Wit.ai returned: "+bk.prettyPrint(bN)+" "+bk.prettyPrint(bO));}))(a.id))(bK))(bL));return bI(null);});};E.trait_types=function(){K.$cctor();return K.trait_types;};E.entity_types=function(){K.$cctor();return K.entity_types;};E.QuickJournal=function(bH){var bI;return bH==="journal"||bH==="diary"?{$:1,$0:new B({$:0,$0:"journal",$1:{$:1,$0:new y({$:0,$0:"journal",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};E.QuickNumber=function(bH){var bI,bJ,bK,bL,bM,bN;return(bJ=E.One(bH),bJ!=null&&bJ.$==1?(bI=bJ.$0,true):(bK=E.Two(bH),bK!=null&&bK.$==1?(bI=bK.$0,true):(bL=E.Three(bH),bL!=null&&bL.$==1?(bI=bL.$0,true):(bM=E.Four(bH),bM!=null&&bM.$==1?(bI=bM.$0,true):(bN=E.Five(bH),bN!=null&&bN.$==1&&(bI=bN.$0,true))))))?{$:1,$0:bI}:null;};E.Five=function(bH){var bI;return bH==="5"||bH==="five"?{$:1,$0:new B({$:0,$0:"five",$1:{$:1,$0:new y({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bo.ofArray([new A({$:0,$0:"wit/ordinal",$1:"",$2:"five",$3:{$:1,$0:1}})])}})}:null;};E.Four=function(bH){var bI;return bH==="4"||bH==="four"?{$:1,$0:new B({$:0,$0:"four",$1:{$:1,$0:new y({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bo.ofArray([new A({$:0,$0:"wit/ordinal",$1:"",$2:"four",$3:{$:1,$0:1}})])}})}:null;};E.Three=function(bH){var bI;return bH==="3"||bH==="three"?{$:1,$0:new B({$:0,$0:"three",$1:{$:1,$0:new y({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bo.ofArray([new A({$:0,$0:"wit/ordinal",$1:"",$2:"three",$3:{$:1,$0:1}})])}})}:null;};E.Two=function(bH){var bI;return bH==="2"||bH==="two"?{$:1,$0:new B({$:0,$0:"two",$1:{$:1,$0:new y({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bo.ofArray([new A({$:0,$0:"wit/ordinal",$1:"",$2:"two",$3:{$:1,$0:1}})])}})}:null;};E.One=function(bH){var bI;return bH==="1"||bH==="one"?{$:1,$0:new B({$:0,$0:"one",$1:{$:1,$0:new y({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bo.ofArray([new A({$:0,$0:"wit/ordinal",$1:"",$2:"one",$3:{$:1,$0:1}})])}})}:null;};E.QuickNo=function(bH){var bI;return bH==="no"||(bH==="nope"||(bH==="no way"||(bH==="nah"||(bH==="don't do it"||bH==="stop"))))?{$:1,$0:new B({$:0,$0:"no",$1:{$:1,$0:new y({$:0,$0:"reject",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};E.QuickYes=function(bH){var bI;return bH==="yes"||(bH==="ok"||(bH==="sure"||(bH==="yeah"||(bH==="yep"||(bH==="uh huh"||(bH==="go ahead"||bH==="go"))))))?{$:1,$0:new B({$:0,$0:"yes",$1:{$:1,$0:new y({$:0,$0:"verify",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};E.QuickHelp=function(bH){var bI;return bH==="help"||(bH==="help me"||(bH==="what's this?"||bH==="huh"))?{$:1,$0:new B({$:0,$0:"help",$1:{$:1,$0:new y({$:0,$0:"help",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};E.QuickHello=function(bH){var bI;return bH==="hello"||(bH==="hey"||(bH==="yo"||bH==="hi"))?{$:1,$0:new B({$:0,$0:"hello",$1:{$:1,$0:new y({$:0,$0:"greet",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};E.Voices=function(bH){return bH==="voices"?{$:1,$0:null}:null;};E.Debug=function(bH){return bH==="debug"?{$:1,$0:null}:null;};E.Blank=function(bH){return bH===""?{$:1,$0:null}:null;};J.Study=function(bH){return bH.get_Traits()!=null?{$:0,$0:null}:{$:1,$0:null};};x.StrA=function(bH){if(bH!=null&&bH.$==1)try{return{$:1,$0:((by.DecodeArray(by.Id()))())(bz.parse(bH.$0))};}catch(bI){return null;}else return null;};x.PStr=function(bH){var bI;return bH!=null&&bH.$==1&&(typeof bH.$0=="string"&&(bI=bH.$0,true))?{$:1,$0:bI}:null;};x.No=function(bH){var bI,bJ;return(bJ=x.Intent$1("reject",bH),bJ!=null&&bJ.$==1&&(bJ.$0[0]==null&&(bJ.$0[1]==null&&(bI=bH,true))))?{$:1,$0:bI}:null;};x.Yes=function(bH){var bI,bJ;return(bJ=x.Intent$1("verify",bH),bJ!=null&&bJ.$==1&&(bJ.$0[0]==null&&(bJ.$0[1]==null&&(bI=bH,true))))?{$:1,$0:bI}:null;};x.EntityManyofMany=function(bH,bI){return{$:1,$0:bu.OfArray(ba.ofSeq(bo.map(function(bJ){return bo.exists(function(bK){return bK.get_Role()===bJ;},bI)?[bJ,{$:1,$0:bo.filter(function(bK){return bK.get_Role()===bJ;},bI)}]:[bJ,null];},bH)))};};x.EntityManyOf1=function(bH,bI){var bJ;return bI!=null&&bI.$==1&&(bo.exists(function(bK){return bK.get_Role()===bH;},bI.$0)&&(bJ=bI.$0,true))?{$:1,$0:bo.filter(function(bK){return bK.get_Role()===bH;},bJ)}:null;};x.Entity1OfAny=function(bH,bI){var bJ;return bI!=null&&bI.$==1&&(bo.exists(function(bK){return bK.get_Role()===bH;},bI.$0)&&(bJ=bI.$0,true))?{$:1,$0:bo.head(bo.sortBy(function(bK){return bK.get_Role();},bo.filter(function(bK){return bK.get_Role()===bH;},bJ)))}:null;};x.Entity1Of1=function(bH,bI){var bJ,bK;return bI!=null&&bI.$==1&&(bI.$0.$==1&&(bI.$0.$1.$==0&&((bK=bI.$0.$0,bK.get_Role()===bH||bK.get_Name()===bH)&&(bJ=bI.$0.$0,true))))?{$:1,$0:bJ}:null;};x.Intent$1=function(bH,bI){return bI.get_Intent()!=null&&bI.get_Intent().$0.get_Name()===bH?{$:1,$0:[bI.get_Traits(),bI.get_Entities()]}:null;};K.$cctor=function(){K.$cctor=a.ignore;K.entity_types=bo.ofArray(["wit$contact:name","wit$datetime:datetime","term:subject","term:object","term:verb"]);K.trait_types=bo.ofArray(["domain","dialogue_act"]);K.intentConfidenceThreshold=0.85;K.entityConfidenceThreshold=0.85;};M=L.EmotionalTrait=bd.Class({get_Frequence:function(){return this.$2;},get_Hierarchy:function(){return this.$1;},get_Label:function(){return this.$0;}},null,M);N=L.Relation=bd.Class({toString:function(){return((((bd.Curried(function(bH,bI,bJ,bK){return bH("("+_9.p$8(bI)+", "+_9.p$9(bJ)+", "+_9.p$10(bK)+")");},4))(a.id))(this.get_Subject()))(this.get_Verb()))(this.get_Object());},get_Object:function(){return this.$2;},get_Verb:function(){return this.$1;},get_Subject:function(){return this.$0;}},null,N);O=L.Subject=bd.Class({toString:function(){return this.$==1?a.String(this.$0):this.$0;}},null,O);P=L.Verb=bd.Class({toString:function(){return this.$0;}},null,P);Q=L.Object=bd.Class({toString:function(){return this.$==1?a.String(this.$0):this.$0;}},null,Q);S.MicReady={$:5};S.MicAudioEnd={$:4};S.MicAudioStart={$:3};S.MicDisconnected={$:2};S.MicConnecting={$:1};S.MicNotInitialized={$:0};T.ClientUnderstand={$:2};T.ClientReady={$:1};T.ClientNotInitialzed={$:0};U=R.Interpreter=bd.Class({get_Options:function(){return(this.get_Unwrap())[2];},get_Text:function(){return(this.get_Unwrap())[1];},get_Voice:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1[0],this.$1[1]];}},null,U);V=R.CUI=bd.Class({SayVoices:function(){var bH,bI,bJ;bH=this;bI=a.speechSynthesis.getVoices();!(bI==null)?(bJ=d.toArray(bI),bH.Say((function(bK){return function(bL){return bK("There are currently "+a.String(bL)+" voices installed on this computer or device.");};}(a.id))(ba.length(bJ))),ba.iteri(function(bK,bL){return bH.Say(((((bd.Curried(function(bM,bN,bO,bP){return bM("Voice "+a.String(bN)+". Name: "+bk.toSafe(bO)+", Local: "+bk.prettyPrint(bP)+".");},4))(a.id))(bK))(bL.name))(bL.localService));},bJ)):void 0;},Wait:function(bH){this.Wait$1(function(){br.Start(bH,null);});},Wait$1:function(bH){this["Echo'"]("please wait...");this.Term.pause();bH();this.Term.resume();},sayRandom:function(bH,bI){this.Say(v.getRandomPhrase(bH,bI));},SayAngry:function(bH){var bI,bJ;bI=this;br.Start((bJ=null,br.Delay(function(){return br.Combine(a.speechSynthesis.speaking?(a.speechSynthesis.cancel(),bA.chime(),br.Zero()):br.Zero(),br.Delay(function(){a.addMessage(bI.Avatar,bH,"","");bI.Avatar.processMessages(0);return br.Zero();}));})),null);},SayDoc:function(bH){var bI,bJ,bK;bI=ba.get(bm(".terminal-output").get(),0).childNodes.length;bJ=bg.Element("div",[d.cls("terminal-command"),d.dindex(bI+1)],[bH]);bK=d.terminalOutput();bj.LoadLocalTemplates("");bg.RunAppend(bK,bJ);},Say:function(bH){var bI,bJ;bI=this;br.Start((bJ=null,br.Delay(function(){return br.Combine(a.speechSynthesis.speaking?(bA.chime(),br.Zero()):br.Zero(),br.Delay(function(){bI.Avatar.addMessage(bH);bI.Avatar.processMessages(0);return br.Zero();}));})),null);},Debug:function(bH,bI){d.debug(bH,bI);},"EchoHtml'":function(bH){var bI,bJ;bI=(bJ={},bJ.raw=true,bJ);this.Term.disable();this.Term.echo(bH,bI);this.Term.enable();},"Echo'":function(bH){this.Term.disable();this.Term.echo(bH);this.Term.enable();}},null,V);V.New=function(bH,bI,bJ,bK,bL,bM,bN){return new V({Voice:bH,Mic:bI,Term:bJ,Avatar:bK,Caption:bL,AudioHandlers:bM,TypingDNA:bN});};W=c.Dialogue=bd.Class({get_Utterances:function(){return this.$4;},get_Output:function(){return this.$3;},get_DialogueQuestions:function(){return this.$2;},get_Props:function(){return this.$1;},get_Cui:function(){return this.$0;}},null,W);X=c.Question=bd.Class({toString:function(){return((((bd.Curried(function(bH,bI,bJ,bK){return bH("Name: "+bk.toSafe(bI)+" Module: "+bk.toSafe(bJ)+" Type: "+_9.p$13(bK)+" ");},4))(a.id))(this.get_Name()))(this.get_Module()))(this.get_Type());},get_Target:function(){return this.$4;},get_Params:function(){return this.$3;},get_Type:function(){return this.$2;},get_Module:function(){return this.$1;},get_Name:function(){return this.$0;}},null,X);Y.ConceptCompletion={$:3};Y.Disjunctive={$:2};Y.Verification={$:1};Z["Response'_"]=function(bH,bI,bJ){var bK,bL,bM,bN,bO,bP,bQ,bR;return(bL=Z.PropNotSet_(bH,"user",bJ),bL!=null&&bL.$==1?(bM=Z.Form(bH,bI,bL.$0),bM!=null&&bM.$==1?(bK=bM.$0,true):(bN=Z.PropNotSet_(bH,"user",bJ),bN!=null&&bN.$==1&&(bO=Z.NotForm(bH,bI,bN.$0),bO!=null&&bO.$==1&&(bK=bO.$0,true)))):(bP=Z.PropNotSet_(bH,"user",bJ),bP!=null&&bP.$==1&&(bQ=Z.NotForm(bH,bI,bP.$0),bQ!=null&&bQ.$==1&&(bK=bQ.$0,true))))?(bR=Z.have(bH,bI)?{$:1,$0:Z.prop(bH,bI)}:null,bK.get_Text()!==""?{$:1,$0:[bK,{$:1,$0:bK.get_Text()},bR]}:{$:1,$0:[bK,null,bR]}):null;};Z.Response_=function(bH,bI,bJ){var bK,bL,bM,bN,bO,bP,bQ,bR;return(bL=Z.PropSet_(bH,"user",bJ),bL!=null&&bL.$==1?(bM=Z.Form(bH,bI,bL.$0),bM!=null&&bM.$==1?(bK=bM.$0,true):(bN=Z.PropSet_(bH,"user",bJ),bN!=null&&bN.$==1&&(bO=Z.NotForm(bH,bI,bN.$0),bO!=null&&bO.$==1&&(bK=bO.$0,true)))):(bP=Z.PropSet_(bH,"user",bJ),bP!=null&&bP.$==1&&(bQ=Z.NotForm(bH,bI,bP.$0),bQ!=null&&bQ.$==1&&(bK=bQ.$0,true))))?(bR=Z.have(bH,bI)?{$:1,$0:Z.prop(bH,bI)}:null,bK.get_Text()!==""?{$:1,$0:[bK,{$:1,$0:bK.get_Text()},bR]}:{$:1,$0:[bK,null,bR]}):null;};Z.NotForm=function(bH,bI,bJ){return bH.get_DialogueQuestions().length>0&&(bH.get_DialogueQuestions())[0].get_Name()===bI&&bJ.get_Text()!==""?{$:1,$0:bJ}:null;};Z.Form=function(bH,bI,bJ){return bH.get_DialogueQuestions().length>0&&(bH.get_DialogueQuestions())[0].get_Name()===bI&&bJ.get_Intent()!=null&&bJ.get_Intent().$0.get_Name()===bI&&bB.Equals(bJ.get_Intent().$0.get_Confidence(),{$:1,$0:1})&&bB.Equals(bJ.get_Traits(),null)&&bB.Equals(bJ.get_Entities(),null)?{$:1,$0:bJ}:null;};Z["User'_"]=function(bH,bI){var bJ,bK;return(bK=Z.PropNotSet_(bH,"user",bI),bK!=null&&bK.$==1&&(bH.get_DialogueQuestions().length===0&&(bJ=bK.$0,true)))?{$:1,$0:bJ}:null;};Z.User_=function(bH,bI){var bJ,bK;return(bK=Z.PropSet_(bH,"user",bI),bK!=null&&bK.$==1&&(bH.get_DialogueQuestions().length===0&&(bJ=bK.$0,true)))?{$:1,$0:bJ}:null;};Z.PropNotSet_=function(bH,bI,bJ){return!Z.have(bH,bI)?{$:1,$0:bJ}:null;};Z.PropSet_=function(bH,bI,bJ){return Z.have(bH,bI)?{$:1,$0:bJ}:null;};Z.Agenda_=function(bH,bI,bJ,bK){return bH.get_DialogueQuestions().length>0&&(bH.get_DialogueQuestions())[0].get_Module()===bJ?{$:1,$0:null}:null;};Z.debugInterpreterEnd=function(bH,bI,bJ){bI(((((bd.Curried(function(bK,bL,bM,bN){return bK(bk.toSafe(bL)+" ending utterances:"+bk.prettyPrint(bM)+", questions: "+bk.prettyPrint(bN)+".");},4))(a.id))(bJ))(bH.get_Utterances()))(bH.get_DialogueQuestions()));};Z.debugInterpreterStart=function(bH,bI,bJ){bI(((((bd.Curried(function(bK,bL,bM,bN){return bK(bk.toSafe(bL)+" starting utterances:"+bk.prettyPrint(bM)+", questions: "+bk.prettyPrint(bN)+".");},4))(a.id))(bJ))(bH.get_Utterances()))(bH.get_DialogueQuestions()));};Z.frame=function(bH){return bo.ofSeq(bp.take(bH.length>=5?5:bH.length,bH));};Z.didNotUnderstand=function(bH,bI,bJ){bI((function(bK){return function(bL){return bK(bk.toSafe(bL)+" interpreter did not understand utterance.");};}(a.id))(bJ));Z.popu(bH,bI);Z.say(bH,"Sorry I didn't understand what you meant.");};Z.endt=function(bH,bI,bJ,bK){Z.popu(bH,bI);Z.popq(bH,bI);Z.have(bH,bJ)?Z.remove(bH,bI,bJ):void 0;bI((function(bL){return function(bM){return bL("End turn "+bk.toSafe(bM)+".");};}(a.id))(bJ));bK();};Z.cancel=function(bH,bI,bJ){var bK;bK=(bH.get_DialogueQuestions())[0];bK.get_Name()!==bJ?(((bd.Curried3(function(bL,bM,bN){return bL(_9.p$14(bM)+" at the top of the stack does not have the name "+bk.toSafe(bN)+".");}))(be.FailWith))(bK))(bJ):void 0;Z.popq(bH,bI);bI((function(bL){return function(bM){return bL("Cancel "+_9.p$14(bM)+".");};}(a.id))(bK));};Z.trigger=function(bH,bI,bJ,bK,bL){Z.pushu(bH,bI,new B({$:0,$0:bz.stringify(bL),$1:{$:1,$0:new y({$:0,$0:bK,$1:{$:1,$0:1}})},$2:null,$3:null}));bJ(bH);};Z.handle=function(bH,bI,bJ,bK){Z.popu(bH,bI);bI((function(bL){return function(bM){return bL("Handle utterance "+bk.toSafe(bM)+".");};}(a.id))(bJ));bK();};Z.dispatch=function(bH,bI,bJ,bK){bI(((((bd.Curried(function(bL,bM,bN,bO){return bL("Dispatch to module "+bk.toSafe(bM)+" utterances: "+bk.prettyPrint(bN)+" questions: "+bk.prettyPrint(bO)+".");},4))(a.id))(bJ))(bH.get_Utterances()))(bH.get_DialogueQuestions()));bK(bH);};Z.popq=function(bH,bI){var bJ;bJ=bH.get_DialogueQuestions().shift();bI((function(bK){return function(bL){return bK("Pop "+_9.p$14(bL)+".");};}(a.id))(bJ));};Z.pushq=function(bH,bI,bJ){bH.get_DialogueQuestions().unshift(bJ);bI((function(bK){return function(bL){return bK("Push "+_9.p$14(bL)+".");};}(a.id))(bJ));};Z.popu=function(bH,bI){var bJ;bJ=bH.get_Utterances().shift();bI((function(bK){return function(bL){return bK("Pop "+_9.p$12(bL)+".");};}(a.id))(bJ));};Z.pushu=function(bH,bI,bJ){bI((function(bK){return function(bL){return bK("Push "+_9.p$12(bL)+".");};}(a.id))(bJ));bH.get_Utterances().unshift(bJ);};Z.remove=function(bH,bI,bJ){bI((function(bK){return function(bL){return bK("Remove property "+bk.toSafe(bL)+".");};}(a.id))(bJ));bH.get_Props().Remove(bJ);};Z.add=function(bH,bI,bJ,bK){bH.get_Props().Add(bJ,bK);bI((((bd.Curried3(function(bL,bM,bN){return bL("Add property "+bk.toSafe(bM)+":"+bk.prettyPrint(bN)+".");}))(a.id))(bJ))(bK));};Z.prop=function(bH,bI){return bH.get_Props().ContainsKey(bI)?bH.get_Props().get_Item(bI):(function(bJ){return function(bK){return bJ("The "+bk.toSafe(bK)+" dialogue property does not exist.");};}(be.FailWith))(bI);};Z.have=function(bH,bI){return bH.get_Props().ContainsKey(bI);};Z["sayRandom'"]=function(bH,bI){Z.sayRandom(bH,bI,"");};Z.sayRandom=function(bH,bI,bJ){var bK;bK=v.getRandomPhrase(bI,bJ);bH.get_Output().unshift(bK);bH.get_Cui().Say(bK);};Z.say=function(bH,bI){bH.get_Output().unshift(bI);Z["say'"](bH,bI);};Z["say'"]=function(bH,bI){bH.get_Cui().Say(bI);};Z.echo=function(bH,bI){(bH.get_Cui())["EchoHtml'"](bI);};_0.ask=function(bH,bI,bJ){var bK,bL,bM,bN;function bO(bT){Z.say(bH,bT);}function bP(bT){bT.input="text";bT.showCancelButton=true;bT.confirmButtonText="Ok";}function bQ(bT){bT.confirmButtonClass="invisible";bT.showCancelButton=true;}function bR(){var bT;bT=d.createDialogueBoxCanvas();d.startCamera(self.document.body,bT);}function bS(bT){var bU,bV;bU=bT[0];bV=bT[1];d.questionBox("Biometric Authentication","",{$:1,$0:d.boxesWithTitles(["2","3"])},{$:1,$0:[640,480]},{$:1,$0:bP},{$:1,$0:bR},function(bW){var bX,bY,bZ,b0;bW.isConfirmed?(bX=bH.get_Cui().TypingDNA.getTypingPattern((bY={},bY.type=1,bY.text=bN,bY.caseSensitive=false,bY)),bZ=bW.value,b0=d.getCameraCanvas().toDataURL(),bI((function(b1){return function(b2){return b1("User image is "+bk.toSafe(b2)+"...");};}(a.id))(bn.Substring(b0,0,10))),d.stopCamera(),bI((((bd.Curried3(function(b1,b2,b3){return b1("User entered typing pattern "+bk.toSafe(b2)+" for text "+bk.toSafe(b3));}))(a.id))(bX))(bZ)),bZ.toLowerCase()!==bN.toLowerCase()?(bO("Sorry you did not enter the passphrase correctly. Please try again."),bS([bU,bV])):d.questionBox("Biometric Authentication","",null,null,{$:1,$0:bQ},{$:1,$0:function(){d.getDialogueBoxContent().appendChild(d.getMic());bH.get_Cui().AudioHandlers.Add("VoiceAuthentication",function(b1){bz.stringify(((by.Id())())(b1));d.confirmQuestionBox();});}},function(b1){if(!b1.isConfirmed){bH.get_Cui().AudioHandlers.Remove("VoiceAuthentication");bO("OK but you must login for me to help you.");}})):bO("OK but you must login for me to help you.");});}Z.pushq(bH,bI,bJ);bK=bJ.get_Type();bK.$==0?(bL=bJ.get_Target(),bM=bJ.get_Name(),bN=(function(bT){return function(bU){return bT("Hello my name is "+bk.toSafe(bU)+" and I am an administrator");};}(a.id))(bK.$0),bO((function(bT){return function(bU){return bT("Enter the phrase "+bk.toSafe(bU)+".");};}(a.id))(bN)),bS([0,[]])):be.FailWith("Not implemented");};_1.update=function(bH){var bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci;function cj(cu){Z.say(bH,cu);}function ck(cu,cv){return Z.sayRandom(bH,cu,cv);}function cl(cu,cv){return Z.add(bH,function(cw){_1.debug(cw);},cu,cv);}function cm(cu){_1.debug(cu);}function cn(cu){_1.debug(cu);}function co(cu){_1.debug(cu);}function cp(cu){return Z["User'_"](bH,cu);}function cq(cu,cv){return Z.Response_(bH,cu,cv);}function cr(cu,cv){return Z["Response'_"](bH,cu,cv);}function cs(cu){var cv;ck(v.waitRetrievePhrases(),"user name");br.Start((cv=null,br.Delay(function(){return br.Bind((new bD.New()).Async("SMApp.Web:SMApp.Web.Server.getUser:-2065237486",[cu]),function(cw){var cx;return cw==null?(cj((function(cy){return function(cz){return cy("I did not find a user with the name "+bk.toSafe(cz)+".");};}(a.id))(cu)),bK(new X({$:0,$0:"addUser",$1:_1.name(),$2:Y.Verification,$3:null,$4:function(){cl("addUser",cu);cj((function(cy){return function(cz){return cy("Do you want me to add the user "+bk.toSafe(cz)+"?");};}(a.id))(cu));}})),br.Zero()):(cx=cw.$0,br.Bind((new bD.New()).Async("SMApp.Web:SMApp.Web.Server.updateUserLastLogin:1188477902",[cx.Name]),function(){ck(v.helloUserPhrases(),cx.Name);return cx.LastLoggedIn!=null?br.Bind((new bD.New()).Async("SMApp.Web:SMApp.Web.Server.humanize:576037914",[cx.LastLoggedIn.$0]),function(cy){cj((function(cz){return function(cA){return cz("You last logged in "+bk.toSafe(cA)+".");};}(a.id))(cy));return br.Zero();}):br.Zero();}));});})),null);}function ct(cu){return new X({$:0,$0:"switchUser",$1:_1.name(),$2:Y.Verification,$3:null,$4:function(){cj((function(cv){return function(cw){return cv("Do you want me to switch to the user "+bk.toSafe(cw));};}(a.id))(cu));}});}Z.debugInterpreterStart(bH,function(cu){_1.debug(cu);},_1.name());bI=bd.Curried(Z.handle,2,[bH,cm]);bJ=bd.Curried(Z.endt,2,[bH,cn]);bK=function(cu){_0.ask(bH,co,cu);};bL=Z.frame(bH.$4);bL.$==1&&(bN=cp(bL.$0),bN!=null&&bN.$==1&&(bO=x.Intent$1("greet",bN.$0),bO!=null&&bO.$==1&&(bP=x.Entity1Of1("name",bO.$0[1]),bP!=null&&bP.$==1&&(bL.$1.$==0&&(bM=bP.$0,true)))))?(bI("loginUser"))(function(){cs(bM.get_Value());}):bL.$==1&&(bR=cp(bL.$0),bR!=null&&bR.$==1&&(bS=x.Intent$1("hello",bR.$0),bS!=null&&bS.$==1&&(bT=x.Entity1Of1("contact",bS.$0[1]),bT!=null&&bT.$==1&&(bL.$1.$==0&&(bQ=bT.$0,true)))))?(bI("loginUser"))(function(){cs(bQ.get_Value());}):bL.$==1&&(bV=cr("authenticateUser",bL.$0),bV!=null&&bV.$==1&&(bW=x.StrA(bV.$0[1]),bW!=null&&bW.$==1&&(bL.$1.$==0&&(bU=bW.$0,true))))?(bJ("authenticateUser"))(function(){var cu;_1.debug(bU);br.Start((cu=null,br.Delay(function(){return br.Bind((new bD.New()).Async("SMApp.Web:SMApp.Web.Server.hasFace:1480696414",[ba.get(bU,2)]),function(cv){return cv?(cj("Face detected"),br.Zero()):(cj(function(cw){return cw("Sorry I did not detect a face in the camera image. Make sure you can see the red square around your face in the camera window when you click the OK button.");}(a.id)),br.Zero());});})),null);}):bL.$==1&&(bY=x.No(bL.$0),bY!=null&&bY.$==1&&(bZ=cr("addUser",bY.$0),bZ!=null&&bZ.$==1&&(b0=x.PStr(bZ.$0[2]),b0!=null&&b0.$==1&&(bL.$1.$==0&&(bX=b0.$0,true)))))?(bJ("addUser"))(function(){cj((function(cu){return function(cv){return cu("Ok I did not add the user "+bk.toSafe(cv)+". But you must login for me to help you.");};}(a.id))(bX));}):bL.$==1&&(b2=x.Yes(bL.$0),b2!=null&&b2.$==1&&(b3=cr("addUser",b2.$0),b3!=null&&b3.$==1&&(b4=x.PStr(b3.$0[2]),b4!=null&&b4.$==1&&(bL.$1.$==0&&(b1=b4.$0,true)))))?(bJ("addUser"))(function(){bK(new X({$:0,$0:"authenticateNewUser1",$1:_1.name(),$2:{$:0,$0:b1},$3:null,$4:function(cu){_1.update(cu);}}));}):bL.$==1&&(b6=cr("authenticateNewUser1",bL.$0),b6!=null&&b6.$==1&&(b7=x.StrA(b6.$0[1]),b7!=null&&b7.$==1&&(bL.$1.$==0&&(b5=b7.$0,true))))?(bJ("authenticateNewUser1"))(function(){cj((function(cu){return function(cv){return cu("Authenticate new user "+bk.toSafe(cv)+".");};}(a.id))(ba.get(b5,0)));}):bL.$==1&&(b9=Z.User_(bH,bL.$0),b9!=null&&b9.$==1&&(b_=x.Intent$1("hello",b9.$0),b_!=null&&b_.$==1&&(b_.$0[0]==null&&(b$=x.Entity1Of1("name",b_.$0[1]),b$!=null&&b$.$==1&&(bL.$1.$==0&&(b8=b$.$0,true))))))?br.Start((ca=null,br.Delay(function(){return br.Bind((new bD.New()).Async("SMApp.Web:SMApp.Web.Server.getUser:-2065237486",[b8.get_Value()]),function(cu){return cu==null?(cj((function(cv){return function(cw){return cv("Sorry, the user "+bk.toSafe(cw)+" does not exist.");};}(a.id))(b8.get_Value())),br.Zero()):(bK(ct(cu.$0.Name)),br.Zero());});})),null):bL.$==1&&(cc=x.Yes(bL.$0),cc!=null&&cc.$==1&&(cd=cq("switchUser",cc.$0),cd!=null&&cd.$==1&&(ce=x.PStr(cd.$0[2]),ce!=null&&ce.$==1&&(bL.$1.$==0&&(cb=ce.$0,true)))))?(bH.$1.set_Item("user",cb),cj((function(cu){return function(cv){return cu("Ok I switched to user "+bk.prettyPrint(cv)+".");};}(a.id))(cb))):bL.$==1&&(cg=x.No(bL.$0),cg!=null&&cg.$==1&&(ch=cq("switchUser",cg.$0),ch!=null&&ch.$==1&&(ci=x.PStr(ch.$0[2]),ci!=null&&ci.$==1&&(bL.$1.$==0&&(cf=ci.$0,true)))))?cj((function(cu){return function(cv){return cu("Ok I did not switch to user "+bk.toSafe(cv)+".");};}(a.id))(cf)):Z.didNotUnderstand(bH,function(cu){_1.debug(cu);},_1.name());Z.debugInterpreterEnd(bH,function(cu){_1.debug(cu);},_1.name());};_1.debug=function(bH){d.debug(_1.name(),bH);};_1.name=function(){_2.$cctor();return _2.name;};_2.$cctor=function(){_2.$cctor=a.ignore;_2.name="User";};_3.update=function(bH){var bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX;function bY(b4){Z.say(bH,b4);}function bZ(b4,b5){return Z.sayRandom(bH,b4,b5);}function b0(b4){return Z.prop(bH,b4);}function b1(b4){return Z.User_(bH,b4);}function b2(){return b0("user");}function b3(b4,b5,b6){var b7;return br.Start((b7=null,br.Delay(function(){bZ(v.waitAddPhrases(),"symptom entry");return br.Bind((new bD.New()).Async("SMApp.Web:SMApp.Web.Server.addSymptomJournalEntry:-1301228563",[b2().Name,b4,b5,b6]),function(b8){return b8.$==1?(bY(function(b9){return b9("Sorry I wasn't able to add that symptom to your journal. Could you try again?");}(a.id)),br.Zero()):(bY((function(b9){return function(b_){return b9("OK I added that "+bk.toSafe(b_)+" symptom to your journal.");};}(a.id))(b4)),br.Zero());});})),null);}Z.debugInterpreterStart(bH,function(b4){_3.debug(b4);},_3.name());bI=Z.frame(bH.$4);bI.$==1&&(bK=b1(bI.$0),bK!=null&&bK.$==1&&(bL=x.Intent$1("symptom",bK.$0),bL!=null&&bL.$==1&&(bM=x.Entity1OfAny("symptom_name",bL.$0[1]),bM!=null&&bM.$==1&&(bI.$1.$==0&&(bJ=bM.$0,true)))))?br.Start((bN=null,br.Delay(function(){bY("Ok I'll add that entry to your symptom journal");b3(bJ.get_Value(),null,null);return br.Zero();})),null):bI.$==1&&(bP=x.Yes(bI.$0),bP!=null&&bP.$==1&&((bQ=Z.Response_(bH,"painVideo",bP.$0),bQ!=null&&bQ.$==1)&&bI.$1.$==0))?bH.$0["EchoHtml'"]("<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/SkAqOditKN0\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>"):bI.$==1&&(bS=b1(bI.$0),bS!=null&&bS.$==1&&(bT=x.Intent$1("medjournal",bS.$0),bT!=null&&bT.$==1&&((bU=bT.$0[1],bU!=null&&bU.$==1)&&(bI.$1.$==0&&(bR=bT.$0[1].$0,true)))))?(bY("ok I added that entry to your medication journal."),bY("You should be careful not to take too many painkillers over a short period of time.")):bI.$==1&&(bW=b1(bI.$0),bW!=null&&bW.$==1&&((bX=x.Intent$1("kbquery",bW.$0),bX!=null&&bX.$==1)&&(bI.$1.$==0&&(bV=bW.$0,true))))?void 0:Z.didNotUnderstand(bH,function(b4){_3.debug(b4);},_3.name());Z.debugInterpreterEnd(bH,function(b4){_3.debug(b4);},_3.name());};_3.debug=function(bH){d.debug(_3.name(),bH);};_3.name=function(){_4.$cctor();return _4.name;};_4.$cctor=function(){_4.$cctor=a.ignore;_4.name="Symptoms";};_5.update=function(bH){var bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2;function b3(b8){Z.say(bH,b8);}function b4(b8){Z["sayRandom'"](bH,b8);}function b5(b8){_5.debug(b8);}function b6(b8){_5.debug(b8);}function b7(b8){return Z["User'_"](bH,b8);}bI=bH.$4;_5.debug(((((bd.Curried(function(b8,b9,b_,b$){return b8("Module "+bk.toSafe(b9)+" starting utterances:"+bk.prettyPrint(b_)+", questions: "+bk.prettyPrint(b$)+".");},4))(a.id))(_5.name()))(bI))(bH.$2));bJ=bd.Curried(Z.dispatch,2,[bH,b5]);bK=bd.Curried(Z.handle,2,[bH,b6]);bL=Z.frame(bI);bM=Z.Agenda_(bH,function(b8){_5.debug(b8);},_1.name(),bL);bM!=null&&bM.$==1?(_5.debug((function(b8){return function(b9){return b8("Agenda is "+_9.p$14(b9)+".");};}(a.id))((bH.get_DialogueQuestions())[0])),_1.update(bH)):bL.$==1&&(bO=(bP=Z.PropNotSet_(bH,"started",bL.$0),bP!=null&&bP.$==1?{$:1,$0:bP.$0}:null),bO!=null&&bO.$==1&&(bQ=b7(bO.$0),bQ!=null&&bQ.$==1&&(bR=x.Intent$1("greet",bQ.$0),bR!=null&&bR.$==1&&(bR.$0[1]==null&&bL.$1.$==0))))?(Z.add(bH,function(b8){_5.debug(b8);},"started",true),(bK("greet"))(function(){b4(v.helloPhrases());})):bL.$==1&&(bT=b7(bL.$0),bT!=null&&bT.$==1&&(bU=x.Intent$1("greet",bT.$0),bU!=null&&bU.$==1&&(bU.$0[1]==null&&bL.$1.$==0)))?(bK("greet"))(function(){b3("Hello, tell me your name to get started.");}):bL.$==1&&(bW=b7(bL.$0),bW!=null&&bW.$==1&&(bX=x.Intent$1("greet",bW.$0),bX!=null&&bX.$==1&&((bY=x.Entity1Of1("name",bX.$0[1]),bY!=null&&bY.$==1)&&bL.$1.$==0)))?(bJ(_1.name()))(function(b8){_1.update(b8);}):bL.$==1&&(b0=b7(bL.$0),b0!=null&&b0.$==1&&(b1=x.Intent$1("hello",b0.$0),b1!=null&&b1.$==1&&((b2=x.Entity1Of1("contact",b1.$0[1]),b2!=null&&b2.$==1)&&bL.$1.$==0)))?(bJ(_1.name()))(function(b8){_1.update(b8);}):Z.didNotUnderstand(bH,function(b8){_5.debug(b8);},_5.name());Z.debugInterpreterEnd(bH,function(b8){_5.debug(b8);},_5.name());};_5.debug=function(bH){d.debug(_5.name(),bH);};_5.name=function(){_6.$cctor();return _6.name;};_6.$cctor=function(){_6.$cctor=a.ignore;_6.name="Main";};_7.run=function(){var bH,bI;bH=bd.ThisFunc(function(bJ,bK){return((_7.Main().get_Text())(bJ))(bK);});bI=_7.Main().get_Options();a.$("#term").terminal(bH,bI);return bg.get_Empty();};_7.Main=function(){_8.$cctor();return _8.Main;};_7.initMic=function(bH){var bI,bJ;_7.set_CUI((bI={$:1,$0:new bE.Microphone(bF.getElementById("microphone"))},V.New(_7.CUI().Voice,bI,_7.CUI().Term,_7.CUI().Avatar,_7.CUI().Caption,_7.CUI().AudioHandlers,_7.CUI().TypingDNA)));bJ=_7.CUI().Mic.$0;bJ.onconnecting=function(){_7.set_MicState(S.MicConnecting);return _7.debug("Mic connecting...");};bJ.ondisconnected=function(){_7.set_MicState(S.MicDisconnected);return _7.debug("Mic disconnected.");};bJ.onaudiostart=function(){_7.set_MicState(S.MicAudioStart);return _7.debug("Mic audio start...");};bJ.onaudioend=function(){var bK,bL,bM,bN;_7.debug("Mic audio end.");bL=_7.CUI().AudioHandlers;bK=bL.GetEnumerator$1();try{while(bK.MoveNext()){bM=bK.Current();_7.debug((function(bO){return function(bP){return bO("Executing audio handler "+bk.toSafe(bP)+".");};}(a.id))(bM.K));_7.set_MicState({$:7,$0:bM.K});bN=bM.V;_7.CUI().AudioHandlers.Remove(bM.K);bN(d.lastMicData());}return;}finally{bK.Dispose();}};bJ.onerror=function(bK){_7.set_MicState({$:6,$0:bK});return _7.debug((function(bL){return function(bM){return bL("Mic error : "+bk.toSafe(bM)+".");};}(a.id))(bK));};bJ.onready=function(){_7.set_MicState(S.MicReady);return _7.debug("Mic ready.");};bJ.onresult=function(bK,bL){return _7.ClientState().$==2?_7.echo("I'm still trying to understand what you said before."):_7.ClientState().$==0?d.error("Client is not intialized."):_7.MicState().$==7?null:!(bK==null||bL==null)?(_7.set_MicState({$:8,$0:bK,$1:bL}),_7.debug((((bd.Curried3(function(bM,bN,bO){return bM("Mic result: "+bk.prettyPrint(bN)+" "+bk.prettyPrint(bO)+".");}))(a.id))(bK))(bL)),bH(bK,bL)):_7.debug("Mic: No result returned.");};bJ.connect("4Y2BLQY5TWLIN7HFIV264S53MY4PCUAT");};_7.sayRandom=function(bH,bI){_7.say(v.getRandomPhrase(bI,bH));};_7.say=function(bH){_7.Output().unshift(bH);_7["say'"](bH);};_7["say'"]=function(bH){_7.CUI().Say(bH);};_7.initSpeech=function(){var bH;bH=d.toArray(_7.synth().getVoices());ba.length(bH)>0?(ba.iter(function(bI){if(bB.Equals(_7.CUI().Voice,null)&&(bI.name.indexOf("Microsoft Zira")!=-1||bI.name.toLowerCase().indexOf("female")!=-1)){_7.set_CUI(V.New({$:1,$0:bI},_7.CUI().Mic,_7.CUI().Term,_7.CUI().Avatar,_7.CUI().Caption,_7.CUI().AudioHandlers,_7.CUI().TypingDNA));_7.debug((function(bJ){return function(bK){return bJ("Using browser speech synthesis voice "+bk.toSafe(bK)+".");};}(a.id))(_7.CUI().Voice.$0.name));}},bH),!bB.Equals(_7.CUI().Voice,null)?(_7.CUI().Avatar.nativeVoice=true,_7.CUI().Avatar.nativeVoiceName=_7.CUI().Voice.$0.name,_7.debug((function(bI){return function(bJ){return bI("Using browser speech synthesis voice "+bk.toSafe(bJ)+".");};}(a.id))(_7.CUI().Voice.$0.name))):void 0):void 0;bB.Equals(_7.CUI().Voice,null)?_7.debug("No female browser speech synthesis voice is available. Using CMU SLT Female voice via TTS."):void 0;};_7.synth=function(){_8.$cctor();return _8.synth;};_7.push=function(bH){_7.Utterances().unshift(bH);return _7.Dialogue();};_7.Dialogue=function(){_8.$cctor();return _8.Dialogue;};_7.Utterances=function(){_8.$cctor();return _8.Utterances;};_7.Questions=function(){_8.$cctor();return _8.Questions;};_7.Output=function(){_8.$cctor();return _8.Output;};_7.Props=function(){_8.$cctor();return _8.Props;};_7.wait=function(bH){d["Terminal.Echo'"](_7.CUI().Term,"please wait");_7.CUI().Term.pause();bH();_7.CUI().Term.resume();};_7.debug=function(bH){d.debug("CLIENT",bH);};_7.echo=function(bH){d["Terminal.EchoHtml'"](_7.CUI().Term,(function(bI){return function(bJ){return bI(bk.prettyPrint(bJ));};}(a.id))(bH));};_7.ClientState=function(){_8.$cctor();return _8.ClientState;};_7.set_ClientState=function(bH){_8.$cctor();_8.ClientState=bH;};_7.MicState=function(){_8.$cctor();return _8.MicState;};_7.set_MicState=function(bH){_8.$cctor();_8.MicState=bH;};_7.CUI=function(){_8.$cctor();return _8.CUI;};_7.set_CUI=function(bH){_8.$cctor();_8.CUI=bH;};_8.$cctor=function(){var bH,bI,bJ;_8.$cctor=a.ignore;function bK(bM,bN){var bO,bP,bQ,bR,bS,bT,bU;_7.debug((((bd.Curried3(function(bV,bW,bX){return bV("Voice: "+bk.prettyPrint(bW)+" "+bk.prettyPrint(bX));}))(a.id))(bM))(bN));bO=(bP=C["Intent'"](bM,bN),bP!=null&&bP.$==1?{$:1,$0:bP.$0}:null);bQ=(bR=C["Trait'"](bN),bR!=null&&bR.$==1?{$:1,$0:bo.ofArray([bR.$0])}:null);bS=(bT=C["Entity'$1"](bN),bT!=null&&bT.$==1?{$:1,$0:bo.ofArray([bT.$0])}:null);bO==null&&(bQ==null&&bS==null)?void 0:(_7.debug(((((bd.Curried(function(bV,bW,bX,bY){return bV("Voice: "+_9.p(bW)+" "+_9.p$3(bX)+" "+_9.p$5(bY));},4))(a.id))(bO))(bQ))(bS)),_5.update(_7.push(new B({$:0,$0:"",$1:bO,$2:bQ,$3:bS}))));}function bL(bM,bN){var bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1;_7.set_CUI(V.New(_7.CUI().Voice,_7.CUI().Mic,bM,_7.CUI().Avatar,_7.CUI().Caption,_7.CUI().AudioHandlers,_7.CUI().TypingDNA));if(bB.Equals(_7.CUI().Mic,null))_7.initMic(bK);if(bB.Equals(_7.CUI().Voice,null))_7.initSpeech();if(_7.ClientState().$===0)_7.set_ClientState(T.ClientReady);bZ=E.Blank(bN);if(bZ!=null&&bZ.$==1)return _7["say'"]("Tell me what you want me to do or ask me a question.");else{b0=E.Debug(bN);if(b0!=null&&b0.$==1){_7.debug((function(b2){return function(b3){return b2("Utterances: "+bk.prettyPrint(b3));};}(a.id))(_7.Utterances()));_7.debug((function(b2){return function(b3){return b2("Questions: "+bk.prettyPrint(b3));};}(a.id))(_7.Questions()));bO=_7.Props().GetEnumerator$1();try{while(bO.MoveNext()){b1=bO.Current();_7.debug((((bd.Curried3(function(b2,b3,b4){return b2(bk.toSafe(b3)+": "+bk.prettyPrint(b4));}))(a.id))(b1.K))(b1.V));}}finally{bO.Dispose();}return _7.CUI().Wait((bP=null,br.Delay(function(){return br.Bind((new bD.New()).Async("SMApp.Web:SMApp.Web.Server.getRelations:869333657",["I had pain in my shoulder today when I watered the plants."]),function(b2){return b2.$==1?(_7.debug(b2.$0),br.Zero()):br.For(bo.head(b2.$0),function(b3){_7.debug((function(b4){return function(b5){return b4(_9.p$7(b5));};}(a.id))(b3));return br.Zero();});});})));}else{bQ=E.Voices(bN);return bQ!=null&&bQ.$==1?(bR=d.toArray(d.speechSynthesis().getVoices()),_7["say'"]((function(b2){return function(b3){return b2("There are currently "+a.String(b3)+" voices installed on this computer or device.");};}(a.id))(ba.length(bR))),ba.iteri(function(b2,b3){return _7["say'"](((((bd.Curried(function(b4,b5,b6,b7){return b4("Voice "+a.String(b5)+". Name: "+bk.toSafe(b6)+", Local: "+bk.prettyPrint(b7)+".");},4))(a.id))(b2))(b3.name))(b3.localService));},bR)):_7.ClientState().$==1?(bT=E.QuickHello(bN),(bT!=null&&bT.$==1?(bS=bT.$0,true):(bU=E.QuickHelp(bN),bU!=null&&bU.$==1?(bS=bU.$0,true):(bV=E.QuickYes(bN),bV!=null&&bV.$==1?(bS=bV.$0,true):(bW=E.QuickNo(bN),bW!=null&&bW.$==1?(bS=bW.$0,true):(bX=E.QuickNumber(bN),bX!=null&&bX.$==1&&(bS=bX.$0,true))))))?(_7.debug((function(b2){return function(b3){return b2("Quick Text: "+_9.p$12(b3)+".");};}(a.id))(bS)),_5.update(_7.push(bS)),_7.set_ClientState(T.ClientReady)):_7.CUI().Wait((bY=null,br.Delay(function(){_7.set_ClientState(T.ClientUnderstand);E.getUtterance(bN,function(b2){var b3,b4;b3=E.HasUtterance(b2);b3!=null&&b3.$==1?(b4=b3.$0,_7.debug(((((bd.Curried(function(b5,b6,b7,b8){return b5("Text: Intent: "+_9.p(b6)+", Traits: "+_9.p$3(b7)+", Entities: "+_9.p$5(b8)+".");},4))(a.id))(b4.get_Intent()))(b4.get_Traits()))(b4.get_Entities())),_5.update(_7.push(b4))):(_7.debug("Text: Did not receive a meaning from the server."),_7["say'"]("Sorry I did not understand what you said."));});_7.set_ClientState(T.ClientReady);return br.Zero();})))):_7.ClientState().$==0?d.error("Client is not initialized."):_7["say'"]("I'm still trying to understand what you said before.");}}}_8.CUI=V.New(null,null,null,(bA.applicationId="4277115329081938617",bH=new a.SDKConnection(),bI=new a.WebAvatar(),bI.version=8.5,bI.connection=bH,bI.avatar="20926186",bI.voice="cmu-slt",bI.voiceMod="default",bI.width=175,bI.createBox(),bI.addMessage(""),bI.processMessages(0),bI),false,new bG.New$5(),new a.TypingDNA());_8.MicState=S.MicNotInitialized;_8.ClientState=T.ClientNotInitialzed;_8.Props=new bG.New$5();_8.Output=[];_8.Questions=[];_8.Utterances=[];_8.Dialogue=new W({$:0,$0:_7.CUI(),$1:_7.Props(),$2:_7.Questions(),$3:_7.Output(),$4:_7.Utterances()});_8.synth=a.speechSynthesis;_8.Main=new U({$:0,$0:function(bM){return bK(bM[0],bM[1]);},$1:[function(bM){return function(bN){return bL(bM,bN);};},(bJ={},bJ.name="Main",bJ.greetings="Welcome to Selma. Enter 'hello' or 'hello my name is...(you) to initialize speech.",bJ.prompt=">",bJ)]});};_9.p$13=function(bH){return bH.$==3?"ConceptCompletion":bH.$==2?"Disjunctive":bH.$==1?"Verification":"UserAuthentication "+bk.prettyPrint(bH.$0);};_.p=function(bH){return"{"+("text = "+bk.prettyPrint(bH.text))+"; "+("intents = "+bk.printArray(function(bI){return _.p$1(bI);},bH.intents))+"; "+("entities = "+bk.prettyPrint(bH.entities))+"; "+("traits = "+bk.prettyPrint(bH.traits))+"}";};_.p$1=function(bH){return"{"+("id = "+bk.prettyPrint(bH.id))+"; "+("name = "+bk.prettyPrint(bH.name))+"; "+("confidence = "+bk.prettyPrint(bH.confidence))+"}";};_9.p$14=function(bH){return"Question ("+bk.prettyPrint(bH.$0)+", "+bk.prettyPrint(bH.$1)+", "+_9.p$13(bH.$2)+", "+_9.p$15(bH.$3)+", "+"<fun>"+")";};_9.p$15=function(bH){return bH==null?"null":"Some "+bk.printArray(bk.prettyPrint,bH.$0);};_9.p$2=function(bH){return bH==null?"null":"Some "+bk.prettyPrint(bH.$0);};_9.p$1=function(bH){return"Intent ("+bk.prettyPrint(bH.$0)+", "+_9.p$2(bH.$1)+")";};_9.p=function(bH){return bH==null?"null":"Some "+_9.p$1(bH.$0);};_9.p$4=function(bH){return"Trait ("+bk.prettyPrint(bH.$0)+", "+bk.prettyPrint(bH.$1)+", "+_9.p$2(bH.$2)+")";};_9.p$3=function(bH){return bH==null?"null":"Some "+bk.printList(function(bI){return _9.p$4(bI);},bH.$0);};_9.p$6=function(bH){return"Entity ("+bk.prettyPrint(bH.$0)+", "+bk.prettyPrint(bH.$1)+", "+bk.prettyPrint(bH.$2)+", "+_9.p$2(bH.$3)+")";};_9.p$5=function(bH){return bH==null?"null":"Some "+bk.printList(function(bI){return _9.p$6(bI);},bH.$0);};_9.p$8=function(bH){return bH.$==1?"Relation "+_9.p$7(bH.$0):"Subject "+bk.prettyPrint(bH.$0);};_9.p$9=function(bH){return"Verb "+bk.prettyPrint(bH.$0);};_9.p$11=function(bH){return bH.$==1?"Relation "+_9.p$7(bH.$0):"Object "+bk.prettyPrint(bH.$0);};_9.p$10=function(bH){return bH==null?"null":"Some "+_9.p$11(bH.$0);};_9.p$7=function(bH){return"Relation ("+_9.p$8(bH.$0)+", "+_9.p$9(bH.$1)+", "+_9.p$10(bH.$2)+")";};_9.p$12=function(bH){return"Utterance ("+bk.prettyPrint(bH.$0)+", "+_9.p(bH.$1)+", "+_9.p$3(bH.$2)+", "+_9.p$5(bH.$3)+")";};}());
