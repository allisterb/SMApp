(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH;a=self;b=a.SMApp=a.SMApp||{};c=b.Web=b.Web||{};d=c.ClientExtensions=c.ClientExtensions||{};e=c._Html=c._Html||{};f=c.htmModule=c.htmModule||{};g=a.StartupCode$SMApp_Web$ClientExtensions=a.StartupCode$SMApp_Web$ClientExtensions||{};h=c.TypingDNA=c.TypingDNA||{};i=h.SaveResponse=h.SaveResponse||{};j=h.UserResponse=h.UserResponse||{};k=h.VerifyResponse=h.VerifyResponse||{};l=c.Bs=c.Bs||{};m=b.NLU=b.NLU||{};n=m.Babelfy=m.Babelfy||{};o=n.ApiResponse=n.ApiResponse||{};p=n.TokenFragment=n.TokenFragment||{};q=n.CharFragment=n.CharFragment||{};r=m.Witai=m.Witai||{};s=r.Utterance=r.Utterance||{};t=r.Intent=r.Intent||{};u=r.Entity=r.Entity||{};v=r.Trait=r.Trait||{};w=r["Utterance'"]=r["Utterance'"]||{};x=r["Value'"]=r["Value'"]||{};y=m.QnAMaker=m.QnAMaker||{};z=y.ITSQuestion=y.ITSQuestion||{};A=y.ITSAnswerContext=y.ITSAnswerContext||{};B=y.ITSAnswer=y.ITSAnswer||{};C=y.ITSAnswers=y.ITSAnswers||{};D=c.NLG=c.NLG||{};E=a.StartupCode$SMApp_Web$NLG=a.StartupCode$SMApp_Web$NLG||{};F=c.NLU=c.NLU||{};G=F.Intent=F.Intent||{};H=F.Trait=F.Trait||{};I=F.Entity=F.Entity||{};J=F.Utterance=F.Utterance||{};K=F.Voice=F.Voice||{};L=K["Entity'"]=K["Entity'"]||{};M=F.Text=F.Text||{};N=M["Utterance'"]=M["Utterance'"]||{};O=M["Intent'"]=M["Intent'"]||{};P=M["Entity'"]=M["Entity'"]||{};Q=M["Trait'"]=M["Trait'"]||{};R=F.Domain=F.Domain||{};S=a.StartupCode$SMApp_Web$NLU=a.StartupCode$SMApp_Web$NLU||{};T=c.CUI=c.CUI||{};U=T.MicState=T.MicState||{};V=T.ClientState=T.ClientState||{};W=T.Interpreter=T.Interpreter||{};X=T.CUI=T.CUI||{};Y=c.Dialogue=c.Dialogue||{};Z=c.Question=c.Question||{};_0=c.QuestionType=c.QuestionType||{};_1=c.DialogueModule=c.DialogueModule||{};_2=c.Questions=c.Questions||{};_3=c.User=c.User||{};_4=a.StartupCode$SMApp_Web$User=a.StartupCode$SMApp_Web$User||{};_5=c.Symptoms=c.Symptoms||{};_6=a.StartupCode$SMApp_Web$Symptoms=a.StartupCode$SMApp_Web$Symptoms||{};_7=c.Main=c.Main||{};_8=a.StartupCode$SMApp_Web$Main=a.StartupCode$SMApp_Web$Main||{};_9=c.Client=c.Client||{};_=a.StartupCode$SMApp_Web$Client=a.StartupCode$SMApp_Web$Client||{};$=a.SMApp$Web_GeneratedPrintf=a.SMApp$Web_GeneratedPrintf||{};ba=a.GeneratedPrintf=a.GeneratedPrintf||{};bb=a.IntelliFactory;bc=bb&&bb.Runtime;bd=a.WebSharper;be=bd&&bd.Arrays;bf=bd&&bd.UI;bg=bf&&bf.Doc;bh=bf&&bf.AttrProxy;bi=bf&&bf.Client;bj=bi&&bi.Templates;bk=bd&&bd.Utils;bl=a.console;bm=a.jQuery;bn=bd&&bd.Strings;bo=bd&&bd.List;bp=bd&&bd.Seq;bq=bf&&bf.AttrModule;br=bd&&bd.Concurrency;bs=a.JSON;bt=bd&&bd.Random;bu=bd&&bd.Collections;bv=bu&&bu.Map;bw=bd&&bd.JavaScript;bx=bw&&bw.Pervasives;by=bd&&bd.ClientSideJson;bz=by&&by.Provider;bA=a.SDK;bB=bd&&bd.Unchecked;bC=bd&&bd.Operators;bD=bd&&bd.Remoting;bE=bD&&bD.AjaxRemotingProvider;bF=a.Wit;bG=a.document;bH=bu&&bu.Dictionary;d.getCameraCanvas=function(){return a.getCameraCanvas();};d.stopCamera=function(){return a.stopCamera();};d.startCamera=function(bI,bJ){return a.startCamera(bI,bJ);};d.speechSynthesis=function(){return a.speechSynthesis;};d.lastMicData=function(){return a.lastMicData;};d.questionBox=function(bI,bJ,bK,bL,bM,bN,bO,bP){var bQ,bR,bS,bT;bQ=(bR=(bS={},bS.titleText=bI,bS.text=bJ,bS.type="question",bS.width=a.String(bK),bS.html=(((bc.Curried3(function(bU,bV,bW){return bU("<div style=\"width:"+a.String(bV)+"px;height:"+a.String(bW)+"px\"></div>");}))(a.id))(bK))(bL),bS.input="text",bS.showCancelButton=true,bS.allowOutsideClick=false,bS.confirmButtonText="Ok",bS),(bM!=null?bM.$0(bR):void 0,bT=a.Sweetalert2(bR),bT));bN!=null?bN.$0():void 0;bQ.then(bO,bP);};d.getDialogueBoxInput=function(){return be.get(a.jQuery(".swal2-input").get(),0);};d.getDialogueBoxCanvas=function(){return be.get(a.jQuery("canvas.swal2-content").get(),0);};d.createDialogueBoxCanvas=function(){return d.createCanvas("camera","640","480",be.get(a.jQuery(".swal2-content").get(),0).firstChild);};d.createCanvas=function(bI,bJ,bK,bL){var bM;bM=bg.Element("canvas",[d.eid(bI),bh.Create("width",bJ),bh.Create("height",bK)],[]);bj.LoadLocalTemplates("");bg.Run(bL,bM);return bL.firstChild;};d.elementHTML=function(bI){return bI.innerHTML;};d.createElement=function(bI){var bJ;bJ=self.document.createElement("div");self.document.appendChild(bJ);bj.LoadLocalTemplates("");bg.RunAppend(bJ,bI);};d.container=function(bI){return bg.Element("div",[d.cls("container")],bI);};d.dindex=function(bI){return bh.Create("data-index",a.String(bI));};d.cls=function(bI){return bh.Create("class",bI);};d.eid=function(bI){return bh.Create("id",bI);};d.termOutput=function(){return be.get(a.jQuery(".terminal-output").get(),0);};d.toLower=function(bI){return bI.toLowerCase();};d.debug=function(bI,bJ){d.info((((bc.Curried3(function(bK,bL,bM){return bK("DEBUG: "+bk.toSafe(bL)+": "+bk.prettyPrint(bM));}))(a.id))(bI.toUpperCase()))(bJ));};d.error=function(bI){bl.error(bI);};d.info=function(bI){bl.info(bI);};d.jserror=function(bI){bm.error(bI);};d.toArray=function(bI){return be.map(a.id,bm.makeArray(bI));};d["Terminal.EchoHtml'"]=function(bI,bJ){bI.pause();bI.echo(bJ,d.rawOpt());bI.resume();};d["Terminal.Echo'"]=function(bI,bJ){bI.pause();bI.echo(bJ);bI.resume();};d.rawOpt=function(){g.$cctor();return g.rawOpt;};e=c._Html=bc.Class({toString:function(){return e.toString(this);}},null,e);e.toString=function(bI){function bJ(bK){return function(bL){var bM,bN,bO,bP,bQ,bR,bS;bN=bn.replicate(bK," ");switch(bL.$==0?bL.$1.$==1?bL.$1.$0.$==2?bL.$1.$1.$==0?(bM=[bL.$1.$0.$0,bL.$0],1):(bM=[bL.$1,bL.$0],2):(bM=[bL.$1,bL.$0],2):(bM=[bL.$1,bL.$0],2):bL.$==2?(bM=bL.$0,3):(bM=[bL.$0,bL.$1],0)){case 0:return bM[0]+"=\""+bM[1]+"\"";case 1:bO=bM[1];return bN+"<"+bO+">"+bM[0]+"</"+bO+">\r\n";case 2:bP=bM[1];bQ=bo.partition(function(bT){return bT.$==1;},bM[0]);bR=bQ[1];bS=bQ[0];return bR.$==0?bN+"<"+bP+(bS.$===0?"":" "+bn.concat(" ",bo.ofSeq(bp.delay(function(){return bp.map(function(bT){return(bJ(0))(bT);},bS);}))))+"/>\r\n":bN+"<"+bP+(bS.$===0?"":" "+bn.concat(" ",bo.ofSeq(bp.delay(function(){return bp.map(function(bT){return(bJ(0))(bT);},bS);}))))+">\r\n"+bn.concat("",bo.ofSeq(bp.delay(function(){return bp.map(function(bT){return(bJ(bK+1))(bT);},bR);})))+bN+"</"+bP+">\r\n";case 3:return bN+bM+"\r\n";}};}return(bJ(0))(bI);};f.alt=function(bI){return new e({$:1,$0:"alt",$1:bI});};f.src=function(bI){return new e({$:1,$0:"src",$1:bI});};f.cls=function(bI){return new e({$:1,$0:"class",$1:bI});};f.str=function(bI){return e.toString(bI);};f.op_PercentEquals=function(bI,bJ){return new e({$:1,$0:bI,$1:bJ});};f.op_Splice=function(bI){var bJ;return bo.ofArray([new e({$:2,$0:(bJ=bI,a.String(bJ))})]);};f.strong=function(){g.$cctor();return g.strong;};f.h4=function(){g.$cctor();return g.h4;};f.h3=function(){g.$cctor();return g.h3;};f.h2=function(){g.$cctor();return g.h2;};f.h1=function(){g.$cctor();return g.h1;};f.li=function(){g.$cctor();return g.li;};f.ul=function(){g.$cctor();return g.ul;};f.th=function(){g.$cctor();return g.th;};f.td=function(){g.$cctor();return g.td;};f.tr=function(){g.$cctor();return g.tr;};f.a=function(){g.$cctor();return g.a;};f.p=function(){g.$cctor();return g.p;};f.area=function(){g.$cctor();return g.area;};f.map=function(){g.$cctor();return g.map;};f.img=function(){g.$cctor();return g.img;};f.tfoot=function(){g.$cctor();return g.tfoot;};f.tbody=function(){g.$cctor();return g.tbody;};f.thead=function(){g.$cctor();return g.thead;};f.table=function(){g.$cctor();return g.table;};f.span=function(){g.$cctor();return g.span;};f.section=function(){g.$cctor();return g.section;};f.br=function(){g.$cctor();return g.br;};f.div=function(){g.$cctor();return g.div;};f.body=function(){g.$cctor();return g.body;};f.style=function(){g.$cctor();return g.style;};f.title=function(){g.$cctor();return g.title;};f.head=function(){g.$cctor();return g.head;};f.html=function(){g.$cctor();return g.html;};f.elem=function(bI,bJ){return new e({$:0,$0:bI,$1:bJ});};g.$cctor=function(){var bI;g.$cctor=a.ignore;g.rawOpt=(bI={},bI.raw=true,bI);g.html=function(bJ){return f.elem("html",bJ);};g.head=function(bJ){return f.elem("head",bJ);};g.title=function(bJ){return f.elem("title",bJ);};g.style=function(bJ){return f.elem("style",bJ);};g.body=function(bJ){return f.elem("body",bJ);};g.div=function(bJ){return f.elem("div",bJ);};g.br=function(bJ){return f.elem("br",bJ);};g.section=function(bJ){return f.elem("section",bJ);};g.span=function(bJ){return f.elem("span",bJ);};g.table=function(bJ){return f.elem("table",bJ);};g.thead=function(bJ){return f.elem("thead",bJ);};g.tbody=function(bJ){return f.elem("tbody",bJ);};g.tfoot=function(bJ){return f.elem("tfoot",bJ);};g.img=function(bJ){return f.elem("img",bJ);};g.map=function(bJ){return f.elem("map",bJ);};g.area=function(bJ){return f.elem("area",bJ);};g.p=function(bJ){return f.elem("p",bJ);};g.a=function(bJ){return f.elem("a",bJ);};g.tr=function(bJ){return f.elem("tr",bJ);};g.td=function(bJ){return f.elem("td",bJ);};g.th=function(bJ){return f.elem("th",bJ);};g.ul=function(bJ){return f.elem("ul",bJ);};g.li=function(bJ){return f.elem("li",bJ);};g.h1=function(bJ){return f.elem("h1",bJ);};g.h2=function(bJ){return f.elem("h1",bJ);};g.h3=function(bJ){return f.elem("h1",bJ);};g.h4=function(bJ){return f.elem("h1",bJ);};g.strong=function(bJ){return f.elem("strong",bJ);};};i.New=function(bI,bJ,bK,bL){return{name:bI,message:bJ,message_code:bK,status:bL};};j.New=function(bI,bJ,bK,bL,bM){return{message:bI,message_code:bJ,success:bK,count:bL,status:bM};};k.New=function(bI,bJ,bK,bL,bM,bN){return{message:bI,message_code:bJ,success:bK,result:bL,score:bM,confidence:bN};};h.getSameTextTypingPattern=function(bI,bJ){var bK;return bJ.getTypingPattern((bK={type:1},bK.text=bI,bK.caseSensitive=true,bK));};l.Radio=function(bI,bJ,bK,bL,bM){return bg.Element("div",new bo.T({$:1,$0:d.cls("radio"),$1:bJ}),[bg.Element("label",bL,[bg.Radio(bM,true,bK),bg.TextNode(bI)])]);};l.checkbox=function(bI,bJ,bK,bL,bM){return bg.Element("div",new bo.T({$:1,$0:d.cls("checkbox"),$1:bJ}),[bg.Element("label",bL,[bg.CheckBox(bM,bK),bg.TextNode(bI)])]);};l.textArea=function(bI,bJ,bK,bL,bM){return bg.Element("div",new bo.T({$:1,$0:d.cls("form-group"),$1:bJ}),[bg.Element("label",bL,[bg.TextNode(bI)]),bg.InputArea(new bo.T({$:1,$0:d.cls("form-control"),$1:bM}),bK)]);};l.inputPassword=function(bI,bJ,bK,bL,bM){return bg.Element("div",new bo.T({$:1,$0:d.cls("form-group"),$1:bJ}),[bg.Element("label",bL,[bg.TextNode(bI)]),bg.PasswordBox(new bo.T({$:1,$0:d.cls("form-control"),$1:bM}),bK)]);};l.input=function(bI,bJ,bK,bL,bM){return bg.Element("div",new bo.T({$:1,$0:d.cls("form-group"),$1:bJ}),[bg.Element("label",bL,[bg.TextNode(bI)]),bg.Input([d.cls("form-control"),bM],bK)]);};l.btnSecondary=function(bI,bJ,bK){return bg.Element("button",[d.eid(bI),d.cls("btn btn-secondary"),bq.Handler("click",bK)],[bg.TextNode(bJ)]);};l.btnPrimary=function(bI,bJ,bK){return bg.Element("button",[d.eid(bI),d.cls("btn btn-primary"),bq.Handler("click",bK)],[bg.TextNode(bJ)]);};o.New=function(bI,bJ,bK,bL,bM,bN,bO,bP,bQ){return{tokenFragment:bI,charFragment:bJ,babelSynsetID:bK,DBpediaURL:bL,BabelNetURL:bM,score:bN,cohrenceScore:bO,globalScore:bP,source:bQ};};p.New=function(bI,bJ){return{start:bI,end:bJ};};q.New=function(bI,bJ){return{start:bI,end:bJ};};n.disambiguate=function(bI){function bJ(bK,bL){var bM;bm.ajax((bM={},bM.url=(function(bN){return function(bO){return bN("https://babelfy.io/v1/disambiguate?text="+bk.toSafe(bO)+"&lang=EN&extAIDA=true&key=983fc0ec-a6fa-49ef-bd02-203c18aef272");};}(a.id))(bI),bM.type="GET",bM.success=function(bN){return bK(bN);},bM.error=function(bN){return bL(new a.Error(bN.responseText));},bM));}return br.FromContinuations(function(bK,bL,bM){return bJ.apply(null,[bK,bL,bM]);});};s.New=function(bI,bJ,bK,bL){return{text:bI,intents:bJ,entities:bK,traits:bL};};t.New=function(bI,bJ,bK){return{id:bI,name:bJ,confidence:bK};};u.New=function(bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS){return{id:bI,name:bJ,role:bK,start:bL,end:bM,body:bN,confidence:bO,entities:bP,suggested:bQ,value:bR,type:bS};};v.New=function(bI,bJ,bK){return{id:bI,value:bJ,confidence:bK};};w.New=function(bI){return{intent:bI};};x.New=function(bI){return{value:bI};};r.getMeaning2=function(bI,bJ){function bK(bL,bM){var bN;bm.ajax((bN={},bN.url=(function(bO){return function(bP){return bO("https://api.wit.ai/message?q="+bk.toSafe(bP));};}(a.id))(bJ),bN.type="GET",bN.beforeSend=function(bO){return bO.setRequestHeader("Authorization","Bearer "+bI);},bN.success=function(bO){return bL(bO);},bN.error=function(bO){return bM(new a.Error(bO.responseText));},bN));}return br.FromContinuations(function(bL,bM,bN){return bK.apply(null,[bL,bM,bN]);});};r.getMeaning=function(bI,bJ,bK,bL){var bM;bm.ajax((bM={},bM.url=(function(bN){return function(bO){return bN("https://api.wit.ai/message?q="+bk.toSafe(bO));};}(a.id))(bJ),bM.type="GET",bM.beforeSend=function(bN){return bN.setRequestHeader("Authorization","Bearer "+bI);},bM.success=bK,bM.error=bL,bM));};z.New=function(bI){return{question:bI};};A.New=function(bI,bJ){return{isContextOnly:bI,prompts:bJ};};B.New=function(bI,bJ,bK,bL,bM,bN,bO){return{questions:bI,answer:bJ,score:bK,id:bL,source:bM,metadata:bN,context:bO};};C.New=function(bI){return{answers:bI};};y.getAnswer=function(bI){function bJ(bK,bL){var bM;bm.ajax((bM={},bM.url="https://lerna.azurewebsites.net/qnamaker/knowledgebases/13a6a026-942b-4612-a8cb-654086ec76ee/generateAnswer",bM.type="POST",bM.beforeSend=function(bN){return bN.setRequestHeader("Authorization","EndpointKey e5a55563-b1b0-4343-8796-bda5a0509385");},bM.contentType="application/json",bM.dataType="json",bM.data=bs.stringify(z.New(bI)),bM.success=function(bN){return bK(bN);},bM.error=function(bN){return bL(new a.Error(bN.responseText));},bM));}return br.FromContinuations(function(bK,bL,bM){return bJ.apply(null,[bK,bL,bM]);});};D.waitAddPhrases=function(){E.$cctor();return E.waitAddPhrases;};D.waitRetrievePhrases=function(){E.$cctor();return E.waitRetrievePhrases;};D.helpPhrases=function(){E.$cctor();return E.helpPhrases;};D.helloUserPhrases=function(){E.$cctor();return E.helloUserPhrases;};D.helloPhrases=function(){E.$cctor();return E.helloPhrases;};D["getRandomPhrase'"]=function(bI){return D.replace_tok("$0","",bp.nth(D.rng().Next(0,bI.get_Length()),bI));};D.getRandomPhrase=function(bI,bJ){return D.replace_tok("$0",bJ,bp.nth(D.rng().Next(0,bI.get_Length()),bI));};D.replace_tok=function(bI,bJ,bK){return bn.Replace(bK,bI,bJ);};D.rng=function(){E.$cctor();return E.rng;};E.$cctor=function(){E.$cctor=a.ignore;E.rng=new bt.New();E.helloPhrases=bo.ofArray(["Welcome!","Welcome, my name is Selma.","Welcome to Selma. How can I help?","Hello this is Selma, how can I help?","Hello, I am Selma. How can I help?","Hello, I am Selma. How may I help you now?","I'm Selma. Tell me your name so we can get started."]);E.helloUserPhrases=bo.ofArray(["Hello $0, welcome back.","Welcome $0, nice to see you again.","Hello $0.","Good to see you $0.","Hello $0, nice to see you."]);E.helpPhrases=bo.ofArray(["What can I help you with $0?"]);E.waitRetrievePhrases=bo.ofArray(["Ok, let me check that $0 for you","Please wait while I check that $0 for you.","Wait while I check that $0.","Ok let me see if I can find that $0."]);E.waitAddPhrases=bo.ofArray(["Ok, let me add that $0 for you","Please wait while I add that $0 for you.","Wait while I add that $0.","I'll add that $0 now."]);};G=F.Intent=bc.Class({toString:function(){return(((bc.Curried3(function(bI,bJ,bK){return bI("Intent("+bk.toSafe(bJ)+", "+$.p$2(bK)+")");}))(a.id))(this.get_Name()))(this.get_Confidence());},get_Confidence:function(){return this.$1;},get_Name:function(){return this.$0;}},null,G);H=F.Trait=bc.Class({toString:function(){return(((bc.Curried3(function(bI,bJ,bK){return bI("Trait("+bk.toSafe(bJ)+", "+bk.prettyPrint(bK)+")");}))(a.id))(this.get_Name()))(this.get_Value());},get_Confidence:function(){return this.$2;},get_Value:function(){return this.$1;},get_Name:function(){return this.$0;}},null,H);I=F.Entity=bc.Class({toString:function(){return(((((bc.Curried(function(bI,bJ,bK,bL,bM){return bI("Entity("+bk.toSafe(bJ)+", "+bk.toSafe(bK)+", "+bk.toSafe(bL)+", "+$.p$2(bM)+")");},5))(a.id))(this.get_Name()))(this.get_Role()))(this.get_Value()))(this.get_Confidence());},get_Confidence:function(){return this.$3;},get_Value:function(){return this.$2;},get_Role:function(){return this.$1;},get_Name:function(){return this.$0;}},null,I);J=F.Utterance=bc.Class({toString:function(){return((((bc.Curried(function(bI,bJ,bK,bL){return bI($.p(bJ)+" "+$.p$3(bK)+" "+$.p$5(bL));},4))(a.id))(this.get_Intent()))(this.get_Traits()))(this.get_Entities());},get_Entities:function(){var bI;bI=this.$3;return bI!=null?{$:1,$0:bo.sortBy(function(bJ){return bJ.get_Name();},bI.$0)}:null;},get_Traits:function(){var bI;bI=this.$2;return bI!=null?{$:1,$0:bo.sortBy(function(bJ){return bJ.get_Name();},bI.$0)}:null;},get_Intent:function(){return this.$1;},get_Text:function(){return this.$0;}},null,J);L.New=function(bI,bJ,bK,bL,bM){return{body:bI,end:bJ,start:bK,suggested:bL,value:bM};};K["Intent'"]=function(bI,bJ){return!(bJ.intent==null)?{$:1,$0:new G({$:0,$0:d.toLower(bJ.intent.value),$1:null})}:null;};K["Trait'"]=function(bI){return!(bI.domain==null)?{$:1,$0:new H({$:0,$0:"domain",$1:d.toLower(bI.domain.value),$2:null})}:!(bI.dialogue_act==null)?{$:1,$0:new H({$:0,$0:"dialogue_act",$1:d.toLower(bI.dialogue_act.value),$2:null})}:null;};K["Entity'$1"]=function(bI){return!(bI.contact==null)?{$:1,$0:new I({$:0,$0:"contact",$1:"",$2:d.toLower(bI.contact.value),$3:null})}:null;};N=M["Utterance'"]=bc.Class({get_TopIntent:function(){return bo.head(bo.sortBy(function(bI){return bI.get_Confidence();},this.get_Intents()));},get_Traits:function(){return this.$3;},get_Entities:function(){return this.$2;},get_Intents:function(){return this.$1;},get_Text:function(){return this.$0;}},null,N);O=M["Intent'"]=bc.Class({get_Confidence:function(){return this.$1;},get_Name:function(){return this.$0;}},null,O);P=M["Entity'"]=bc.Class({get_Value:function(){return(this.get_Unwrap())[3];},get_Role:function(){return(this.get_Unwrap())[2];},get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1,this.$2,this.$3];}},null,P);Q=M["Trait'"]=bc.Class({get_Value:function(){return(this.get_Unwrap())[2];},get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1,this.$2];}},null,Q);M.HasUtterance=function(bI){var bJ,bK,bL,bM,bN,bO;return bI!=null&&bI.$==1&&(bI.$0.$2.get_Length()>0&&(bJ=[bI.$0.$2,bI.$0.$1,bI,bI.$0.$0,bI.$0.$3],true))?(bK=bJ[0],(bL=bJ[2],(bM=bJ[4],(bN=bJ[1].$==0?null:{$:1,$0:new G({$:0,$0:bL.$0.get_TopIntent().get_Name(),$1:{$:1,$0:bL.$0.get_TopIntent().get_Confidence()}})},(bO=bK.$==0?null:{$:1,$0:bo.map(function(bP){return new I({$:0,$0:bP.get_Name(),$1:d.toLower(bP.get_Role()),$2:bP.get_Value(),$3:{$:1,$0:bP.get_Confidence()}});},bo.filter(function(bP){return bP.get_Confidence()>M.entityConfidenceThreshold();},bK))},{$:1,$0:new J({$:0,$0:bJ[3],$1:bN,$2:bM.$==0?null:{$:1,$0:bo.map(function(bP){return new H({$:0,$0:d.toLower(bP.get_Name()),$1:bP.get_Value(),$2:{$:1,$0:bP.get_Confidence()}});},bo.filter(function(bP){return bP.get_Confidence()>M.entityConfidenceThreshold();},bM))},$3:bO})}))))):null;};M.entityConfidenceThreshold=function(){S.$cctor();return S.entityConfidenceThreshold;};M.set_entityConfidenceThreshold=function(bI){S.$cctor();S.entityConfidenceThreshold=bI;};M.intentConfidenceThreshold=function(){S.$cctor();return S.intentConfidenceThreshold;};M.set_intentConfidenceThreshold=function(bI){S.$cctor();S.intentConfidenceThreshold=bI;};M.getUtterance2=function(bI){var bJ;bJ=null;return br.Delay(function(){return br.Bind(r.getMeaning2("4Y2BLQY5TWLIN7HFIV264S53MY4PCUAT",bI),function(bK){d.debug("NLU",(function(bL){return function(bM){return bL("Wit.ai returned "+ba.p(bM)+" ");};}(a.id))(bK));return br.Return(new N({$:0,$0:bI,$1:bo.ofArray(be.map(function(bL){return new O({$:0,$0:bL.name,$1:bL.confidence});},bK.intents)),$2:bo.map(function(bL){return new P({$:0,$0:bL.name,$1:bL.confidence,$2:bL.role,$3:bL.value});},bo.ofSeq(bp.concat(bp.map(function(bL){return bL[1];},bv.ToSeq(bK.entities))))),$3:bo.ofSeq(bp.map(function(bL){var bM;bM=bL[1];return new Q({$:0,$0:bL[0],$1:be.get(bM,0).confidence,$2:be.get(bM,0).value});},bv.ToSeq(bK.traits)))}));});});};M.getUtterance=function(bI,bJ){r.getMeaning("OOGDHEQL7JZRQASXN2N2GHFUKGO3SCNV",bI,function(bK){var bL,bM;d.debug("NLU",(function(bN){return function(bO){return bN("Wit.ai returned: "+bk.prettyPrint(bO));};}(a.id))(bK));bL=!(bK.intents==null)?bo.ofArray(be.map(function(bN){return new O({$:0,$0:bN.name,$1:bN.confidence});},bK.intents)):bo.T.Empty;bM=!(bK.traits==null)?bo.ofSeq(bp.concat(bo.map(function(bN){return be.map(function(bO){return new Q({$:0,$0:bN,$1:bO.confidence,$2:bO.value});},bx.GetJS(bK.traits,[bN]));},bo.filter(function(bN){return!(bx.GetJS(bK.traits,[bN])==null);},M.trait_types())))):bo.T.Empty;return bJ({$:1,$0:new N({$:0,$0:bI,$1:bL,$2:!(bK.entities==null)?bo.ofSeq(bp.concat(bo.map(function(bN){return be.map(function(bO){return new P({$:0,$0:bO.name,$1:bO.confidence,$2:bO.role,$3:bO.value});},bx.GetJS(bK.entities,[bN]));},bo.filter(function(bN){return!(bx.GetJS(bK.entities,[bN])==null);},M.entity_types())))):bo.T.Empty,$3:bM})});},function(bK,bL,bM){d.error((((bc.Curried3(function(bN,bO,bP){return bN("Wit.ai returned: "+bk.prettyPrint(bO)+" "+bk.prettyPrint(bP));}))(a.id))(bL))(bM));return bJ(null);});};M.trait_types=function(){S.$cctor();return S.trait_types;};M.entity_types=function(){S.$cctor();return S.entity_types;};M.QuickNumber=function(bI){var bJ,bK,bL;return(bK=M.One(bI),bK!=null&&bK.$==1?(bJ=bK.$0,true):(bL=M.Two(bI),bL!=null&&bL.$==1&&(bJ=bL.$0,true)))?{$:1,$0:bJ}:null;};M.Three=function(bI){var bJ;return bI==="3"||bI==="three"?{$:1,$0:new J({$:0,$0:"three",$1:{$:1,$0:new G({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bo.ofArray([new I({$:0,$0:"wit/ordinal",$1:"",$2:"three",$3:{$:1,$0:1}})])}})}:null;};M.Two=function(bI){var bJ;return bI==="2"||bI==="two"?{$:1,$0:new J({$:0,$0:"two",$1:{$:1,$0:new G({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bo.ofArray([new I({$:0,$0:"wit/ordinal",$1:"",$2:"two",$3:{$:1,$0:1}})])}})}:null;};M.One=function(bI){var bJ;return bI==="1"||bI==="one"?{$:1,$0:new J({$:0,$0:"one",$1:{$:1,$0:new G({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bo.ofArray([new I({$:0,$0:"wit/ordinal",$1:"",$2:"one",$3:{$:1,$0:1}})])}})}:null;};M.QuickNo=function(bI){var bJ;return bI==="no"||(bI==="nope"||(bI==="no way"||(bI==="nah"||(bI==="don't do it"||bI==="stop"))))?{$:1,$0:new J({$:0,$0:"no",$1:{$:1,$0:new G({$:0,$0:"reject",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};M.QuickYes=function(bI){var bJ;return bI==="yes"||(bI==="ok"||(bI==="sure"||(bI==="yeah"||(bI==="yep"||(bI==="uh huh"||(bI==="go ahead"||bI==="go"))))))?{$:1,$0:new J({$:0,$0:"yes",$1:{$:1,$0:new G({$:0,$0:"verify",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};M.QuickHelp=function(bI){var bJ;return bI==="help"||(bI==="help me"||(bI==="what's this?"||bI==="huh"))?{$:1,$0:new J({$:0,$0:"help",$1:{$:1,$0:new G({$:0,$0:"help",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};M.QuickHello=function(bI){var bJ;return bI==="hello"||(bI==="hey"||(bI==="yo"||bI==="hi"))?{$:1,$0:new J({$:0,$0:"hello",$1:{$:1,$0:new G({$:0,$0:"greet",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};M.Voices=function(bI){return bI==="voices"?{$:1,$0:null}:null;};M.Debug=function(bI){return bI==="debug"?{$:1,$0:null}:null;};M.Blank=function(bI){return bI===""?{$:1,$0:null}:null;};R.Study=function(bI){return bI.get_Traits()!=null?{$:0,$0:null}:{$:1,$0:null};};F.StrA=function(bI){if(bI!=null&&bI.$==1)try{return{$:1,$0:((bz.DecodeArray(bz.Id()))())(bs.parse(bI.$0))};}catch(bJ){return null;}else return null;};F.PStr=function(bI){var bJ;return bI!=null&&bI.$==1&&(typeof bI.$0=="string"&&(bJ=bI.$0,true))?{$:1,$0:bJ}:null;};F.No=function(bI){var bJ,bK;return(bK=F.Intent$1("reject",bI),bK!=null&&bK.$==1&&(bK.$0[0]==null&&(bK.$0[1]==null&&(bJ=bI,true))))?{$:1,$0:bJ}:null;};F.Yes=function(bI){var bJ,bK;return(bK=F.Intent$1("verify",bI),bK!=null&&bK.$==1&&(bK.$0[0]==null&&(bK.$0[1]==null&&(bJ=bI,true))))?{$:1,$0:bJ}:null;};F.EntityManyofMany=function(bI,bJ){return{$:1,$0:bv.OfArray(be.ofSeq(bo.map(function(bK){return bo.exists(function(bL){return bL.get_Role()===bK;},bJ)?[bK,{$:1,$0:bo.filter(function(bL){return bL.get_Role()===bK;},bJ)}]:[bK,null];},bI)))};};F.EntityManyOf1=function(bI,bJ){var bK;return bJ!=null&&bJ.$==1&&(bo.exists(function(bL){return bL.get_Role()===bI;},bJ.$0)&&(bK=bJ.$0,true))?{$:1,$0:bo.filter(function(bL){return bL.get_Role()===bI;},bK)}:null;};F.Entity1OfAny=function(bI,bJ){var bK;return bJ!=null&&bJ.$==1&&(bo.exists(function(bL){return bL.get_Role()===bI;},bJ.$0)&&(bK=bJ.$0,true))?{$:1,$0:bo.head(bo.sortBy(function(bL){return bL.get_Role();},bo.filter(function(bL){return bL.get_Role()===bI;},bK)))}:null;};F.Entity1Of1=function(bI,bJ){var bK,bL;return bJ!=null&&bJ.$==1&&(bJ.$0.$==1&&(bJ.$0.$1.$==0&&((bL=bJ.$0.$0,bL.get_Role()===bI||bL.get_Name()===bI)&&(bK=bJ.$0.$0,true))))?{$:1,$0:bK}:null;};F.Intent$1=function(bI,bJ){return bJ.get_Intent()!=null&&bJ.get_Intent().$0.get_Name()===bI?{$:1,$0:[bJ.get_Traits(),bJ.get_Entities()]}:null;};S.$cctor=function(){S.$cctor=a.ignore;S.entity_types=bo.ofArray(["wit$contact:name","wit$datetime:datetime","term:subject","term:object","term:verb"]);S.trait_types=bo.ofArray(["domain","dialogue_act"]);S.intentConfidenceThreshold=0.85;S.entityConfidenceThreshold=0.85;};U.MicReady={$:5};U.MicAudioEnd={$:4};U.MicAudioStart={$:3};U.MicDisconnected={$:2};U.MicConnecting={$:1};U.MicNotInitialized={$:0};V.ClientUnderstand={$:2};V.ClientReady={$:1};V.ClientNotInitialzed={$:0};W=T.Interpreter=bc.Class({get_Options:function(){return(this.get_Unwrap())[2];},get_Text:function(){return(this.get_Unwrap())[1];},get_Voice:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1[0],this.$1[1]];}},null,W);X=T.CUI=bc.Class({GetSameTextTypingPattern:function(bI,bJ){var bK,bL;return this.TypingDNA.getTypingPattern(bJ==null?(bK={type:1},bK.text=bI,bK.caseSensitive=false,bK):(bL={type:1},bL.text=bI,bL.caseSensitive=false,bL.targetId=bJ.$0,bL));},MonitorTypingPattern:function(bI){this.TypingDNA.reset();bI!=null?this.TypingDNA.addTarget(bI.$0):void 0;this.TypingDNA.start();},SayVoices:function(){var bI,bJ,bK;bI=this;bJ=a.speechSynthesis.getVoices();!(bJ==null)?(bK=d.toArray(bJ),bI.Say((function(bL){return function(bM){return bL("There are currently "+a.String(bM)+" voices installed on this computer or device.");};}(a.id))(be.length(bK))),be.iteri(function(bL,bM){return bI.Say(((((bc.Curried(function(bN,bO,bP,bQ){return bN("Voice "+a.String(bO)+". Name: "+bk.toSafe(bP)+", Local: "+bk.prettyPrint(bQ)+".");},4))(a.id))(bL))(bM.name))(bM.localService));},bK)):void 0;},Wait:function(bI){this.Wait$1(function(){br.Start(bI,null);});},Wait$1:function(bI){this["Echo'"]("please wait...");this.Term.pause();bI();this.Term.resume();},sayRandom:function(bI,bJ){this.Say(D.getRandomPhrase(bI,bJ));},SayAngry:function(bI){var bJ,bK;bJ=this;br.Start((bK=null,br.Delay(function(){return br.Combine(a.speechSynthesis.speaking?(a.speechSynthesis.cancel(),bA.chime(),br.Zero()):br.Zero(),br.Delay(function(){a.addMessage(bJ.Avatar,bI,"","");bJ.Avatar.processMessages(0);return br.Zero();}));})),null);},SayDoc:function(bI){var bJ,bK,bL;bJ=be.get(bm(".terminal-output").get(),0).childNodes.length;bK=bg.Element("div",[d.cls("terminal-command"),d.dindex(bJ+1)],[bI]);bL=d.termOutput();bj.LoadLocalTemplates("");bg.RunAppend(bL,bK);},Say:function(bI){var bJ,bK;bJ=this;br.Start((bK=null,br.Delay(function(){return br.Combine(a.speechSynthesis.speaking?(bA.chime(),br.Zero()):br.Zero(),br.Delay(function(){bJ.Avatar.addMessage(bI);bJ.Avatar.processMessages(0);return br.Zero();}));})),null);},Debug:function(bI,bJ){d.debug(bI,bJ);},"EchoHtml'":function(bI){var bJ,bK;bJ=(bK={},bK.raw=true,bK);this.Term.disable();this.Term.echo(bI,bJ);this.Term.enable();},"Echo'":function(bI){this.Term.disable();this.Term.echo(bI);this.Term.enable();}},null,X);X.New=function(bI,bJ,bK,bL,bM,bN,bO){return new X({Voice:bI,Mic:bJ,Term:bK,Avatar:bL,Caption:bM,TypingDNA:bN,AudioEnd:bO});};Y=c.Dialogue=bc.Class({get_Utterances:function(){return this.$4;},get_Output:function(){return this.$3;},get_DialogueQuestions:function(){return this.$2;},get_Props:function(){return this.$1;},get_Cui:function(){return this.$0;}},null,Y);Z=c.Question=bc.Class({toString:function(){return((((bc.Curried(function(bI,bJ,bK,bL){return bI("Name: "+bk.toSafe(bJ)+" Module: "+bk.toSafe(bK)+" Type: "+$.p$8(bL)+" ");},4))(a.id))(this.get_Name()))(this.get_Module()))(this.get_Type());},get_Target:function(){return this.$3;},get_Type:function(){return this.$2;},get_Module:function(){return this.$1;},get_Name:function(){return this.$0;}},null,Z);_0.ConceptCompletion={$:3};_0.Disjunctive={$:2};_0.Verification={$:1};_1["Response'_"]=function(bI,bJ,bK){var bL,bM,bN,bO,bP,bQ,bR,bS;return(bM=_1.PropNotSet_(bI,"user",bK),bM!=null&&bM.$==1?(bN=_1.Form(bI,bJ,bM.$0),bN!=null&&bN.$==1?(bL=bN.$0,true):(bO=_1.PropNotSet_(bI,"user",bK),bO!=null&&bO.$==1&&(bP=_1.NotForm(bI,bJ,bO.$0),bP!=null&&bP.$==1&&(bL=bP.$0,true)))):(bQ=_1.PropNotSet_(bI,"user",bK),bQ!=null&&bQ.$==1&&(bR=_1.NotForm(bI,bJ,bQ.$0),bR!=null&&bR.$==1&&(bL=bR.$0,true))))?(bS=_1.have(bI,bJ)?{$:1,$0:_1.prop(bI,bJ)}:null,bL.get_Text()!==""?{$:1,$0:[bL,{$:1,$0:bL.get_Text()},bS]}:{$:1,$0:[bL,null,bS]}):null;};_1.Response_=function(bI,bJ,bK){var bL,bM,bN,bO,bP,bQ,bR,bS;return(bM=_1.PropSet_(bI,"user",bK),bM!=null&&bM.$==1?(bN=_1.Form(bI,bJ,bM.$0),bN!=null&&bN.$==1?(bL=bN.$0,true):(bO=_1.PropSet_(bI,"user",bK),bO!=null&&bO.$==1&&(bP=_1.NotForm(bI,bJ,bO.$0),bP!=null&&bP.$==1&&(bL=bP.$0,true)))):(bQ=_1.PropSet_(bI,"user",bK),bQ!=null&&bQ.$==1&&(bR=_1.NotForm(bI,bJ,bQ.$0),bR!=null&&bR.$==1&&(bL=bR.$0,true))))?(bS=_1.have(bI,bJ)?{$:1,$0:_1.prop(bI,bJ)}:null,bL.get_Text()!==""?{$:1,$0:[bL,{$:1,$0:bL.get_Text()},bS]}:{$:1,$0:[bL,null,bS]}):null;};_1.NotForm=function(bI,bJ,bK){return bI.get_DialogueQuestions().length>0&&(bI.get_DialogueQuestions())[0].get_Name()===bJ&&bK.get_Text()!==""?{$:1,$0:bK}:null;};_1.Form=function(bI,bJ,bK){return bI.get_DialogueQuestions().length>0&&(bI.get_DialogueQuestions())[0].get_Name()===bJ&&bK.get_Intent()!=null&&bK.get_Intent().$0.get_Name()===bJ&&bB.Equals(bK.get_Intent().$0.get_Confidence(),{$:1,$0:1})&&bB.Equals(bK.get_Traits(),null)&&bB.Equals(bK.get_Entities(),null)?{$:1,$0:bK}:null;};_1["User'_"]=function(bI,bJ){var bK,bL;return(bL=_1.PropNotSet_(bI,"user",bJ),bL!=null&&bL.$==1&&(bI.get_DialogueQuestions().length===0&&(bK=bL.$0,true)))?{$:1,$0:bK}:null;};_1.User_=function(bI,bJ){var bK,bL;return(bL=_1.PropSet_(bI,"user",bJ),bL!=null&&bL.$==1&&(bI.get_DialogueQuestions().length===0&&(bK=bL.$0,true)))?{$:1,$0:bK}:null;};_1.PropNotSet_=function(bI,bJ,bK){return!_1.have(bI,bJ)?{$:1,$0:bK}:null;};_1.PropSet_=function(bI,bJ,bK){return _1.have(bI,bJ)?{$:1,$0:bK}:null;};_1.Agenda_=function(bI,bJ,bK,bL){return bI.get_DialogueQuestions().length>0&&(bI.get_DialogueQuestions())[0].get_Module()===bK?{$:1,$0:null}:null;};_1.debugInterpreterEnd=function(bI,bJ,bK){bJ(((((bc.Curried(function(bL,bM,bN,bO){return bL(bk.toSafe(bM)+" ending utterances:"+bk.prettyPrint(bN)+", questions: "+bk.prettyPrint(bO)+".");},4))(a.id))(bK))(bI.get_Utterances()))(bI.get_DialogueQuestions()));};_1.debugInterpreterStart=function(bI,bJ,bK){bJ(((((bc.Curried(function(bL,bM,bN,bO){return bL(bk.toSafe(bM)+" starting utterances:"+bk.prettyPrint(bN)+", questions: "+bk.prettyPrint(bO)+".");},4))(a.id))(bK))(bI.get_Utterances()))(bI.get_DialogueQuestions()));};_1.frame=function(bI){return bo.ofSeq(bp.take(bI.length>=5?5:bI.length,bI));};_1.didNotUnderstand=function(bI,bJ,bK){bJ((function(bL){return function(bM){return bL(bk.toSafe(bM)+" interpreter did not understand utterance.");};}(a.id))(bK));_1.popu(bI,bJ);_1.say(bI,"Sorry I didn't understand what you meant.");};_1.endt=function(bI,bJ,bK,bL){_1.popu(bI,bJ);_1.popq(bI,bJ);_1.have(bI,bK)?_1.remove(bI,bJ,bK):void 0;bJ((function(bM){return function(bN){return bM("End turn "+bk.toSafe(bN)+".");};}(a.id))(bK));bL();};_1.cancel=function(bI,bJ,bK){var bL;bL=(bI.get_DialogueQuestions())[0];bL.get_Name()!==bK?(((bc.Curried3(function(bM,bN,bO){return bM($.p$9(bN)+" at the top of the stack does not have the name "+bk.toSafe(bO)+".");}))(bC.FailWith))(bL))(bK):void 0;_1.popq(bI,bJ);bJ((function(bM){return function(bN){return bM("Cancel "+$.p$9(bN)+".");};}(a.id))(bL));};_1.trigger=function(bI,bJ,bK,bL,bM){_1.pushu(bI,bJ,new J({$:0,$0:bs.stringify(bM),$1:{$:1,$0:new G({$:0,$0:bL,$1:{$:1,$0:1}})},$2:null,$3:null}));bK(bI);};_1.handle=function(bI,bJ,bK,bL){_1.popu(bI,bJ);bJ((function(bM){return function(bN){return bM("Handle utterance "+bk.toSafe(bN)+".");};}(a.id))(bK));bL();};_1.dispatch=function(bI,bJ,bK,bL){bJ(((((bc.Curried(function(bM,bN,bO,bP){return bM("Dispatch to module "+bk.toSafe(bN)+" utterances: "+bk.prettyPrint(bO)+" questions: "+bk.prettyPrint(bP)+".");},4))(a.id))(bK))(bI.get_Utterances()))(bI.get_DialogueQuestions()));bL(bI);};_1.popq=function(bI,bJ){var bK;bK=bI.get_DialogueQuestions().shift();bJ((function(bL){return function(bM){return bL("Pop "+$.p$9(bM)+".");};}(a.id))(bK));};_1.pushq=function(bI,bJ,bK){bI.get_DialogueQuestions().unshift(bK);bJ((function(bL){return function(bM){return bL("Push "+$.p$9(bM)+".");};}(a.id))(bK));};_1.popu=function(bI,bJ){var bK;bK=bI.get_Utterances().shift();bJ((function(bL){return function(bM){return bL("Pop "+$.p$7(bM)+".");};}(a.id))(bK));};_1.pushu=function(bI,bJ,bK){bJ((function(bL){return function(bM){return bL("Push "+$.p$7(bM)+".");};}(a.id))(bK));bI.get_Utterances().unshift(bK);};_1.remove=function(bI,bJ,bK){bJ((function(bL){return function(bM){return bL("Remove property "+bk.toSafe(bM)+".");};}(a.id))(bK));bI.get_Props().Remove(bK);};_1.add=function(bI,bJ,bK,bL){bI.get_Props().Add(bK,bL);bJ((((bc.Curried3(function(bM,bN,bO){return bM("Add property "+bk.toSafe(bN)+":"+bk.prettyPrint(bO)+".");}))(a.id))(bK))(bL));};_1.prop=function(bI,bJ){return bI.get_Props().ContainsKey(bJ)?bI.get_Props().get_Item(bJ):(function(bK){return function(bL){return bK("The "+bk.toSafe(bL)+" dialogue property does not exist.");};}(bC.FailWith))(bJ);};_1.have=function(bI,bJ){return bI.get_Props().ContainsKey(bJ);};_1["sayRandom'"]=function(bI,bJ){_1.sayRandom(bI,bJ,"");};_1.sayRandom=function(bI,bJ,bK){var bL;bL=D.getRandomPhrase(bJ,bK);bI.get_Output().unshift(bL);bI.get_Cui().Say(bL);};_1.say=function(bI,bJ){bI.get_Output().unshift(bJ);_1["say'"](bI,bJ);};_1["say'"]=function(bI,bJ){bI.get_Cui().Say(bJ);};_1.echo=function(bI,bJ){(bI.get_Cui())["EchoHtml'"](bJ);};_2.ask=function(bI,bJ,bK){var bL;_1.pushq(bI,bJ,bK);bL=bK.get_Type();bL.$==0?_2.userAuthenticationDialogue(bI,bJ,bK,bL.$0):bC.FailWith("Not implemented");};_2.userAuthenticationDialogue=function(bI,bJ,bK,bL){var bM,bN,bO,bP;function bQ(bU){_1.say(bI,bU);}function bR(bU){_1.cancel(bI,bJ,bU);}function bS(){var bU;bI.get_Cui().MonitorTypingPattern(null);bU=d.createDialogueBoxCanvas();d.startCamera(self.document.body,bU);}function bT(){d.questionBox("Biometric Authentication","",640,480,null,{$:1,$0:bS},function(bU){var bV,bW;bV=d.getCameraCanvas().toDataURL();bJ((function(bX){return function(bY){return bX("User image is "+bk.toSafe(bY)+"...");};}(a.id))(bn.Substring(bV,0,10)));d.stopCamera();bW=bI.get_Cui().GetSameTextTypingPattern(bP,null);bJ((((bc.Curried3(function(bX,bY,bZ){return bX("User entered typing pattern "+bk.toSafe(bY)+" for text "+bk.toSafe(bZ));}))(a.id))(bW))(bU));bU.toLowerCase()!==bP.toLowerCase()?(bQ("Sorry you did not enter the passphrase correctly. Please try again."),bT()):bM([bL,bW,bV]);},function(){d.stopCamera();bQ((function(bU){return function(bV){return bU("Ok I did not add the user "+bk.toSafe(bV)+". But you must login for me to help you.");};}(a.id))(bL));bR(bK.get_Name());});}bM=(bN=bK.get_Target(),(bO=bK.get_Name(),function(bU){_1.trigger(bI,bJ,bN,bO,bU);}));bP=(function(bU){return function(bV){return bU("Hello my name is "+bk.toSafe(bV)+" and I am an administrator");};}(a.id))(bL);bQ((function(bU){return function(bV){return bU("Enter the phrase "+bk.toSafe(bV)+".");};}(a.id))(bP));bT();};_3.update=function(bI){var bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj;function ck(cv){_1.say(bI,cv);}function cl(cv,cw){return _1.sayRandom(bI,cv,cw);}function cm(cv,cw){return _1.add(bI,function(cx){_3.debug(cx);},cv,cw);}function cn(cv){_3.debug(cv);}function co(cv){_3.debug(cv);}function cp(cv){_3.debug(cv);}function cq(cv){return _1["User'_"](bI,cv);}function cr(cv,cw){return _1.Response_(bI,cv,cw);}function cs(cv,cw){return _1["Response'_"](bI,cv,cw);}function ct(cv){var cw;cl(D.waitRetrievePhrases(),"user name");br.Start((cw=null,br.Delay(function(){return br.Bind((new bE.New()).Async("SMApp.Web:SMApp.Web.Server.getUser:-1783153049",[cv]),function(cx){var cy;return cx==null?(ck((function(cz){return function(cA){return cz("I did not find a user with the name "+bk.toSafe(cA)+".");};}(a.id))(cv)),bL(new Z({$:0,$0:"addUser",$1:_3.name(),$2:_0.Verification,$3:function(){cm("addUser",cv);ck((function(cz){return function(cA){return cz("Do you want me to add the user "+bk.toSafe(cA)+"?");};}(a.id))(cv));}})),br.Zero()):(cy=cx.$0,br.Bind((new bE.New()).Async("SMApp.Web:SMApp.Web.Server.updateUserLastLogin:1024486337",[cy.Name]),function(){cl(D.helloUserPhrases(),(function(cz){return function(cA){return cz(bk.prettyPrint(cA));};}(a.id))(cy.Name));return cy.LastLoggedIn!=null?br.Bind((new bE.New()).Async("SMApp.Web:SMApp.Web.Server.humanize:187368003",[cy.LastLoggedIn.$0]),function(cz){ck((function(cA){return function(cB){return cA("You last logged in "+bk.toSafe(cB)+".");};}(a.id))(cz));bL(new Z({$:0,$0:"authenticateUser",$1:_3.name(),$2:{$:0,$0:cv},$3:function(cA){_3.update(cA);}}));return br.Zero();}):br.Zero();}));});})),null);}function cu(cv){return new Z({$:0,$0:"switchUser",$1:_3.name(),$2:_0.Verification,$3:function(){ck((function(cw){return function(cx){return cw("Do you want me to switch to the user "+bk.toSafe(cx));};}(a.id))(cv));}});}_1.debugInterpreterStart(bI,function(cv){_3.debug(cv);},_3.name());bJ=bc.Curried(_1.handle,2,[bI,cn]);bK=bc.Curried(_1.endt,2,[bI,co]);bL=function(cv){_2.ask(bI,cp,cv);};bM=_1.frame(bI.$4);bM.$==1&&(bO=cq(bM.$0),bO!=null&&bO.$==1&&(bP=F.Intent$1("greet",bO.$0),bP!=null&&bP.$==1&&(bQ=F.Entity1Of1("name",bP.$0[1]),bQ!=null&&bQ.$==1&&(bM.$1.$==0&&(bN=bQ.$0,true)))))?(bJ("loginUser"))(function(){ct(bN.get_Value());}):bM.$==1&&(bS=cq(bM.$0),bS!=null&&bS.$==1&&(bT=F.Intent$1("hello",bS.$0),bT!=null&&bT.$==1&&(bU=F.Entity1Of1("contact",bT.$0[1]),bU!=null&&bU.$==1&&(bM.$1.$==0&&(bR=bU.$0,true)))))?(bJ("loginUser"))(function(){ct(bR.get_Value());}):bM.$==1&&(bW=cs("authenticateUser",bM.$0),bW!=null&&bW.$==1&&(bX=F.StrA(bW.$0[1]),bX!=null&&bX.$==1&&(bM.$1.$==0&&(bV=bX.$0,true))))?(bK("authenticateUser"))(function(){var cv;ck((function(cw){return function(cx){return cw("Authenticate user "+bk.toSafe(cx)+".");};}(a.id))(be.get(bV,0)));br.Start((cv=null,br.Delay(function(){return(new bE.New()).Async("SMApp.Web:SMApp.Web.Server.detectFaceAttributes:-1388372182",[be.get(bV,2)]);})),null);}):bM.$==1&&(bZ=F.No(bM.$0),bZ!=null&&bZ.$==1&&(b0=cs("addUser",bZ.$0),b0!=null&&b0.$==1&&(b1=F.PStr(b0.$0[2]),b1!=null&&b1.$==1&&(bM.$1.$==0&&(bY=b1.$0,true)))))?(bK("addUser"))(function(){ck((function(cv){return function(cw){return cv("Ok I did not add the user "+bk.toSafe(cw)+". But you must login for me to help you.");};}(a.id))(bY));}):bM.$==1&&(b3=F.Yes(bM.$0),b3!=null&&b3.$==1&&(b4=cs("addUser",b3.$0),b4!=null&&b4.$==1&&(b5=F.PStr(b4.$0[2]),b5!=null&&b5.$==1&&(bM.$1.$==0&&(b2=b5.$0,true)))))?(bK("addUser"))(function(){bL(new Z({$:0,$0:"authenticateNewUser",$1:_3.name(),$2:{$:0,$0:b2},$3:function(cv){_3.update(cv);}}));}):bM.$==1&&(b7=cs("authenticateNewUser",bM.$0),b7!=null&&b7.$==1&&(b8=F.StrA(b7.$0[1]),b8!=null&&b8.$==1&&(bM.$1.$==0&&(b6=b8.$0,true))))?(bK("authenticateNewUser"))(function(){ck((function(cv){return function(cw){return cv("Authenticate new user "+bk.toSafe(cw)+".");};}(a.id))(be.get(b6,0)));}):bM.$==1&&(b_=_1.User_(bI,bM.$0),b_!=null&&b_.$==1&&(b$=F.Intent$1("hello",b_.$0),b$!=null&&b$.$==1&&(b$.$0[0]==null&&(ca=F.Entity1Of1("name",b$.$0[1]),ca!=null&&ca.$==1&&(bM.$1.$==0&&(b9=ca.$0,true))))))?br.Start((cb=null,br.Delay(function(){return br.Bind((new bE.New()).Async("SMApp.Web:SMApp.Web.Server.getUser:-1783153049",[b9.get_Value()]),function(cv){return cv==null?(ck((function(cw){return function(cx){return cw("Sorry, the user "+bk.toSafe(cx)+" does not exist.");};}(a.id))(b9.get_Value())),br.Zero()):(bL(cu(cv.$0.Name)),br.Zero());});})),null):bM.$==1&&(cd=F.Yes(bM.$0),cd!=null&&cd.$==1&&(ce=cr("switchUser",cd.$0),ce!=null&&ce.$==1&&(cf=F.PStr(ce.$0[2]),cf!=null&&cf.$==1&&(bM.$1.$==0&&(cc=cf.$0,true)))))?(bI.$1.set_Item("user",cc),ck((function(cv){return function(cw){return cv("Ok I switched to user "+bk.prettyPrint(cw)+".");};}(a.id))(cc))):bM.$==1&&(ch=F.No(bM.$0),ch!=null&&ch.$==1&&(ci=cr("switchUser",ch.$0),ci!=null&&ci.$==1&&(cj=F.PStr(ci.$0[2]),cj!=null&&cj.$==1&&(bM.$1.$==0&&(cg=cj.$0,true)))))?ck((function(cv){return function(cw){return cv("Ok I did not switch to user "+bk.toSafe(cw)+".");};}(a.id))(cg)):_1.didNotUnderstand(bI,function(cv){_3.debug(cv);},_3.name());_1.debugInterpreterEnd(bI,function(cv){_3.debug(cv);},_3.name());};_3.debug=function(bI){d.debug(_3.name(),bI);};_3.name=function(){_4.$cctor();return _4.name;};_4.$cctor=function(){_4.$cctor=a.ignore;_4.name="User";};_5.update=function(bI){var bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ;function b0(b7){_1.echo(bI,b7);}function b1(b7){_1.say(bI,b7);}function b2(b7,b8){return _1.sayRandom(bI,b7,b8);}function b3(b7){return _1.prop(bI,b7);}function b4(b7){return _1.User_(bI,b7);}function b5(){return b3("user");}function b6(b7,b8,b9){var b_;return br.Start((b_=null,br.Delay(function(){b2(D.waitAddPhrases(),"symptom entry");return br.Bind((new bE.New()).Async("SMApp.Web:SMApp.Web.Server.addSymptomJournalEntry:525459844",[b5().Name,b7,b8,b9]),function(b$){return b$.$==1?(b1(function(ca){return ca("Sorry I wasn't able to add that symptom to your journal. Could you try again?");}(a.id)),br.Zero()):(b1((function(ca){return function(cb){return ca("OK I added that "+bk.toSafe(cb)+" symptom to your journal.");};}(a.id))(b7)),br.Zero());});})),null);}_1.debugInterpreterStart(bI,function(b7){_5.debug(b7);},_5.name());bJ=_1.frame(bI.$4);bJ.$==1&&(bL=b4(bJ.$0),bL!=null&&bL.$==1&&(bM=F.Intent$1("symptom",bL.$0),bM!=null&&bM.$==1&&(bN=F.Entity1OfAny("symptom_name",bM.$0[1]),bN!=null&&bN.$==1&&(bJ.$1.$==0&&(bK=bN.$0,true)))))?br.Start((bO=null,br.Delay(function(){b1("Ok I'll add that entry to your symptom journal");b6(bK.get_Value(),null,null);return br.Zero();})),null):bJ.$==1&&(bQ=F.Yes(bJ.$0),bQ!=null&&bQ.$==1&&((bR=_1.Response_(bI,"painVideo",bQ.$0),bR!=null&&bR.$==1)&&bJ.$1.$==0))?bI.$0["EchoHtml'"]("<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/SkAqOditKN0\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>"):bJ.$==1&&(bT=b4(bJ.$0),bT!=null&&bT.$==1&&(bU=F.Intent$1("medjournal",bT.$0),bU!=null&&bU.$==1&&((bV=bU.$0[1],bV!=null&&bV.$==1)&&(bJ.$1.$==0&&(bS=bU.$0[1].$0,true)))))?(b1("ok I added that entry to your medication journal."),b1("You should be careful not to take too many painkillers over a short period of time.")):bJ.$==1&&(bX=b4(bJ.$0),bX!=null&&bX.$==1&&((bY=F.Intent$1("kbquery",bX.$0),bY!=null&&bY.$==1)&&(bJ.$1.$==0&&(bW=bX.$0,true))))?br.Start((bZ=null,br.Delay(function(){return br.Bind(y.getAnswer(bW.get_Text()),function(b7){var b8;return br.Bind((b8=be.get(b7.answers,0).answer,(new bE.New()).Async("SMApp.Web:SMApp.Web.Server.mdtohtml:-193959774",[b8])),function(b9){var b_;return br.Bind((b_=be.get(b7.answers,0).answer,(new bE.New()).Async("SMApp.Web:SMApp.Web.Server.mdtotext:-193959774",[b_])),function(b$){b0(b9);b1(b$);return br.Zero();});});});})),null):_1.didNotUnderstand(bI,function(b7){_5.debug(b7);},_5.name());_1.debugInterpreterEnd(bI,function(b7){_5.debug(b7);},_5.name());};_5.debug=function(bI){d.debug(_5.name(),bI);};_5.name=function(){_6.$cctor();return _6.name;};_6.$cctor=function(){_6.$cctor=a.ignore;_6.name="Symptoms";};_7.update=function(bI){var bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3;function b4(b9){_1.say(bI,b9);}function b5(b9){_1["sayRandom'"](bI,b9);}function b6(b9){_7.debug(b9);}function b7(b9){_7.debug(b9);}function b8(b9){return _1["User'_"](bI,b9);}bJ=bI.$4;_7.debug(((((bc.Curried(function(b9,b_,b$,ca){return b9("Module "+bk.toSafe(b_)+" starting utterances:"+bk.prettyPrint(b$)+", questions: "+bk.prettyPrint(ca)+".");},4))(a.id))(_7.name()))(bJ))(bI.$2));bK=bc.Curried(_1.dispatch,2,[bI,b6]);bL=bc.Curried(_1.handle,2,[bI,b7]);bM=_1.frame(bJ);bN=_1.Agenda_(bI,function(b9){_7.debug(b9);},_3.name(),bM);bN!=null&&bN.$==1?(_7.debug((function(b9){return function(b_){return b9("Agenda is "+$.p$9(b_)+".");};}(a.id))((bI.get_DialogueQuestions())[0])),_3.update(bI)):bM.$==1&&(bP=(bQ=_1.PropNotSet_(bI,"started",bM.$0),bQ!=null&&bQ.$==1?{$:1,$0:bQ.$0}:null),bP!=null&&bP.$==1&&(bR=b8(bP.$0),bR!=null&&bR.$==1&&(bS=F.Intent$1("greet",bR.$0),bS!=null&&bS.$==1&&(bS.$0[1]==null&&bM.$1.$==0))))?(_1.add(bI,function(b9){_7.debug(b9);},"started",true),(bL("greet"))(function(){b5(D.helloPhrases());})):bM.$==1&&(bU=b8(bM.$0),bU!=null&&bU.$==1&&(bV=F.Intent$1("greet",bU.$0),bV!=null&&bV.$==1&&(bV.$0[1]==null&&bM.$1.$==0)))?(bL("greet"))(function(){b4("Hello, tell me your name to get started.");}):bM.$==1&&(bX=b8(bM.$0),bX!=null&&bX.$==1&&(bY=F.Intent$1("greet",bX.$0),bY!=null&&bY.$==1&&((bZ=F.Entity1Of1("name",bY.$0[1]),bZ!=null&&bZ.$==1)&&bM.$1.$==0)))?(bK(_3.name()))(function(b9){_3.update(b9);}):bM.$==1&&(b1=b8(bM.$0),b1!=null&&b1.$==1&&(b2=F.Intent$1("hello",b1.$0),b2!=null&&b2.$==1&&((b3=F.Entity1Of1("contact",b2.$0[1]),b3!=null&&b3.$==1)&&bM.$1.$==0)))?(bK(_3.name()))(function(b9){_3.update(b9);}):_1.didNotUnderstand(bI,function(b9){_7.debug(b9);},_7.name());_1.debugInterpreterEnd(bI,function(b9){_7.debug(b9);},_7.name());};_7.debug=function(bI){d.debug(_7.name(),bI);};_7.name=function(){_8.$cctor();return _8.name;};_8.$cctor=function(){_8.$cctor=a.ignore;_8.name="Main";};_9.run=function(){var bI,bJ;bI=bc.ThisFunc(function(bK,bL){return((_9.Main().get_Text())(bK))(bL);});bJ=_9.Main().get_Options();a.$("#term").terminal(bI,bJ);return bg.get_Empty();};_9.Main=function(){_.$cctor();return _.Main;};_9.initMic=function(bI){var bJ,bK;_9.set_CUI((bJ={$:1,$0:new bF.Microphone(bG.getElementById("microphone"))},X.New(_9.CUI().Voice,bJ,_9.CUI().Term,_9.CUI().Avatar,_9.CUI().Caption,_9.CUI().TypingDNA,_9.CUI().AudioEnd)));bK=_9.CUI().Mic.$0;bK.onconnecting=function(){_9.set_MicState(U.MicConnecting);return _9.debug("Mic connecting...");};bK.ondisconnected=function(){_9.set_MicState(U.MicDisconnected);return _9.debug("Mic disconnected.");};bK.onaudiostart=function(){_9.set_MicState(U.MicAudioStart);return _9.debug("Mic audio start...");};bK.onaudioend=function(){_9.set_MicState(U.MicAudioEnd);_9.debug("Mic audio end.");return _9.debug(self.lastMicData);};bK.onerror=function(bL){_9.set_MicState({$:6,$0:bL});return _9.debug((function(bM){return function(bN){return bM("Mic error : "+bk.toSafe(bN)+".");};}(a.id))(bL));};bK.onready=function(){_9.set_MicState(U.MicReady);return _9.debug("Mic ready.");};bK.onresult=function(bL,bM){return _9.ClientState().$==2?_9.echo("I'm still trying to understand what you said before."):_9.ClientState().$==0?d.error("Client is not intialized."):!(bL==null||bM==null)?(_9.set_MicState({$:7,$0:bL,$1:bM}),_9.debug((((bc.Curried3(function(bN,bO,bP){return bN("Mic result: "+bk.prettyPrint(bO)+" "+bk.prettyPrint(bP)+".");}))(a.id))(bL))(bM)),bI(bL,bM)):_9.debug("Mic: No result returned.");};bK.connect("4Y2BLQY5TWLIN7HFIV264S53MY4PCUAT");};_9.sayRandom=function(bI,bJ){_9.say(D.getRandomPhrase(bJ,bI));};_9.say=function(bI){_9.Output().unshift(bI);_9["say'"](bI);};_9["say'"]=function(bI){_9.CUI().Say(bI);};_9.initSpeech=function(){var bI;bI=d.toArray(_9.synth().getVoices());be.length(bI)>0?(be.iter(function(bJ){if(bB.Equals(_9.CUI().Voice,null)&&(bJ.name.indexOf("Microsoft Zira")!=-1||bJ.name.toLowerCase().indexOf("female")!=-1)){_9.set_CUI(X.New({$:1,$0:bJ},_9.CUI().Mic,_9.CUI().Term,_9.CUI().Avatar,_9.CUI().Caption,_9.CUI().TypingDNA,_9.CUI().AudioEnd));_9.debug((function(bK){return function(bL){return bK("Using browser speech synthesis voice "+bk.toSafe(bL)+".");};}(a.id))(_9.CUI().Voice.$0.name));}},bI),!bB.Equals(_9.CUI().Voice,null)?(_9.CUI().Avatar.nativeVoice=true,_9.CUI().Avatar.nativeVoiceName=_9.CUI().Voice.$0.name,_9.debug((function(bJ){return function(bK){return bJ("Using browser speech synthesis voice "+bk.toSafe(bK)+".");};}(a.id))(_9.CUI().Voice.$0.name))):void 0):void 0;bB.Equals(_9.CUI().Voice,null)?_9.debug("No female browser speech synthesis voice is available. Using CMU SLT Female voice via TTS."):void 0;};_9.synth=function(){_.$cctor();return _.synth;};_9.push=function(bI){_9.Utterances().unshift(bI);return _9.Dialogue();};_9.Dialogue=function(){_.$cctor();return _.Dialogue;};_9.Utterances=function(){_.$cctor();return _.Utterances;};_9.Questions=function(){_.$cctor();return _.Questions;};_9.Output=function(){_.$cctor();return _.Output;};_9.Props=function(){_.$cctor();return _.Props;};_9.wait=function(bI){d["Terminal.Echo'"](_9.CUI().Term,"please wait");_9.CUI().Term.pause();bI();_9.CUI().Term.resume();};_9.debug=function(bI){d.debug("CLIENT",bI);};_9.echo=function(bI){d["Terminal.EchoHtml'"](_9.CUI().Term,(function(bJ){return function(bK){return bJ(bk.prettyPrint(bK));};}(a.id))(bI));};_9.ClientState=function(){_.$cctor();return _.ClientState;};_9.set_ClientState=function(bI){_.$cctor();_.ClientState=bI;};_9.MicState=function(){_.$cctor();return _.MicState;};_9.set_MicState=function(bI){_.$cctor();_.MicState=bI;};_9.CUI=function(){_.$cctor();return _.CUI;};_9.set_CUI=function(bI){_.$cctor();_.CUI=bI;};_.$cctor=function(){var bI,bJ,bK,bL;_.$cctor=a.ignore;function bM(bO,bP){var bQ,bR,bS,bT,bU,bV,bW;_9.debug((((bc.Curried3(function(bX,bY,bZ){return bX("Voice: "+bk.prettyPrint(bY)+" "+bk.prettyPrint(bZ));}))(a.id))(bO))(bP));bQ=(bR=K["Intent'"](bO,bP),bR!=null&&bR.$==1?{$:1,$0:bR.$0}:null);bS=(bT=K["Trait'"](bP),bT!=null&&bT.$==1?{$:1,$0:bo.ofArray([bT.$0])}:null);bU=(bV=K["Entity'$1"](bP),bV!=null&&bV.$==1?{$:1,$0:bo.ofArray([bV.$0])}:null);bQ==null&&(bS==null&&bU==null)?void 0:(_9.debug(((((bc.Curried(function(bX,bY,bZ,b0){return bX("Voice: "+$.p(bY)+" "+$.p$3(bZ)+" "+$.p$5(b0));},4))(a.id))(bQ))(bS))(bU)),_7.update(_9.push(new J({$:0,$0:"",$1:bQ,$2:bS,$3:bU}))));}function bN(bO,bP){var bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2;_9.set_CUI(X.New(_9.CUI().Voice,_9.CUI().Mic,bO,_9.CUI().Avatar,_9.CUI().Caption,_9.CUI().TypingDNA,_9.CUI().AudioEnd));if(bB.Equals(_9.CUI().Mic,null))_9.initMic(bM);if(bB.Equals(_9.CUI().Voice,null))_9.initSpeech();if(_9.ClientState().$===0)_9.set_ClientState(V.ClientReady);b0=M.Blank(bP);if(b0!=null&&b0.$==1)return _9["say'"]("Tell me what you want me to do or ask me a question.");else{b1=M.Debug(bP);if(b1!=null&&b1.$==1){_9.debug((function(b3){return function(b4){return b3("Utterances: "+bk.prettyPrint(b4));};}(a.id))(_9.Utterances()));_9.debug((function(b3){return function(b4){return b3("Questions: "+bk.prettyPrint(b4));};}(a.id))(_9.Questions()));bQ=_9.Props().GetEnumerator$1();try{while(bQ.MoveNext()){b2=bQ.Current();_9.debug((((bc.Curried3(function(b3,b4,b5){return b3(bk.toSafe(b4)+": "+bk.prettyPrint(b5));}))(a.id))(b2.K))(b2.V));}return;}finally{bQ.Dispose();}}else{bR=M.Voices(bP);return bR!=null&&bR.$==1?(bS=d.toArray(d.speechSynthesis().getVoices()),_9["say'"]((function(b3){return function(b4){return b3("There are currently "+a.String(b4)+" voices installed on this computer or device.");};}(a.id))(be.length(bS))),be.iteri(function(b3,b4){return _9["say'"](((((bc.Curried(function(b5,b6,b7,b8){return b5("Voice "+a.String(b6)+". Name: "+bk.toSafe(b7)+", Local: "+bk.prettyPrint(b8)+".");},4))(a.id))(b3))(b4.name))(b4.localService));},bS)):_9.ClientState().$==1?(bU=M.QuickHello(bP),(bU!=null&&bU.$==1?(bT=bU.$0,true):(bV=M.QuickHelp(bP),bV!=null&&bV.$==1?(bT=bV.$0,true):(bW=M.QuickYes(bP),bW!=null&&bW.$==1?(bT=bW.$0,true):(bX=M.QuickNo(bP),bX!=null&&bX.$==1?(bT=bX.$0,true):(bY=M.QuickNumber(bP),bY!=null&&bY.$==1&&(bT=bY.$0,true))))))?(_9.debug((function(b3){return function(b4){return b3("Quick Text: "+$.p$7(b4)+".");};}(a.id))(bT)),_7.update(_9.push(bT)),_9.set_ClientState(V.ClientReady)):_9.CUI().Wait((bZ=null,br.Delay(function(){_9.set_ClientState(V.ClientUnderstand);M.getUtterance(bP,function(b3){var b4,b5;b4=M.HasUtterance(b3);b4!=null&&b4.$==1?(b5=b4.$0,_9.debug(((((bc.Curried(function(b6,b7,b8,b9){return b6("Text: Intent: "+$.p(b7)+", Traits: "+$.p$3(b8)+", Entities: "+$.p$5(b9)+".");},4))(a.id))(b5.get_Intent()))(b5.get_Traits()))(b5.get_Entities())),_7.update(_9.push(b5))):(_9.debug("Text: Did not receive a meaning from the server."),_9["say'"]("Sorry I did not understand what you said."));});_9.set_ClientState(V.ClientReady);return br.Zero();})))):_9.ClientState().$==0?d.error("Client is not initialized."):_9["say'"]("I'm still trying to understand what you said before.");}}}_.CUI=X.New(null,null,null,(bA.applicationId="4277115329081938617",bI=new a.SDKConnection(),bJ=new a.WebAvatar(),bJ.version=8.5,bJ.connection=bI,bJ.avatar="20926186",bJ.voice="cmu-slt",bJ.voiceMod="default",bJ.width=175,bJ.createBox(),bJ.addMessage(""),bJ.processMessages(0),bJ),false,(bK=new a.TypingDNA(),(bK.stop(),bK)),[]);_.MicState=U.MicNotInitialized;_.ClientState=V.ClientNotInitialzed;_.Props=new bH.New$5();_.Output=[];_.Questions=[];_.Utterances=[];_.Dialogue=new Y({$:0,$0:_9.CUI(),$1:_9.Props(),$2:_9.Questions(),$3:_9.Output(),$4:_9.Utterances()});_.synth=a.speechSynthesis;_.Main=new W({$:0,$0:function(bO){return bM(bO[0],bO[1]);},$1:[function(bO){return function(bP){return bN(bO,bP);};},(bL={},bL.name="Main",bL.greetings="Welcome to Selma. Enter 'hello' or 'hello my name is...(you) to initialize speech.",bL.prompt=">",bL)]});};$.p$8=function(bI){return bI.$==3?"ConceptCompletion":bI.$==2?"Disjunctive":bI.$==1?"Verification":"UserAuthentication "+bk.prettyPrint(bI.$0);};ba.p=function(bI){return"{"+("text = "+bk.prettyPrint(bI.text))+"; "+("intents = "+bk.printArray(function(bJ){return ba.p$1(bJ);},bI.intents))+"; "+("entities = "+bk.prettyPrint(bI.entities))+"; "+("traits = "+bk.prettyPrint(bI.traits))+"}";};ba.p$1=function(bI){return"{"+("id = "+bk.prettyPrint(bI.id))+"; "+("name = "+bk.prettyPrint(bI.name))+"; "+("confidence = "+bk.prettyPrint(bI.confidence))+"}";};$.p$9=function(bI){return"Question ("+bk.prettyPrint(bI.$0)+", "+bk.prettyPrint(bI.$1)+", "+$.p$8(bI.$2)+", "+"<fun>"+")";};$.p$2=function(bI){return bI==null?"null":"Some "+bk.prettyPrint(bI.$0);};$.p$1=function(bI){return"Intent ("+bk.prettyPrint(bI.$0)+", "+$.p$2(bI.$1)+")";};$.p=function(bI){return bI==null?"null":"Some "+$.p$1(bI.$0);};$.p$4=function(bI){return"Trait ("+bk.prettyPrint(bI.$0)+", "+bk.prettyPrint(bI.$1)+", "+$.p$2(bI.$2)+")";};$.p$3=function(bI){return bI==null?"null":"Some "+bk.printList(function(bJ){return $.p$4(bJ);},bI.$0);};$.p$6=function(bI){return"Entity ("+bk.prettyPrint(bI.$0)+", "+bk.prettyPrint(bI.$1)+", "+bk.prettyPrint(bI.$2)+", "+$.p$2(bI.$3)+")";};$.p$5=function(bI){return bI==null?"null":"Some "+bk.printList(function(bJ){return $.p$6(bJ);},bI.$0);};$.p$7=function(bI){return"Utterance ("+bk.prettyPrint(bI.$0)+", "+$.p(bI.$1)+", "+$.p$3(bI.$2)+", "+$.p$5(bI.$3)+")";};}());
