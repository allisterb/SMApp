(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB;a=self;b=a.SMApp=a.SMApp||{};c=b.Web=b.Web||{};d=c.ClientExtensions=c.ClientExtensions||{};e=d.SweetAlert=d.SweetAlert||{};f=c._Html=c._Html||{};g=c.htmModule=c.htmModule||{};h=a.StartupCode$SMApp_Web$ClientExtensions=a.StartupCode$SMApp_Web$ClientExtensions||{};i=c.TypingDNA=c.TypingDNA||{};j=i.SaveResponse=i.SaveResponse||{};k=i.UserResponse=i.UserResponse||{};l=i.VerifyResponse=i.VerifyResponse||{};m=c.Bs=c.Bs||{};n=b.NLU=b.NLU||{};o=n.Witai=n.Witai||{};p=o.Utterance=o.Utterance||{};q=o.Intent=o.Intent||{};r=o.Entity=o.Entity||{};s=o.Trait=o.Trait||{};t=o["Utterance'"]=o["Utterance'"]||{};u=o["Value'"]=o["Value'"]||{};v=c.NLG=c.NLG||{};w=a.StartupCode$SMApp_Web$NLG=a.StartupCode$SMApp_Web$NLG||{};x=c.NLU=c.NLU||{};y=x.Intent=x.Intent||{};z=x.Trait=x.Trait||{};A=x.Entity=x.Entity||{};B=x.Utterance=x.Utterance||{};C=x.Voice=x.Voice||{};D=C["Entity'"]=C["Entity'"]||{};E=x.Text=x.Text||{};F=E["Utterance'"]=E["Utterance'"]||{};G=E["Intent'"]=E["Intent'"]||{};H=E["Entity'"]=E["Entity'"]||{};I=E["Trait'"]=E["Trait'"]||{};J=x.EmotionalTrait=x.EmotionalTrait||{};K=x.Domain=x.Domain||{};L=a.StartupCode$SMApp_Web$NLU=a.StartupCode$SMApp_Web$NLU||{};M=c.CUI=c.CUI||{};N=M.MicState=M.MicState||{};O=M.ClientState=M.ClientState||{};P=M.Interpreter=M.Interpreter||{};Q=M.CUI=M.CUI||{};R=c.Dialogue=c.Dialogue||{};S=c.Question=c.Question||{};T=c.QuestionType=c.QuestionType||{};U=c.DialogueModule=c.DialogueModule||{};V=c.Questions=c.Questions||{};W=c.User=c.User||{};X=a.StartupCode$SMApp_Web$User=a.StartupCode$SMApp_Web$User||{};Y=c.Symptoms=c.Symptoms||{};Z=a.StartupCode$SMApp_Web$Symptoms=a.StartupCode$SMApp_Web$Symptoms||{};_0=c.Main=c.Main||{};_1=a.StartupCode$SMApp_Web$Main=a.StartupCode$SMApp_Web$Main||{};_2=c.Client=c.Client||{};_3=a.StartupCode$SMApp_Web$Client=a.StartupCode$SMApp_Web$Client||{};_4=a.SMApp$Web_GeneratedPrintf=a.SMApp$Web_GeneratedPrintf||{};_5=a.GeneratedPrintf=a.GeneratedPrintf||{};_6=a.WebSharper;_7=_6&&_6.Arrays;_8=a.SweetAlert;_9=a.IntelliFactory;_=_9&&_9.Runtime;$=_6&&_6.Operators;ba=_6&&_6.UI;bb=ba&&ba.Doc;bc=ba&&ba.AttrProxy;bd=ba&&ba.Client;be=bd&&bd.Templates;bf=_6&&_6.Utils;bg=a.console;bh=a.jQuery;bi=_6&&_6.Strings;bj=_6&&_6.List;bk=_6&&_6.Seq;bl=ba&&ba.AttrModule;bm=_6&&_6.Concurrency;bn=_6&&_6.Random;bo=_6&&_6.Collections;bp=bo&&bo.Map;bq=_6&&_6.JavaScript;br=bq&&bq.Pervasives;bs=_6&&_6.ClientSideJson;bt=bs&&bs.Provider;bu=a.JSON;bv=a.SDK;bw=_6&&_6.Unchecked;bx=_6&&_6.Remoting;by=bx&&bx.AjaxRemotingProvider;bz=a.Wit;bA=a.document;bB=bo&&bo.Dictionary;d.getCameraCanvas=function(){return a.getCameraCanvas();};d.stopCamera=function(){return a.stopCamera();};d.startCamera=function(bC,bD){return a.startCamera(bC,bD);};d.speechSynthesis=function(){return a.speechSynthesis;};d.lastMicData=function(){return a.lastMicData;};d.Terminal=function(){return a.$("#term").terminal();};d.enableTerminal=function(){return a.$("#term").terminal().enable();};d.disableTerminal=function(){return a.$("#term").terminal().disable();};d.boxesWithTitles=function(bC){return _7.map(function(bD){var bE;bE={};bE.titleText=bD;return bE;},bC);};d.confirmQuestionBox=function(){_8.clickConfirm();};d.questionBox=function(bC,bD,bE,bF,bG,bH,bI){var bJ,bK,bL,bM,bN,bO;bJ=(bK=bF==null?(bL={},bL.titleText=bC,bL.text=bD,bL.icon="question",bL.html="<div></div>",bL.allowOutsideClick=false,bL):(bM=bF.$0[0],(bN={},bN.titleText=bC,bN.text=bD,bN.icon="question",bN.width=a.String(bM),bN.html=(((_.Curried3(function(bP,bQ,bR){return bP("<div class=\"swal2-content-custom\" style=\"width:"+a.String(bQ)+"px;height:"+a.String(bR)+"px\"></div>");}))(a.id))(bM))(bF.$0[1]),bN.allowOutsideClick=false,bN)),(bG!=null?bG.$0(bK):void 0,bE!=null&&bE.$==1?(bO=bE.$0,(bK.progressSteps=_7.ofSeq($.range(1,_7.length(bO))),_8.mixin(bK).queue(_7.create(_7.length(bO),bK)))):_8.fire(bK)));bH!=null?bH.$0():void 0;bJ.then(bI);};e.get_QueueBoxes=function(){var bC;bC=_8.mixin({});return function(bD){return bC.queue(bD);};};d.getDialogueBoxInput=function(){return _7.get(a.jQuery(".swal2-input").get(),0);};d.getDialogueBoxCanvas=function(){return _7.get(a.jQuery("canvas.swal2-content").get(),0);};d.getDialogueBoxContent=function(){return _7.get(a.jQuery("#swal2-content").get(),0).firstChild;};d.createDialogueBoxCanvas=function(){return d.createCanvas("camera","640","480",_7.get(a.jQuery("#swal2-content").get(),0).firstChild);};d.createCanvas=function(bC,bD,bE,bF){var bG;bG=bb.Element("canvas",[d.eid(bC),bc.Create("width",bD),bc.Create("height",bE)],[]);be.LoadLocalTemplates("");bb.Run(bF,bG);return bF.firstChild;};d.elementHTML=function(bC){return bC.innerHTML;};d.createElement=function(bC){var bD;bD=self.document.createElement("div");self.document.appendChild(bD);be.LoadLocalTemplates("");bb.RunAppend(bD,bC);};d.getContainer=function(){return _7.get(a.jQuery("#container").get(),0).firstChild;};d.container=function(bC){return bb.Element("div",[d.cls("container")],bC);};d.dindex=function(bC){return bc.Create("data-index",a.String(bC));};d.cls=function(bC){return bc.Create("class",bC);};d.eid=function(bC){return bc.Create("id",bC);};d.getMic=function(){return _7.get(a.jQuery("#microphone").get(),0);};d.terminalOutput=function(){return _7.get(a.jQuery(".terminal-output").get(),0);};d.toLower=function(bC){return bC.toLowerCase();};d.debug=function(bC,bD){d.info((((_.Curried3(function(bE,bF,bG){return bE("DEBUG: "+bf.toSafe(bF)+": "+bf.prettyPrint(bG));}))(a.id))(bC.toUpperCase()))(bD));};d.error=function(bC){bg.error(bC);};d.info=function(bC){bg.info(bC);};d.jserror=function(bC){bh.error(bC);};d.toArray=function(bC){return _7.map(a.id,bh.makeArray(bC));};d["Terminal.EchoHtml'"]=function(bC,bD){bC.pause();bC.echo(bD,d.rawOpt());bC.resume();};d["Terminal.Echo'"]=function(bC,bD){bC.pause();bC.echo(bD);bC.resume();};d.rawOpt=function(){h.$cctor();return h.rawOpt;};f=c._Html=_.Class({toString:function(){return f.toString(this);}},null,f);f.toString=function(bC){function bD(bE){return function(bF){var bG,bH,bI,bJ,bK,bL,bM;bH=bi.replicate(bE," ");switch(bF.$==0?bF.$1.$==1?bF.$1.$0.$==2?bF.$1.$1.$==0?(bG=[bF.$1.$0.$0,bF.$0],1):(bG=[bF.$1,bF.$0],2):(bG=[bF.$1,bF.$0],2):(bG=[bF.$1,bF.$0],2):bF.$==2?(bG=bF.$0,3):(bG=[bF.$0,bF.$1],0)){case 0:return bG[0]+"=\""+bG[1]+"\"";case 1:bI=bG[1];return bH+"<"+bI+">"+bG[0]+"</"+bI+">\r\n";case 2:bJ=bG[1];bK=bj.partition(function(bN){return bN.$==1;},bG[0]);bL=bK[1];bM=bK[0];return bL.$==0?bH+"<"+bJ+(bM.$===0?"":" "+bi.concat(" ",bj.ofSeq(bk.delay(function(){return bk.map(function(bN){return(bD(0))(bN);},bM);}))))+"/>\r\n":bH+"<"+bJ+(bM.$===0?"":" "+bi.concat(" ",bj.ofSeq(bk.delay(function(){return bk.map(function(bN){return(bD(0))(bN);},bM);}))))+">\r\n"+bi.concat("",bj.ofSeq(bk.delay(function(){return bk.map(function(bN){return(bD(bE+1))(bN);},bL);})))+bH+"</"+bJ+">\r\n";case 3:return bH+bG+"\r\n";}};}return(bD(0))(bC);};g.alt=function(bC){return new f({$:1,$0:"alt",$1:bC});};g.src=function(bC){return new f({$:1,$0:"src",$1:bC});};g.cls=function(bC){return new f({$:1,$0:"class",$1:bC});};g.str=function(bC){return f.toString(bC);};g.op_PercentEquals=function(bC,bD){return new f({$:1,$0:bC,$1:bD});};g.op_Splice=function(bC){var bD;return bj.ofArray([new f({$:2,$0:(bD=bC,a.String(bD))})]);};g.strong=function(){h.$cctor();return h.strong;};g.h4=function(){h.$cctor();return h.h4;};g.h3=function(){h.$cctor();return h.h3;};g.h2=function(){h.$cctor();return h.h2;};g.h1=function(){h.$cctor();return h.h1;};g.li=function(){h.$cctor();return h.li;};g.ul=function(){h.$cctor();return h.ul;};g.th=function(){h.$cctor();return h.th;};g.td=function(){h.$cctor();return h.td;};g.tr=function(){h.$cctor();return h.tr;};g.a=function(){h.$cctor();return h.a;};g.p=function(){h.$cctor();return h.p;};g.area=function(){h.$cctor();return h.area;};g.map=function(){h.$cctor();return h.map;};g.img=function(){h.$cctor();return h.img;};g.tfoot=function(){h.$cctor();return h.tfoot;};g.tbody=function(){h.$cctor();return h.tbody;};g.thead=function(){h.$cctor();return h.thead;};g.table=function(){h.$cctor();return h.table;};g.span=function(){h.$cctor();return h.span;};g.section=function(){h.$cctor();return h.section;};g.br=function(){h.$cctor();return h.br;};g.div=function(){h.$cctor();return h.div;};g.body=function(){h.$cctor();return h.body;};g.style=function(){h.$cctor();return h.style;};g.title=function(){h.$cctor();return h.title;};g.head=function(){h.$cctor();return h.head;};g.html=function(){h.$cctor();return h.html;};g.elem=function(bC,bD){return new f({$:0,$0:bC,$1:bD});};h.$cctor=function(){var bC;h.$cctor=a.ignore;h.rawOpt=(bC={},bC.raw=true,bC);h.html=function(bD){return g.elem("html",bD);};h.head=function(bD){return g.elem("head",bD);};h.title=function(bD){return g.elem("title",bD);};h.style=function(bD){return g.elem("style",bD);};h.body=function(bD){return g.elem("body",bD);};h.div=function(bD){return g.elem("div",bD);};h.br=function(bD){return g.elem("br",bD);};h.section=function(bD){return g.elem("section",bD);};h.span=function(bD){return g.elem("span",bD);};h.table=function(bD){return g.elem("table",bD);};h.thead=function(bD){return g.elem("thead",bD);};h.tbody=function(bD){return g.elem("tbody",bD);};h.tfoot=function(bD){return g.elem("tfoot",bD);};h.img=function(bD){return g.elem("img",bD);};h.map=function(bD){return g.elem("map",bD);};h.area=function(bD){return g.elem("area",bD);};h.p=function(bD){return g.elem("p",bD);};h.a=function(bD){return g.elem("a",bD);};h.tr=function(bD){return g.elem("tr",bD);};h.td=function(bD){return g.elem("td",bD);};h.th=function(bD){return g.elem("th",bD);};h.ul=function(bD){return g.elem("ul",bD);};h.li=function(bD){return g.elem("li",bD);};h.h1=function(bD){return g.elem("h1",bD);};h.h2=function(bD){return g.elem("h1",bD);};h.h3=function(bD){return g.elem("h1",bD);};h.h4=function(bD){return g.elem("h1",bD);};h.strong=function(bD){return g.elem("strong",bD);};};j.New=function(bC,bD,bE,bF){return{name:bC,message:bD,message_code:bE,status:bF};};k.New=function(bC,bD,bE,bF,bG){return{message:bC,message_code:bD,success:bE,count:bF,status:bG};};l.New=function(bC,bD,bE,bF,bG,bH){return{message:bC,message_code:bD,success:bE,result:bF,score:bG,confidence:bH};};m.Radio=function(bC,bD,bE,bF,bG){return bb.Element("div",new bj.T({$:1,$0:d.cls("radio"),$1:bD}),[bb.Element("label",bF,[bb.Radio(bG,true,bE),bb.TextNode(bC)])]);};m.checkbox=function(bC,bD,bE,bF,bG){return bb.Element("div",new bj.T({$:1,$0:d.cls("checkbox"),$1:bD}),[bb.Element("label",bF,[bb.CheckBox(bG,bE),bb.TextNode(bC)])]);};m.textArea=function(bC,bD,bE,bF,bG){return bb.Element("div",new bj.T({$:1,$0:d.cls("form-group"),$1:bD}),[bb.Element("label",bF,[bb.TextNode(bC)]),bb.InputArea(new bj.T({$:1,$0:d.cls("form-control"),$1:bG}),bE)]);};m.inputPassword=function(bC,bD,bE,bF,bG){return bb.Element("div",new bj.T({$:1,$0:d.cls("form-group"),$1:bD}),[bb.Element("label",bF,[bb.TextNode(bC)]),bb.PasswordBox(new bj.T({$:1,$0:d.cls("form-control"),$1:bG}),bE)]);};m.input=function(bC,bD,bE,bF,bG){return bb.Element("div",new bj.T({$:1,$0:d.cls("form-group"),$1:bD}),[bb.Element("label",bF,[bb.TextNode(bC)]),bb.Input([d.cls("form-control"),bG],bE)]);};m.btnSecondary=function(bC,bD,bE){return bb.Element("button",[d.eid(bC),d.cls("btn btn-secondary"),bl.Handler("click",bE)],[bb.TextNode(bD)]);};m.btnPrimary=function(bC,bD,bE){return bb.Element("button",[d.eid(bC),d.cls("btn btn-primary"),bl.Handler("click",bE)],[bb.TextNode(bD)]);};p.New=function(bC,bD,bE,bF){return{text:bC,intents:bD,entities:bE,traits:bF};};q.New=function(bC,bD,bE){return{id:bC,name:bD,confidence:bE};};r.New=function(bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM){return{id:bC,name:bD,role:bE,start:bF,end:bG,body:bH,confidence:bI,entities:bJ,suggested:bK,value:bL,type:bM};};s.New=function(bC,bD,bE){return{id:bC,value:bD,confidence:bE};};t.New=function(bC){return{intent:bC};};u.New=function(bC){return{value:bC};};o.getMeaning2=function(bC,bD){function bE(bF,bG){var bH;bh.ajax((bH={},bH.url=(function(bI){return function(bJ){return bI("https://api.wit.ai/message?q="+bf.toSafe(bJ));};}(a.id))(bD),bH.type="GET",bH.beforeSend=function(bI){return bI.setRequestHeader("Authorization","Bearer "+bC);},bH.success=function(bI){return bF(bI);},bH.error=function(bI){return bG(new a.Error(bI.responseText));},bH));}return bm.FromContinuations(function(bF,bG,bH){return bE.apply(null,[bF,bG,bH]);});};o.getMeaning=function(bC,bD,bE,bF){var bG;bh.ajax((bG={},bG.url=(function(bH){return function(bI){return bH("https://api.wit.ai/message?q="+bf.toSafe(bI));};}(a.id))(bD),bG.type="GET",bG.beforeSend=function(bH){return bH.setRequestHeader("Authorization","Bearer "+bC);},bG.success=bE,bG.error=bF,bG));};v.waitAddPhrases=function(){w.$cctor();return w.waitAddPhrases;};v.waitRetrievePhrases=function(){w.$cctor();return w.waitRetrievePhrases;};v.helpPhrases=function(){w.$cctor();return w.helpPhrases;};v.helloUserPhrases=function(){w.$cctor();return w.helloUserPhrases;};v.helloPhrases=function(){w.$cctor();return w.helloPhrases;};v["getRandomPhrase'"]=function(bC){return v.replace_tok("$0","",bk.nth(v.rng().Next(0,bC.get_Length()),bC));};v.getRandomPhrase=function(bC,bD){return v.replace_tok("$0",bD,bk.nth(v.rng().Next(0,bC.get_Length()),bC));};v.replace_tok=function(bC,bD,bE){return bi.Replace(bE,bC,bD);};v.rng=function(){w.$cctor();return w.rng;};w.$cctor=function(){w.$cctor=a.ignore;w.rng=new bn.New();w.helloPhrases=bj.ofArray(["Welcome!","Welcome, my name is Selma.","Welcome to Selma. How can I help?","Hello this is Selma, how can I help?","Hello, I am Selma. How can I help?","Hello, I am Selma. How may I help you now?","I'm Selma. Tell me your name so we can get started."]);w.helloUserPhrases=bj.ofArray(["Hello $0, welcome back.","Welcome $0, nice to see you again.","Hello $0.","Good to see you $0.","Hello $0, nice to see you."]);w.helpPhrases=bj.ofArray(["What can I help you with $0?"]);w.waitRetrievePhrases=bj.ofArray(["Ok, let me check that $0 for you","Please wait while I check that $0 for you.","Wait while I check that $0.","Ok let me see if I can find that $0."]);w.waitAddPhrases=bj.ofArray(["Ok, let me add that $0 for you","Please wait while I add that $0 for you.","Wait while I add that $0.","I'll add that $0 now."]);};y=x.Intent=_.Class({toString:function(){return(((_.Curried3(function(bC,bD,bE){return bC("Intent("+bf.toSafe(bD)+", "+_4.p$2(bE)+")");}))(a.id))(this.get_Name()))(this.get_Confidence());},get_Confidence:function(){return this.$1;},get_Name:function(){return this.$0;}},null,y);z=x.Trait=_.Class({toString:function(){return(((_.Curried3(function(bC,bD,bE){return bC("Trait("+bf.toSafe(bD)+", "+bf.prettyPrint(bE)+")");}))(a.id))(this.get_Name()))(this.get_Value());},get_Confidence:function(){return this.$2;},get_Value:function(){return this.$1;},get_Name:function(){return this.$0;}},null,z);A=x.Entity=_.Class({toString:function(){return(((((_.Curried(function(bC,bD,bE,bF,bG){return bC("Entity("+bf.toSafe(bD)+", "+bf.toSafe(bE)+", "+bf.toSafe(bF)+", "+_4.p$2(bG)+")");},5))(a.id))(this.get_Name()))(this.get_Role()))(this.get_Value()))(this.get_Confidence());},get_Confidence:function(){return this.$3;},get_Value:function(){return this.$2;},get_Role:function(){return this.$1;},get_Name:function(){return this.$0;}},null,A);B=x.Utterance=_.Class({toString:function(){return((((_.Curried(function(bC,bD,bE,bF){return bC(_4.p(bD)+" "+_4.p$3(bE)+" "+_4.p$5(bF));},4))(a.id))(this.get_Intent()))(this.get_Traits()))(this.get_Entities());},get_Entities:function(){var bC;bC=this.$3;return bC!=null?{$:1,$0:bj.sortBy(function(bD){return bD.get_Name();},bC.$0)}:null;},get_Traits:function(){var bC;bC=this.$2;return bC!=null?{$:1,$0:bj.sortBy(function(bD){return bD.get_Name();},bC.$0)}:null;},get_Intent:function(){return this.$1;},get_Text:function(){return this.$0;}},null,B);D.New=function(bC,bD,bE,bF,bG){return{body:bC,end:bD,start:bE,suggested:bF,value:bG};};C["Intent'"]=function(bC,bD){return!(bD.intent==null)?{$:1,$0:new y({$:0,$0:d.toLower(bD.intent.value),$1:null})}:null;};C["Trait'"]=function(bC){return!(bC.domain==null)?{$:1,$0:new z({$:0,$0:"domain",$1:d.toLower(bC.domain.value),$2:null})}:!(bC.dialogue_act==null)?{$:1,$0:new z({$:0,$0:"dialogue_act",$1:d.toLower(bC.dialogue_act.value),$2:null})}:null;};C["Entity'$1"]=function(bC){return!(bC.contact==null)?{$:1,$0:new A({$:0,$0:"contact",$1:"",$2:d.toLower(bC.contact.value),$3:null})}:null;};F=E["Utterance'"]=_.Class({get_TopIntent:function(){return bj.head(bj.sortBy(function(bC){return bC.get_Confidence();},this.get_Intents()));},get_Traits:function(){return this.$3;},get_Entities:function(){return this.$2;},get_Intents:function(){return this.$1;},get_Text:function(){return this.$0;}},null,F);G=E["Intent'"]=_.Class({get_Confidence:function(){return this.$1;},get_Name:function(){return this.$0;}},null,G);H=E["Entity'"]=_.Class({get_Value:function(){return(this.get_Unwrap())[3];},get_Role:function(){return(this.get_Unwrap())[2];},get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1,this.$2,this.$3];}},null,H);I=E["Trait'"]=_.Class({get_Value:function(){return(this.get_Unwrap())[2];},get_Confidence:function(){return(this.get_Unwrap())[1];},get_Name:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1,this.$2];}},null,I);E.HasUtterance=function(bC){var bD,bE,bF,bG,bH,bI;return bC!=null&&bC.$==1&&(bC.$0.$2.get_Length()>0&&(bD=[bC.$0.$2,bC.$0.$1,bC,bC.$0.$0,bC.$0.$3],true))?(bE=bD[0],(bF=bD[2],(bG=bD[4],(bH=bD[1].$==0?null:{$:1,$0:new y({$:0,$0:bF.$0.get_TopIntent().get_Name(),$1:{$:1,$0:bF.$0.get_TopIntent().get_Confidence()}})},(bI=bE.$==0?null:{$:1,$0:bj.map(function(bJ){return new A({$:0,$0:bJ.get_Name(),$1:d.toLower(bJ.get_Role()),$2:bJ.get_Value(),$3:{$:1,$0:bJ.get_Confidence()}});},bj.filter(function(bJ){return bJ.get_Confidence()>E.entityConfidenceThreshold();},bE))},{$:1,$0:new B({$:0,$0:bD[3],$1:bH,$2:bG.$==0?null:{$:1,$0:bj.map(function(bJ){return new z({$:0,$0:d.toLower(bJ.get_Name()),$1:bJ.get_Value(),$2:{$:1,$0:bJ.get_Confidence()}});},bj.filter(function(bJ){return bJ.get_Confidence()>E.entityConfidenceThreshold();},bG))},$3:bI})}))))):null;};E.entityConfidenceThreshold=function(){L.$cctor();return L.entityConfidenceThreshold;};E.set_entityConfidenceThreshold=function(bC){L.$cctor();L.entityConfidenceThreshold=bC;};E.intentConfidenceThreshold=function(){L.$cctor();return L.intentConfidenceThreshold;};E.set_intentConfidenceThreshold=function(bC){L.$cctor();L.intentConfidenceThreshold=bC;};E.getUtterance2=function(bC){var bD;bD=null;return bm.Delay(function(){return bm.Bind(o.getMeaning2("4Y2BLQY5TWLIN7HFIV264S53MY4PCUAT",bC),function(bE){d.debug("NLU",(function(bF){return function(bG){return bF("Wit.ai returned "+_5.p(bG)+" ");};}(a.id))(bE));return bm.Return(new F({$:0,$0:bC,$1:bj.ofArray(_7.map(function(bF){return new G({$:0,$0:bF.name,$1:bF.confidence});},bE.intents)),$2:bj.map(function(bF){return new H({$:0,$0:bF.name,$1:bF.confidence,$2:bF.role,$3:bF.value});},bj.ofSeq(bk.concat(bk.map(function(bF){return bF[1];},bp.ToSeq(bE.entities))))),$3:bj.ofSeq(bk.map(function(bF){var bG;bG=bF[1];return new I({$:0,$0:bF[0],$1:_7.get(bG,0).confidence,$2:_7.get(bG,0).value});},bp.ToSeq(bE.traits)))}));});});};E.getUtterance=function(bC,bD){o.getMeaning("OOGDHEQL7JZRQASXN2N2GHFUKGO3SCNV",bC,function(bE){var bF,bG;d.debug("NLU",(function(bH){return function(bI){return bH("Wit.ai returned: "+bf.prettyPrint(bI));};}(a.id))(bE));bF=!(bE.intents==null)?bj.ofArray(_7.map(function(bH){return new G({$:0,$0:bH.name,$1:bH.confidence});},bE.intents)):bj.T.Empty;bG=!(bE.traits==null)?bj.ofSeq(bk.concat(bj.map(function(bH){return _7.map(function(bI){return new I({$:0,$0:bH,$1:bI.confidence,$2:bI.value});},br.GetJS(bE.traits,[bH]));},bj.filter(function(bH){return!(br.GetJS(bE.traits,[bH])==null);},E.trait_types())))):bj.T.Empty;return bD({$:1,$0:new F({$:0,$0:bC,$1:bF,$2:!(bE.entities==null)?bj.ofSeq(bk.concat(bj.map(function(bH){return _7.map(function(bI){return new H({$:0,$0:bI.name,$1:bI.confidence,$2:bI.role,$3:bI.value});},br.GetJS(bE.entities,[bH]));},bj.filter(function(bH){return!(br.GetJS(bE.entities,[bH])==null);},E.entity_types())))):bj.T.Empty,$3:bG})});},function(bE,bF,bG){d.error((((_.Curried3(function(bH,bI,bJ){return bH("Wit.ai returned: "+bf.prettyPrint(bI)+" "+bf.prettyPrint(bJ));}))(a.id))(bF))(bG));return bD(null);});};E.trait_types=function(){L.$cctor();return L.trait_types;};E.entity_types=function(){L.$cctor();return L.entity_types;};E.QuickJournal=function(bC){var bD;return bC==="journal"||bC==="diary"?{$:1,$0:new B({$:0,$0:"journal",$1:{$:1,$0:new y({$:0,$0:"journal",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};E.QuickNumber=function(bC){var bD,bE,bF,bG,bH,bI;return(bE=E.One(bC),bE!=null&&bE.$==1?(bD=bE.$0,true):(bF=E.Two(bC),bF!=null&&bF.$==1?(bD=bF.$0,true):(bG=E.Three(bC),bG!=null&&bG.$==1?(bD=bG.$0,true):(bH=E.Four(bC),bH!=null&&bH.$==1?(bD=bH.$0,true):(bI=E.Five(bC),bI!=null&&bI.$==1&&(bD=bI.$0,true))))))?{$:1,$0:bD}:null;};E.Five=function(bC){var bD;return bC==="5"||bC==="five"?{$:1,$0:new B({$:0,$0:"five",$1:{$:1,$0:new y({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bj.ofArray([new A({$:0,$0:"wit/ordinal",$1:"",$2:"five",$3:{$:1,$0:1}})])}})}:null;};E.Four=function(bC){var bD;return bC==="4"||bC==="four"?{$:1,$0:new B({$:0,$0:"four",$1:{$:1,$0:new y({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bj.ofArray([new A({$:0,$0:"wit/ordinal",$1:"",$2:"four",$3:{$:1,$0:1}})])}})}:null;};E.Three=function(bC){var bD;return bC==="3"||bC==="three"?{$:1,$0:new B({$:0,$0:"three",$1:{$:1,$0:new y({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bj.ofArray([new A({$:0,$0:"wit/ordinal",$1:"",$2:"three",$3:{$:1,$0:1}})])}})}:null;};E.Two=function(bC){var bD;return bC==="2"||bC==="two"?{$:1,$0:new B({$:0,$0:"two",$1:{$:1,$0:new y({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bj.ofArray([new A({$:0,$0:"wit/ordinal",$1:"",$2:"two",$3:{$:1,$0:1}})])}})}:null;};E.One=function(bC){var bD;return bC==="1"||bC==="one"?{$:1,$0:new B({$:0,$0:"one",$1:{$:1,$0:new y({$:0,$0:"questionresponse",$1:{$:1,$0:1}})},$2:null,$3:{$:1,$0:bj.ofArray([new A({$:0,$0:"wit/ordinal",$1:"",$2:"one",$3:{$:1,$0:1}})])}})}:null;};E.QuickNo=function(bC){var bD;return bC==="no"||(bC==="nope"||(bC==="no way"||(bC==="nah"||(bC==="don't do it"||bC==="stop"))))?{$:1,$0:new B({$:0,$0:"no",$1:{$:1,$0:new y({$:0,$0:"reject",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};E.QuickYes=function(bC){var bD;return bC==="yes"||(bC==="ok"||(bC==="sure"||(bC==="yeah"||(bC==="yep"||(bC==="uh huh"||(bC==="go ahead"||bC==="go"))))))?{$:1,$0:new B({$:0,$0:"yes",$1:{$:1,$0:new y({$:0,$0:"verify",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};E.QuickHelp=function(bC){var bD;return bC==="help"||(bC==="help me"||(bC==="what's this?"||bC==="huh"))?{$:1,$0:new B({$:0,$0:"help",$1:{$:1,$0:new y({$:0,$0:"help",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};E.QuickHello=function(bC){var bD;return bC==="hello"||(bC==="hey"||(bC==="yo"||bC==="hi"))?{$:1,$0:new B({$:0,$0:"hello",$1:{$:1,$0:new y({$:0,$0:"greet",$1:{$:1,$0:1}})},$2:null,$3:null})}:null;};E.Voices=function(bC){return bC==="voices"?{$:1,$0:null}:null;};E.Debug=function(bC){return bC==="debug"?{$:1,$0:null}:null;};E.Blank=function(bC){return bC===""?{$:1,$0:null}:null;};J=x.EmotionalTrait=_.Class({get_Frequence:function(){return this.$2;},get_Hierarchy:function(){return this.$1;},get_Label:function(){return this.$0;}},null,J);K.Study=function(bC){return bC.get_Traits()!=null?{$:0,$0:null}:{$:1,$0:null};};x.StrA=function(bC){if(bC!=null&&bC.$==1)try{return{$:1,$0:((bt.DecodeArray(bt.Id()))())(bu.parse(bC.$0))};}catch(bD){return null;}else return null;};x.PStr=function(bC){var bD;return bC!=null&&bC.$==1&&(typeof bC.$0=="string"&&(bD=bC.$0,true))?{$:1,$0:bD}:null;};x.No=function(bC){var bD,bE;return(bE=x.Intent$1("reject",bC),bE!=null&&bE.$==1&&(bE.$0[0]==null&&(bE.$0[1]==null&&(bD=bC,true))))?{$:1,$0:bD}:null;};x.Yes=function(bC){var bD,bE;return(bE=x.Intent$1("verify",bC),bE!=null&&bE.$==1&&(bE.$0[0]==null&&(bE.$0[1]==null&&(bD=bC,true))))?{$:1,$0:bD}:null;};x.EntityManyofMany=function(bC,bD){return{$:1,$0:bp.OfArray(_7.ofSeq(bj.map(function(bE){return bj.exists(function(bF){return bF.get_Role()===bE;},bD)?[bE,{$:1,$0:bj.filter(function(bF){return bF.get_Role()===bE;},bD)}]:[bE,null];},bC)))};};x.EntityManyOf1=function(bC,bD){var bE;return bD!=null&&bD.$==1&&(bj.exists(function(bF){return bF.get_Role()===bC;},bD.$0)&&(bE=bD.$0,true))?{$:1,$0:bj.filter(function(bF){return bF.get_Role()===bC;},bE)}:null;};x.Entity1OfAny=function(bC,bD){var bE;return bD!=null&&bD.$==1&&(bj.exists(function(bF){return bF.get_Role()===bC;},bD.$0)&&(bE=bD.$0,true))?{$:1,$0:bj.head(bj.sortBy(function(bF){return bF.get_Role();},bj.filter(function(bF){return bF.get_Role()===bC;},bE)))}:null;};x.Entity1Of1=function(bC,bD){var bE,bF;return bD!=null&&bD.$==1&&(bD.$0.$==1&&(bD.$0.$1.$==0&&((bF=bD.$0.$0,bF.get_Role()===bC||bF.get_Name()===bC)&&(bE=bD.$0.$0,true))))?{$:1,$0:bE}:null;};x.Intent$1=function(bC,bD){return bD.get_Intent()!=null&&bD.get_Intent().$0.get_Name()===bC?{$:1,$0:[bD.get_Traits(),bD.get_Entities()]}:null;};L.$cctor=function(){L.$cctor=a.ignore;L.entity_types=bj.ofArray(["wit$contact:name","wit$datetime:datetime","term:subject","term:object","term:verb"]);L.trait_types=bj.ofArray(["domain","dialogue_act"]);L.intentConfidenceThreshold=0.85;L.entityConfidenceThreshold=0.85;};N.MicReady={$:5};N.MicAudioEnd={$:4};N.MicAudioStart={$:3};N.MicDisconnected={$:2};N.MicConnecting={$:1};N.MicNotInitialized={$:0};O.ClientUnderstand={$:2};O.ClientReady={$:1};O.ClientNotInitialzed={$:0};P=M.Interpreter=_.Class({get_Options:function(){return(this.get_Unwrap())[2];},get_Text:function(){return(this.get_Unwrap())[1];},get_Voice:function(){return(this.get_Unwrap())[0];},get_Unwrap:function(){return[this.$0,this.$1[0],this.$1[1]];}},null,P);Q=M.CUI=_.Class({SayVoices:function(){var bC,bD,bE;bC=this;bD=a.speechSynthesis.getVoices();!(bD==null)?(bE=d.toArray(bD),bC.Say((function(bF){return function(bG){return bF("There are currently "+a.String(bG)+" voices installed on this computer or device.");};}(a.id))(_7.length(bE))),_7.iteri(function(bF,bG){return bC.Say(((((_.Curried(function(bH,bI,bJ,bK){return bH("Voice "+a.String(bI)+". Name: "+bf.toSafe(bJ)+", Local: "+bf.prettyPrint(bK)+".");},4))(a.id))(bF))(bG.name))(bG.localService));},bE)):void 0;},Wait:function(bC){this.Wait$1(function(){bm.Start(bC,null);});},Wait$1:function(bC){this["Echo'"]("please wait...");this.Term.pause();bC();this.Term.resume();},sayRandom:function(bC,bD){this.Say(v.getRandomPhrase(bC,bD));},SayAngry:function(bC){var bD,bE;bD=this;bm.Start((bE=null,bm.Delay(function(){return bm.Combine(a.speechSynthesis.speaking?(a.speechSynthesis.cancel(),bv.chime(),bm.Zero()):bm.Zero(),bm.Delay(function(){a.addMessage(bD.Avatar,bC,"","");bD.Avatar.processMessages(0);return bm.Zero();}));})),null);},SayDoc:function(bC){var bD,bE,bF;bD=_7.get(bh(".terminal-output").get(),0).childNodes.length;bE=bb.Element("div",[d.cls("terminal-command"),d.dindex(bD+1)],[bC]);bF=d.terminalOutput();be.LoadLocalTemplates("");bb.RunAppend(bF,bE);},Say:function(bC){var bD,bE;bD=this;bm.Start((bE=null,bm.Delay(function(){return bm.Combine(a.speechSynthesis.speaking?(bv.chime(),bm.Zero()):bm.Zero(),bm.Delay(function(){bD.Avatar.addMessage(bC);bD.Avatar.processMessages(0);return bm.Zero();}));})),null);},Debug:function(bC,bD){d.debug(bC,bD);},"EchoHtml'":function(bC){var bD,bE;bD=(bE={},bE.raw=true,bE);this.Term.disable();this.Term.echo(bC,bD);this.Term.enable();},"Echo'":function(bC){this.Term.disable();this.Term.echo(bC);this.Term.enable();}},null,Q);Q.New=function(bC,bD,bE,bF,bG,bH,bI){return new Q({Voice:bC,Mic:bD,Term:bE,Avatar:bF,Caption:bG,AudioHandlers:bH,TypingDNA:bI});};R=c.Dialogue=_.Class({get_Utterances:function(){return this.$4;},get_Output:function(){return this.$3;},get_DialogueQuestions:function(){return this.$2;},get_Props:function(){return this.$1;},get_Cui:function(){return this.$0;}},null,R);S=c.Question=_.Class({toString:function(){return((((_.Curried(function(bC,bD,bE,bF){return bC("Name: "+bf.toSafe(bD)+" Module: "+bf.toSafe(bE)+" Type: "+_4.p$8(bF)+" ");},4))(a.id))(this.get_Name()))(this.get_Module()))(this.get_Type());},get_Target:function(){return this.$4;},get_Params:function(){return this.$3;},get_Type:function(){return this.$2;},get_Module:function(){return this.$1;},get_Name:function(){return this.$0;}},null,S);T.ConceptCompletion={$:3};T.Disjunctive={$:2};T.Verification={$:1};U["Response'_"]=function(bC,bD,bE){var bF,bG,bH,bI,bJ,bK,bL,bM;return(bG=U.PropNotSet_(bC,"user",bE),bG!=null&&bG.$==1?(bH=U.Form(bC,bD,bG.$0),bH!=null&&bH.$==1?(bF=bH.$0,true):(bI=U.PropNotSet_(bC,"user",bE),bI!=null&&bI.$==1&&(bJ=U.NotForm(bC,bD,bI.$0),bJ!=null&&bJ.$==1&&(bF=bJ.$0,true)))):(bK=U.PropNotSet_(bC,"user",bE),bK!=null&&bK.$==1&&(bL=U.NotForm(bC,bD,bK.$0),bL!=null&&bL.$==1&&(bF=bL.$0,true))))?(bM=U.have(bC,bD)?{$:1,$0:U.prop(bC,bD)}:null,bF.get_Text()!==""?{$:1,$0:[bF,{$:1,$0:bF.get_Text()},bM]}:{$:1,$0:[bF,null,bM]}):null;};U.Response_=function(bC,bD,bE){var bF,bG,bH,bI,bJ,bK,bL,bM;return(bG=U.PropSet_(bC,"user",bE),bG!=null&&bG.$==1?(bH=U.Form(bC,bD,bG.$0),bH!=null&&bH.$==1?(bF=bH.$0,true):(bI=U.PropSet_(bC,"user",bE),bI!=null&&bI.$==1&&(bJ=U.NotForm(bC,bD,bI.$0),bJ!=null&&bJ.$==1&&(bF=bJ.$0,true)))):(bK=U.PropSet_(bC,"user",bE),bK!=null&&bK.$==1&&(bL=U.NotForm(bC,bD,bK.$0),bL!=null&&bL.$==1&&(bF=bL.$0,true))))?(bM=U.have(bC,bD)?{$:1,$0:U.prop(bC,bD)}:null,bF.get_Text()!==""?{$:1,$0:[bF,{$:1,$0:bF.get_Text()},bM]}:{$:1,$0:[bF,null,bM]}):null;};U.NotForm=function(bC,bD,bE){return bC.get_DialogueQuestions().length>0&&(bC.get_DialogueQuestions())[0].get_Name()===bD&&bE.get_Text()!==""?{$:1,$0:bE}:null;};U.Form=function(bC,bD,bE){return bC.get_DialogueQuestions().length>0&&(bC.get_DialogueQuestions())[0].get_Name()===bD&&bE.get_Intent()!=null&&bE.get_Intent().$0.get_Name()===bD&&bw.Equals(bE.get_Intent().$0.get_Confidence(),{$:1,$0:1})&&bw.Equals(bE.get_Traits(),null)&&bw.Equals(bE.get_Entities(),null)?{$:1,$0:bE}:null;};U["User'_"]=function(bC,bD){var bE,bF;return(bF=U.PropNotSet_(bC,"user",bD),bF!=null&&bF.$==1&&(bC.get_DialogueQuestions().length===0&&(bE=bF.$0,true)))?{$:1,$0:bE}:null;};U.User_=function(bC,bD){var bE,bF;return(bF=U.PropSet_(bC,"user",bD),bF!=null&&bF.$==1&&(bC.get_DialogueQuestions().length===0&&(bE=bF.$0,true)))?{$:1,$0:bE}:null;};U.PropNotSet_=function(bC,bD,bE){return!U.have(bC,bD)?{$:1,$0:bE}:null;};U.PropSet_=function(bC,bD,bE){return U.have(bC,bD)?{$:1,$0:bE}:null;};U.Agenda_=function(bC,bD,bE,bF){return bC.get_DialogueQuestions().length>0&&(bC.get_DialogueQuestions())[0].get_Module()===bE?{$:1,$0:null}:null;};U.debugInterpreterEnd=function(bC,bD,bE){bD(((((_.Curried(function(bF,bG,bH,bI){return bF(bf.toSafe(bG)+" ending utterances:"+bf.prettyPrint(bH)+", questions: "+bf.prettyPrint(bI)+".");},4))(a.id))(bE))(bC.get_Utterances()))(bC.get_DialogueQuestions()));};U.debugInterpreterStart=function(bC,bD,bE){bD(((((_.Curried(function(bF,bG,bH,bI){return bF(bf.toSafe(bG)+" starting utterances:"+bf.prettyPrint(bH)+", questions: "+bf.prettyPrint(bI)+".");},4))(a.id))(bE))(bC.get_Utterances()))(bC.get_DialogueQuestions()));};U.frame=function(bC){return bj.ofSeq(bk.take(bC.length>=5?5:bC.length,bC));};U.didNotUnderstand=function(bC,bD,bE){bD((function(bF){return function(bG){return bF(bf.toSafe(bG)+" interpreter did not understand utterance.");};}(a.id))(bE));U.popu(bC,bD);U.say(bC,"Sorry I didn't understand what you meant.");};U.endt=function(bC,bD,bE,bF){U.popu(bC,bD);U.popq(bC,bD);U.have(bC,bE)?U.remove(bC,bD,bE):void 0;bD((function(bG){return function(bH){return bG("End turn "+bf.toSafe(bH)+".");};}(a.id))(bE));bF();};U.cancel=function(bC,bD,bE){var bF;bF=(bC.get_DialogueQuestions())[0];bF.get_Name()!==bE?(((_.Curried3(function(bG,bH,bI){return bG(_4.p$9(bH)+" at the top of the stack does not have the name "+bf.toSafe(bI)+".");}))($.FailWith))(bF))(bE):void 0;U.popq(bC,bD);bD((function(bG){return function(bH){return bG("Cancel "+_4.p$9(bH)+".");};}(a.id))(bF));};U.trigger=function(bC,bD,bE,bF,bG){U.pushu(bC,bD,new B({$:0,$0:bu.stringify(bG),$1:{$:1,$0:new y({$:0,$0:bF,$1:{$:1,$0:1}})},$2:null,$3:null}));bE(bC);};U.handle=function(bC,bD,bE,bF){U.popu(bC,bD);bD((function(bG){return function(bH){return bG("Handle utterance "+bf.toSafe(bH)+".");};}(a.id))(bE));bF();};U.dispatch=function(bC,bD,bE,bF){bD(((((_.Curried(function(bG,bH,bI,bJ){return bG("Dispatch to module "+bf.toSafe(bH)+" utterances: "+bf.prettyPrint(bI)+" questions: "+bf.prettyPrint(bJ)+".");},4))(a.id))(bE))(bC.get_Utterances()))(bC.get_DialogueQuestions()));bF(bC);};U.popq=function(bC,bD){var bE;bE=bC.get_DialogueQuestions().shift();bD((function(bF){return function(bG){return bF("Pop "+_4.p$9(bG)+".");};}(a.id))(bE));};U.pushq=function(bC,bD,bE){bC.get_DialogueQuestions().unshift(bE);bD((function(bF){return function(bG){return bF("Push "+_4.p$9(bG)+".");};}(a.id))(bE));};U.popu=function(bC,bD){var bE;bE=bC.get_Utterances().shift();bD((function(bF){return function(bG){return bF("Pop "+_4.p$7(bG)+".");};}(a.id))(bE));};U.pushu=function(bC,bD,bE){bD((function(bF){return function(bG){return bF("Push "+_4.p$7(bG)+".");};}(a.id))(bE));bC.get_Utterances().unshift(bE);};U.remove=function(bC,bD,bE){bD((function(bF){return function(bG){return bF("Remove property "+bf.toSafe(bG)+".");};}(a.id))(bE));bC.get_Props().Remove(bE);};U.add=function(bC,bD,bE,bF){bC.get_Props().Add(bE,bF);bD((((_.Curried3(function(bG,bH,bI){return bG("Add property "+bf.toSafe(bH)+":"+bf.prettyPrint(bI)+".");}))(a.id))(bE))(bF));};U.prop=function(bC,bD){return bC.get_Props().ContainsKey(bD)?bC.get_Props().get_Item(bD):(function(bE){return function(bF){return bE("The "+bf.toSafe(bF)+" dialogue property does not exist.");};}($.FailWith))(bD);};U.have=function(bC,bD){return bC.get_Props().ContainsKey(bD);};U["sayRandom'"]=function(bC,bD){U.sayRandom(bC,bD,"");};U.sayRandom=function(bC,bD,bE){var bF;bF=v.getRandomPhrase(bD,bE);bC.get_Output().unshift(bF);bC.get_Cui().Say(bF);};U.say=function(bC,bD){bC.get_Output().unshift(bD);U["say'"](bC,bD);};U["say'"]=function(bC,bD){bC.get_Cui().Say(bD);};U.echo=function(bC,bD){(bC.get_Cui())["EchoHtml'"](bD);};V.ask=function(bC,bD,bE){var bF,bG,bH,bI;function bJ(bO){U.say(bC,bO);}function bK(bO){bO.input="text";bO.showCancelButton=true;bO.confirmButtonText="Ok";}function bL(bO){bO.confirmButtonClass="invisible";bO.showCancelButton=true;}function bM(){var bO;bO=d.createDialogueBoxCanvas();d.startCamera(self.document.body,bO);}function bN(bO){var bP,bQ;bP=bO[0];bQ=bO[1];d.questionBox("Biometric Authentication","",{$:1,$0:d.boxesWithTitles(["2","3"])},{$:1,$0:[640,480]},{$:1,$0:bK},{$:1,$0:bM},function(bR){var bS,bT,bU,bV;bR.isConfirmed?(bS=bC.get_Cui().TypingDNA.getTypingPattern((bT={},bT.type=1,bT.text=bI,bT.caseSensitive=false,bT)),bU=bR.value,bV=d.getCameraCanvas().toDataURL(),bD((function(bW){return function(bX){return bW("User image is "+bf.toSafe(bX)+"...");};}(a.id))(bi.Substring(bV,0,10))),d.stopCamera(),bD((((_.Curried3(function(bW,bX,bY){return bW("User entered typing pattern "+bf.toSafe(bX)+" for text "+bf.toSafe(bY));}))(a.id))(bS))(bU)),bU.toLowerCase()!==bI.toLowerCase()?(bJ("Sorry you did not enter the passphrase correctly. Please try again."),bN([bP,bQ])):d.questionBox("Biometric Authentication","",null,null,{$:1,$0:bL},{$:1,$0:function(){d.getDialogueBoxContent().appendChild(d.getMic());bC.get_Cui().AudioHandlers.Add("VoiceAuthentication",function(bW){bu.stringify(((bt.Id())())(bW));d.confirmQuestionBox();});}},function(bW){if(!bW.isConfirmed){bC.get_Cui().AudioHandlers.Remove("VoiceAuthentication");bJ("OK but you must login for me to help you.");}})):bJ("OK but you must login for me to help you.");});}U.pushq(bC,bD,bE);bF=bE.get_Type();bF.$==0?(bG=bE.get_Target(),bH=bE.get_Name(),bI=(function(bO){return function(bP){return bO("Hello my name is "+bf.toSafe(bP)+" and I am an administrator");};}(a.id))(bF.$0),bJ((function(bO){return function(bP){return bO("Enter the phrase "+bf.toSafe(bP)+".");};}(a.id))(bI)),bN([0,[]])):$.FailWith("Not implemented");};W.update=function(bC){var bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd;function ce(cp){U.say(bC,cp);}function cf(cp,cq){return U.sayRandom(bC,cp,cq);}function cg(cp,cq){return U.add(bC,function(cr){W.debug(cr);},cp,cq);}function ch(cp){W.debug(cp);}function ci(cp){W.debug(cp);}function cj(cp){W.debug(cp);}function ck(cp){return U["User'_"](bC,cp);}function cl(cp,cq){return U.Response_(bC,cp,cq);}function cm(cp,cq){return U["Response'_"](bC,cp,cq);}function cn(cp){var cq;cf(v.waitRetrievePhrases(),"user name");bm.Start((cq=null,bm.Delay(function(){return bm.Bind((new by.New()).Async("SMApp.Web:SMApp.Web.Server.getUser:-2029537815",[cp]),function(cr){var cs;return cr==null?(ce((function(ct){return function(cu){return ct("I did not find a user with the name "+bf.toSafe(cu)+".");};}(a.id))(cp)),bF(new S({$:0,$0:"addUser",$1:W.name(),$2:T.Verification,$3:null,$4:function(){cg("addUser",cp);ce((function(ct){return function(cu){return ct("Do you want me to add the user "+bf.toSafe(cu)+"?");};}(a.id))(cp));}})),bm.Zero()):(cs=cr.$0,bm.Bind((new by.New()).Async("SMApp.Web:SMApp.Web.Server.updateUserLastLogin:-1089977706",[cs.Name]),function(){cf(v.helloUserPhrases(),cs.Name);return cs.LastLoggedIn!=null?bm.Bind((new by.New()).Async("SMApp.Web:SMApp.Web.Server.humanize:-2070755814",[cs.LastLoggedIn.$0]),function(ct){ce((function(cu){return function(cv){return cu("You last logged in "+bf.toSafe(cv)+".");};}(a.id))(ct));return bm.Zero();}):bm.Zero();}));});})),null);}function co(cp){return new S({$:0,$0:"switchUser",$1:W.name(),$2:T.Verification,$3:null,$4:function(){ce((function(cq){return function(cr){return cq("Do you want me to switch to the user "+bf.toSafe(cr));};}(a.id))(cp));}});}U.debugInterpreterStart(bC,function(cp){W.debug(cp);},W.name());bD=_.Curried(U.handle,2,[bC,ch]);bE=_.Curried(U.endt,2,[bC,ci]);bF=function(cp){V.ask(bC,cj,cp);};bG=U.frame(bC.$4);bG.$==1&&(bI=ck(bG.$0),bI!=null&&bI.$==1&&(bJ=x.Intent$1("greet",bI.$0),bJ!=null&&bJ.$==1&&(bK=x.Entity1Of1("name",bJ.$0[1]),bK!=null&&bK.$==1&&(bG.$1.$==0&&(bH=bK.$0,true)))))?(bD("loginUser"))(function(){cn(bH.get_Value());}):bG.$==1&&(bM=ck(bG.$0),bM!=null&&bM.$==1&&(bN=x.Intent$1("hello",bM.$0),bN!=null&&bN.$==1&&(bO=x.Entity1Of1("contact",bN.$0[1]),bO!=null&&bO.$==1&&(bG.$1.$==0&&(bL=bO.$0,true)))))?(bD("loginUser"))(function(){cn(bL.get_Value());}):bG.$==1&&(bQ=cm("authenticateUser",bG.$0),bQ!=null&&bQ.$==1&&(bR=x.StrA(bQ.$0[1]),bR!=null&&bR.$==1&&(bG.$1.$==0&&(bP=bR.$0,true))))?(bE("authenticateUser"))(function(){var cp;W.debug(bP);bm.Start((cp=null,bm.Delay(function(){return bm.Bind((new by.New()).Async("SMApp.Web:SMApp.Web.Server.hasFace:-1654843716",[_7.get(bP,2)]),function(cq){return cq?(ce("Face detected"),bm.Zero()):(ce(function(cr){return cr("Sorry I did not detect a face in the camera image. Make sure you can see the red square around your face in the camera window when you click the OK button.");}(a.id)),bm.Zero());});})),null);}):bG.$==1&&(bT=x.No(bG.$0),bT!=null&&bT.$==1&&(bU=cm("addUser",bT.$0),bU!=null&&bU.$==1&&(bV=x.PStr(bU.$0[2]),bV!=null&&bV.$==1&&(bG.$1.$==0&&(bS=bV.$0,true)))))?(bE("addUser"))(function(){ce((function(cp){return function(cq){return cp("Ok I did not add the user "+bf.toSafe(cq)+". But you must login for me to help you.");};}(a.id))(bS));}):bG.$==1&&(bX=x.Yes(bG.$0),bX!=null&&bX.$==1&&(bY=cm("addUser",bX.$0),bY!=null&&bY.$==1&&(bZ=x.PStr(bY.$0[2]),bZ!=null&&bZ.$==1&&(bG.$1.$==0&&(bW=bZ.$0,true)))))?(bE("addUser"))(function(){bF(new S({$:0,$0:"authenticateNewUser1",$1:W.name(),$2:{$:0,$0:bW},$3:null,$4:function(cp){W.update(cp);}}));}):bG.$==1&&(b1=cm("authenticateNewUser1",bG.$0),b1!=null&&b1.$==1&&(b2=x.StrA(b1.$0[1]),b2!=null&&b2.$==1&&(bG.$1.$==0&&(b0=b2.$0,true))))?(bE("authenticateNewUser1"))(function(){ce((function(cp){return function(cq){return cp("Authenticate new user "+bf.toSafe(cq)+".");};}(a.id))(_7.get(b0,0)));}):bG.$==1&&(b4=U.User_(bC,bG.$0),b4!=null&&b4.$==1&&(b5=x.Intent$1("hello",b4.$0),b5!=null&&b5.$==1&&(b5.$0[0]==null&&(b6=x.Entity1Of1("name",b5.$0[1]),b6!=null&&b6.$==1&&(bG.$1.$==0&&(b3=b6.$0,true))))))?bm.Start((b7=null,bm.Delay(function(){return bm.Bind((new by.New()).Async("SMApp.Web:SMApp.Web.Server.getUser:-2029537815",[b3.get_Value()]),function(cp){return cp==null?(ce((function(cq){return function(cr){return cq("Sorry, the user "+bf.toSafe(cr)+" does not exist.");};}(a.id))(b3.get_Value())),bm.Zero()):(bF(co(cp.$0.Name)),bm.Zero());});})),null):bG.$==1&&(b9=x.Yes(bG.$0),b9!=null&&b9.$==1&&(b_=cl("switchUser",b9.$0),b_!=null&&b_.$==1&&(b$=x.PStr(b_.$0[2]),b$!=null&&b$.$==1&&(bG.$1.$==0&&(b8=b$.$0,true)))))?(bC.$1.set_Item("user",b8),ce((function(cp){return function(cq){return cp("Ok I switched to user "+bf.prettyPrint(cq)+".");};}(a.id))(b8))):bG.$==1&&(cb=x.No(bG.$0),cb!=null&&cb.$==1&&(cc=cl("switchUser",cb.$0),cc!=null&&cc.$==1&&(cd=x.PStr(cc.$0[2]),cd!=null&&cd.$==1&&(bG.$1.$==0&&(ca=cd.$0,true)))))?ce((function(cp){return function(cq){return cp("Ok I did not switch to user "+bf.toSafe(cq)+".");};}(a.id))(ca)):U.didNotUnderstand(bC,function(cp){W.debug(cp);},W.name());U.debugInterpreterEnd(bC,function(cp){W.debug(cp);},W.name());};W.debug=function(bC){d.debug(W.name(),bC);};W.name=function(){X.$cctor();return X.name;};X.$cctor=function(){X.$cctor=a.ignore;X.name="User";};Y.update=function(bC){var bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS;function bT(bZ){U.say(bC,bZ);}function bU(bZ,b0){return U.sayRandom(bC,bZ,b0);}function bV(bZ){return U.prop(bC,bZ);}function bW(bZ){return U.User_(bC,bZ);}function bX(){return bV("user");}function bY(bZ,b0,b1){var b2;return bm.Start((b2=null,bm.Delay(function(){bU(v.waitAddPhrases(),"symptom entry");return bm.Bind((new by.New()).Async("SMApp.Web:SMApp.Web.Server.addSymptomJournalEntry:-1116953149",[bX().Name,bZ,b0,b1]),function(b3){return b3.$==1?(bT(function(b4){return b4("Sorry I wasn't able to add that symptom to your journal. Could you try again?");}(a.id)),bm.Zero()):(bT((function(b4){return function(b5){return b4("OK I added that "+bf.toSafe(b5)+" symptom to your journal.");};}(a.id))(bZ)),bm.Zero());});})),null);}U.debugInterpreterStart(bC,function(bZ){Y.debug(bZ);},Y.name());bD=U.frame(bC.$4);bD.$==1&&(bF=bW(bD.$0),bF!=null&&bF.$==1&&(bG=x.Intent$1("symptom",bF.$0),bG!=null&&bG.$==1&&(bH=x.Entity1OfAny("symptom_name",bG.$0[1]),bH!=null&&bH.$==1&&(bD.$1.$==0&&(bE=bH.$0,true)))))?bm.Start((bI=null,bm.Delay(function(){bT("Ok I'll add that entry to your symptom journal");bY(bE.get_Value(),null,null);return bm.Zero();})),null):bD.$==1&&(bK=x.Yes(bD.$0),bK!=null&&bK.$==1&&((bL=U.Response_(bC,"painVideo",bK.$0),bL!=null&&bL.$==1)&&bD.$1.$==0))?bC.$0["EchoHtml'"]("<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/SkAqOditKN0\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>"):bD.$==1&&(bN=bW(bD.$0),bN!=null&&bN.$==1&&(bO=x.Intent$1("medjournal",bN.$0),bO!=null&&bO.$==1&&((bP=bO.$0[1],bP!=null&&bP.$==1)&&(bD.$1.$==0&&(bM=bO.$0[1].$0,true)))))?(bT("ok I added that entry to your medication journal."),bT("You should be careful not to take too many painkillers over a short period of time.")):bD.$==1&&(bR=bW(bD.$0),bR!=null&&bR.$==1&&((bS=x.Intent$1("kbquery",bR.$0),bS!=null&&bS.$==1)&&(bD.$1.$==0&&(bQ=bR.$0,true))))?void 0:U.didNotUnderstand(bC,function(bZ){Y.debug(bZ);},Y.name());U.debugInterpreterEnd(bC,function(bZ){Y.debug(bZ);},Y.name());};Y.debug=function(bC){d.debug(Y.name(),bC);};Y.name=function(){Z.$cctor();return Z.name;};Z.$cctor=function(){Z.$cctor=a.ignore;Z.name="Symptoms";};_0.update=function(bC){var bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX;function bY(b3){U.say(bC,b3);}function bZ(b3){U["sayRandom'"](bC,b3);}function b0(b3){_0.debug(b3);}function b1(b3){_0.debug(b3);}function b2(b3){return U["User'_"](bC,b3);}bD=bC.$4;_0.debug(((((_.Curried(function(b3,b4,b5,b6){return b3("Module "+bf.toSafe(b4)+" starting utterances:"+bf.prettyPrint(b5)+", questions: "+bf.prettyPrint(b6)+".");},4))(a.id))(_0.name()))(bD))(bC.$2));bE=_.Curried(U.dispatch,2,[bC,b0]);bF=_.Curried(U.handle,2,[bC,b1]);bG=U.frame(bD);bH=U.Agenda_(bC,function(b3){_0.debug(b3);},W.name(),bG);bH!=null&&bH.$==1?(_0.debug((function(b3){return function(b4){return b3("Agenda is "+_4.p$9(b4)+".");};}(a.id))((bC.get_DialogueQuestions())[0])),W.update(bC)):bG.$==1&&(bJ=(bK=U.PropNotSet_(bC,"started",bG.$0),bK!=null&&bK.$==1?{$:1,$0:bK.$0}:null),bJ!=null&&bJ.$==1&&(bL=b2(bJ.$0),bL!=null&&bL.$==1&&(bM=x.Intent$1("greet",bL.$0),bM!=null&&bM.$==1&&(bM.$0[1]==null&&bG.$1.$==0))))?(U.add(bC,function(b3){_0.debug(b3);},"started",true),(bF("greet"))(function(){bZ(v.helloPhrases());})):bG.$==1&&(bO=b2(bG.$0),bO!=null&&bO.$==1&&(bP=x.Intent$1("greet",bO.$0),bP!=null&&bP.$==1&&(bP.$0[1]==null&&bG.$1.$==0)))?(bF("greet"))(function(){bY("Hello, tell me your name to get started.");}):bG.$==1&&(bR=b2(bG.$0),bR!=null&&bR.$==1&&(bS=x.Intent$1("greet",bR.$0),bS!=null&&bS.$==1&&((bT=x.Entity1Of1("name",bS.$0[1]),bT!=null&&bT.$==1)&&bG.$1.$==0)))?(bE(W.name()))(function(b3){W.update(b3);}):bG.$==1&&(bV=b2(bG.$0),bV!=null&&bV.$==1&&(bW=x.Intent$1("hello",bV.$0),bW!=null&&bW.$==1&&((bX=x.Entity1Of1("contact",bW.$0[1]),bX!=null&&bX.$==1)&&bG.$1.$==0)))?(bE(W.name()))(function(b3){W.update(b3);}):U.didNotUnderstand(bC,function(b3){_0.debug(b3);},_0.name());U.debugInterpreterEnd(bC,function(b3){_0.debug(b3);},_0.name());};_0.debug=function(bC){d.debug(_0.name(),bC);};_0.name=function(){_1.$cctor();return _1.name;};_1.$cctor=function(){_1.$cctor=a.ignore;_1.name="Main";};_2.run=function(){var bC,bD;bC=_.ThisFunc(function(bE,bF){return((_2.Main().get_Text())(bE))(bF);});bD=_2.Main().get_Options();a.$("#term").terminal(bC,bD);return bb.get_Empty();};_2.Main=function(){_3.$cctor();return _3.Main;};_2.initMic=function(bC){var bD,bE;_2.set_CUI((bD={$:1,$0:new bz.Microphone(bA.getElementById("microphone"))},Q.New(_2.CUI().Voice,bD,_2.CUI().Term,_2.CUI().Avatar,_2.CUI().Caption,_2.CUI().AudioHandlers,_2.CUI().TypingDNA)));bE=_2.CUI().Mic.$0;bE.onconnecting=function(){_2.set_MicState(N.MicConnecting);return _2.debug("Mic connecting...");};bE.ondisconnected=function(){_2.set_MicState(N.MicDisconnected);return _2.debug("Mic disconnected.");};bE.onaudiostart=function(){_2.set_MicState(N.MicAudioStart);return _2.debug("Mic audio start...");};bE.onaudioend=function(){var bF,bG,bH,bI;_2.debug("Mic audio end.");bG=_2.CUI().AudioHandlers;bF=bG.GetEnumerator$1();try{while(bF.MoveNext()){bH=bF.Current();_2.debug((function(bJ){return function(bK){return bJ("Executing audio handler "+bf.toSafe(bK)+".");};}(a.id))(bH.K));_2.set_MicState({$:7,$0:bH.K});bI=bH.V;_2.CUI().AudioHandlers.Remove(bH.K);bI(d.lastMicData());}return;}finally{bF.Dispose();}};bE.onerror=function(bF){_2.set_MicState({$:6,$0:bF});return _2.debug((function(bG){return function(bH){return bG("Mic error : "+bf.toSafe(bH)+".");};}(a.id))(bF));};bE.onready=function(){_2.set_MicState(N.MicReady);return _2.debug("Mic ready.");};bE.onresult=function(bF,bG){return _2.ClientState().$==2?_2.echo("I'm still trying to understand what you said before."):_2.ClientState().$==0?d.error("Client is not intialized."):_2.MicState().$==7?null:!(bF==null||bG==null)?(_2.set_MicState({$:8,$0:bF,$1:bG}),_2.debug((((_.Curried3(function(bH,bI,bJ){return bH("Mic result: "+bf.prettyPrint(bI)+" "+bf.prettyPrint(bJ)+".");}))(a.id))(bF))(bG)),bC(bF,bG)):_2.debug("Mic: No result returned.");};bE.connect("4Y2BLQY5TWLIN7HFIV264S53MY4PCUAT");};_2.sayRandom=function(bC,bD){_2.say(v.getRandomPhrase(bD,bC));};_2.say=function(bC){_2.Output().unshift(bC);_2["say'"](bC);};_2["say'"]=function(bC){_2.CUI().Say(bC);};_2.initSpeech=function(){var bC;bC=d.toArray(_2.synth().getVoices());_7.length(bC)>0?(_7.iter(function(bD){if(bw.Equals(_2.CUI().Voice,null)&&(bD.name.indexOf("Microsoft Zira")!=-1||bD.name.toLowerCase().indexOf("female")!=-1)){_2.set_CUI(Q.New({$:1,$0:bD},_2.CUI().Mic,_2.CUI().Term,_2.CUI().Avatar,_2.CUI().Caption,_2.CUI().AudioHandlers,_2.CUI().TypingDNA));_2.debug((function(bE){return function(bF){return bE("Using browser speech synthesis voice "+bf.toSafe(bF)+".");};}(a.id))(_2.CUI().Voice.$0.name));}},bC),!bw.Equals(_2.CUI().Voice,null)?(_2.CUI().Avatar.nativeVoice=true,_2.CUI().Avatar.nativeVoiceName=_2.CUI().Voice.$0.name,_2.debug((function(bD){return function(bE){return bD("Using browser speech synthesis voice "+bf.toSafe(bE)+".");};}(a.id))(_2.CUI().Voice.$0.name))):void 0):void 0;bw.Equals(_2.CUI().Voice,null)?_2.debug("No female browser speech synthesis voice is available. Using CMU SLT Female voice via TTS."):void 0;};_2.synth=function(){_3.$cctor();return _3.synth;};_2.push=function(bC){_2.Utterances().unshift(bC);return _2.Dialogue();};_2.Dialogue=function(){_3.$cctor();return _3.Dialogue;};_2.Utterances=function(){_3.$cctor();return _3.Utterances;};_2.Questions=function(){_3.$cctor();return _3.Questions;};_2.Output=function(){_3.$cctor();return _3.Output;};_2.Props=function(){_3.$cctor();return _3.Props;};_2.wait=function(bC){d["Terminal.Echo'"](_2.CUI().Term,"please wait");_2.CUI().Term.pause();bC();_2.CUI().Term.resume();};_2.debug=function(bC){d.debug("CLIENT",bC);};_2.echo=function(bC){d["Terminal.EchoHtml'"](_2.CUI().Term,(function(bD){return function(bE){return bD(bf.prettyPrint(bE));};}(a.id))(bC));};_2.ClientState=function(){_3.$cctor();return _3.ClientState;};_2.set_ClientState=function(bC){_3.$cctor();_3.ClientState=bC;};_2.MicState=function(){_3.$cctor();return _3.MicState;};_2.set_MicState=function(bC){_3.$cctor();_3.MicState=bC;};_2.CUI=function(){_3.$cctor();return _3.CUI;};_2.set_CUI=function(bC){_3.$cctor();_3.CUI=bC;};_3.$cctor=function(){var bC,bD,bE;_3.$cctor=a.ignore;function bF(bH,bI){var bJ,bK,bL,bM,bN,bO,bP;_2.debug((((_.Curried3(function(bQ,bR,bS){return bQ("Voice: "+bf.prettyPrint(bR)+" "+bf.prettyPrint(bS));}))(a.id))(bH))(bI));bJ=(bK=C["Intent'"](bH,bI),bK!=null&&bK.$==1?{$:1,$0:bK.$0}:null);bL=(bM=C["Trait'"](bI),bM!=null&&bM.$==1?{$:1,$0:bj.ofArray([bM.$0])}:null);bN=(bO=C["Entity'$1"](bI),bO!=null&&bO.$==1?{$:1,$0:bj.ofArray([bO.$0])}:null);bJ==null&&(bL==null&&bN==null)?void 0:(_2.debug(((((_.Curried(function(bQ,bR,bS,bT){return bQ("Voice: "+_4.p(bR)+" "+_4.p$3(bS)+" "+_4.p$5(bT));},4))(a.id))(bJ))(bL))(bN)),_0.update(_2.push(new B({$:0,$0:"",$1:bJ,$2:bL,$3:bN}))));}function bG(bH,bI){var bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW;_2.set_CUI(Q.New(_2.CUI().Voice,_2.CUI().Mic,bH,_2.CUI().Avatar,_2.CUI().Caption,_2.CUI().AudioHandlers,_2.CUI().TypingDNA));if(bw.Equals(_2.CUI().Mic,null))_2.initMic(bF);if(bw.Equals(_2.CUI().Voice,null))_2.initSpeech();if(_2.ClientState().$===0)_2.set_ClientState(O.ClientReady);bU=E.Blank(bI);if(bU!=null&&bU.$==1)return _2["say'"]("Tell me what you want me to do or ask me a question.");else{bV=E.Debug(bI);if(bV!=null&&bV.$==1){_2.debug((function(bX){return function(bY){return bX("Utterances: "+bf.prettyPrint(bY));};}(a.id))(_2.Utterances()));_2.debug((function(bX){return function(bY){return bX("Questions: "+bf.prettyPrint(bY));};}(a.id))(_2.Questions()));bJ=_2.Props().GetEnumerator$1();try{while(bJ.MoveNext()){bW=bJ.Current();_2.debug((((_.Curried3(function(bX,bY,bZ){return bX(bf.toSafe(bY)+": "+bf.prettyPrint(bZ));}))(a.id))(bW.K))(bW.V));}}finally{bJ.Dispose();}return _2.CUI().Wait((bK=null,bm.Delay(function(){return bm.Bind((new by.New()).Async("SMApp.Web:SMApp.Web.Server.getEmotionalTraits:-1694413522",["I am mostly sad today."]),function(bX){return bX.$==1?(_2.debug(bX.$0),bm.Zero()):(_2.debug(bj.head(bX.$0).get_Label()),bm.Zero());});})));}else{bL=E.Voices(bI);return bL!=null&&bL.$==1?(bM=d.toArray(d.speechSynthesis().getVoices()),_2["say'"]((function(bX){return function(bY){return bX("There are currently "+a.String(bY)+" voices installed on this computer or device.");};}(a.id))(_7.length(bM))),_7.iteri(function(bX,bY){return _2["say'"](((((_.Curried(function(bZ,b0,b1,b2){return bZ("Voice "+a.String(b0)+". Name: "+bf.toSafe(b1)+", Local: "+bf.prettyPrint(b2)+".");},4))(a.id))(bX))(bY.name))(bY.localService));},bM)):_2.ClientState().$==1?(bO=E.QuickHello(bI),(bO!=null&&bO.$==1?(bN=bO.$0,true):(bP=E.QuickHelp(bI),bP!=null&&bP.$==1?(bN=bP.$0,true):(bQ=E.QuickYes(bI),bQ!=null&&bQ.$==1?(bN=bQ.$0,true):(bR=E.QuickNo(bI),bR!=null&&bR.$==1?(bN=bR.$0,true):(bS=E.QuickNumber(bI),bS!=null&&bS.$==1&&(bN=bS.$0,true))))))?(_2.debug((function(bX){return function(bY){return bX("Quick Text: "+_4.p$7(bY)+".");};}(a.id))(bN)),_0.update(_2.push(bN)),_2.set_ClientState(O.ClientReady)):_2.CUI().Wait((bT=null,bm.Delay(function(){_2.set_ClientState(O.ClientUnderstand);E.getUtterance(bI,function(bX){var bY,bZ;bY=E.HasUtterance(bX);bY!=null&&bY.$==1?(bZ=bY.$0,_2.debug(((((_.Curried(function(b0,b1,b2,b3){return b0("Text: Intent: "+_4.p(b1)+", Traits: "+_4.p$3(b2)+", Entities: "+_4.p$5(b3)+".");},4))(a.id))(bZ.get_Intent()))(bZ.get_Traits()))(bZ.get_Entities())),_0.update(_2.push(bZ))):(_2.debug("Text: Did not receive a meaning from the server."),_2["say'"]("Sorry I did not understand what you said."));});_2.set_ClientState(O.ClientReady);return bm.Zero();})))):_2.ClientState().$==0?d.error("Client is not initialized."):_2["say'"]("I'm still trying to understand what you said before.");}}}_3.CUI=Q.New(null,null,null,(bv.applicationId="4277115329081938617",bC=new a.SDKConnection(),bD=new a.WebAvatar(),bD.version=8.5,bD.connection=bC,bD.avatar="20926186",bD.voice="cmu-slt",bD.voiceMod="default",bD.width=175,bD.createBox(),bD.addMessage(""),bD.processMessages(0),bD),false,new bB.New$5(),new a.TypingDNA());_3.MicState=N.MicNotInitialized;_3.ClientState=O.ClientNotInitialzed;_3.Props=new bB.New$5();_3.Output=[];_3.Questions=[];_3.Utterances=[];_3.Dialogue=new R({$:0,$0:_2.CUI(),$1:_2.Props(),$2:_2.Questions(),$3:_2.Output(),$4:_2.Utterances()});_3.synth=a.speechSynthesis;_3.Main=new P({$:0,$0:function(bH){return bF(bH[0],bH[1]);},$1:[function(bH){return function(bI){return bG(bH,bI);};},(bE={},bE.name="Main",bE.greetings="Welcome to Selma. Enter 'hello' or 'hello my name is...(you) to initialize speech.",bE.prompt=">",bE)]});};_4.p$8=function(bC){return bC.$==3?"ConceptCompletion":bC.$==2?"Disjunctive":bC.$==1?"Verification":"UserAuthentication "+bf.prettyPrint(bC.$0);};_5.p=function(bC){return"{"+("text = "+bf.prettyPrint(bC.text))+"; "+("intents = "+bf.printArray(function(bD){return _5.p$1(bD);},bC.intents))+"; "+("entities = "+bf.prettyPrint(bC.entities))+"; "+("traits = "+bf.prettyPrint(bC.traits))+"}";};_5.p$1=function(bC){return"{"+("id = "+bf.prettyPrint(bC.id))+"; "+("name = "+bf.prettyPrint(bC.name))+"; "+("confidence = "+bf.prettyPrint(bC.confidence))+"}";};_4.p$9=function(bC){return"Question ("+bf.prettyPrint(bC.$0)+", "+bf.prettyPrint(bC.$1)+", "+_4.p$8(bC.$2)+", "+_4.p$10(bC.$3)+", "+"<fun>"+")";};_4.p$10=function(bC){return bC==null?"null":"Some "+bf.printArray(bf.prettyPrint,bC.$0);};_4.p$2=function(bC){return bC==null?"null":"Some "+bf.prettyPrint(bC.$0);};_4.p$1=function(bC){return"Intent ("+bf.prettyPrint(bC.$0)+", "+_4.p$2(bC.$1)+")";};_4.p=function(bC){return bC==null?"null":"Some "+_4.p$1(bC.$0);};_4.p$4=function(bC){return"Trait ("+bf.prettyPrint(bC.$0)+", "+bf.prettyPrint(bC.$1)+", "+_4.p$2(bC.$2)+")";};_4.p$3=function(bC){return bC==null?"null":"Some "+bf.printList(function(bD){return _4.p$4(bD);},bC.$0);};_4.p$6=function(bC){return"Entity ("+bf.prettyPrint(bC.$0)+", "+bf.prettyPrint(bC.$1)+", "+bf.prettyPrint(bC.$2)+", "+_4.p$2(bC.$3)+")";};_4.p$5=function(bC){return bC==null?"null":"Some "+bf.printList(function(bD){return _4.p$6(bD);},bC.$0);};_4.p$7=function(bC){return"Utterance ("+bf.prettyPrint(bC.$0)+", "+_4.p(bC.$1)+", "+_4.p$3(bC.$2)+", "+_4.p$5(bC.$3)+")";};}());
